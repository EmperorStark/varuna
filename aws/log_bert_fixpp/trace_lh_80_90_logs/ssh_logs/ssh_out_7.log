Parent process ID: 12295 node: 172.31.22.229
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.12677526473999023
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Finished iteration 0, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10688.162
Finished iteration 1, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5486.935
Finished iteration 2, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5495.519
Finished iteration 3, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5625.828
Finished iteration 4, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5426.520
Finished iteration 5, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4378.528
Finished iteration 6, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4498.576
Finished iteration 7, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4508.000
Finished iteration 8, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4371.475
Finished iteration 9, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4524.978
Finished iteration 10, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4216.328
Finished iteration 11, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4438.332
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 12, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4259.028
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 13, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4248.050
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 14, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4456.708
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 15, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4478.733
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 16, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4324.513
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 17, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4292.554
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 18, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4559.595
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 19, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5294.936
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 20, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4367.199
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 21, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4214.292
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 22, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4415.603
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 23, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4277.382
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 24, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4388.839
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 25, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4456.167
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 26, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4322.353
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 27, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4410.723
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 28, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4561.696
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 29, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4366.189
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 30, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4358.324
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 31, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4638.706
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 32, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4258.037
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 33, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4369.443
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 34, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4832.278
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 35, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4510.918
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 36, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4521.210
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 37, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4467.501
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 38, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4348.905
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 39, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4297.887
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 40, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.227
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 41, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4422.338
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 42, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4362.478
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 43, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4478.614
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 44, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4374.973
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 45, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4662.501
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 46, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4395.926
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 47, CKPT_AND_STOP: False, flag: tensor([3], dtype=torch.int32), speed: 4263.640
2022-11-23 14:43:19.364237 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 7.420294523239136
Process done with return code 0
Parent process ID: 12797 node: 172.31.22.229
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 48
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.5710611343383789
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_48.pt
2022-11-23 14:43:47.765789 resume step from  48
2022-11-23 14:43:57.601491 - Finished loading checkpoint, takes 9823.536 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 48, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 13061.927
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 49, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5290.323
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 50, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5417.156
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 51, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5334.799
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 52, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5550.937
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 53, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4425.397
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 54, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5012.137
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 55, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4371.304
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 56, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4262.999
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 57, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4197.668
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 58, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4202.501
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 59, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4489.660
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 60, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4358.389
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 61, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4389.054
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 62, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4738.407
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 63, CKPT_AND_STOP: False, flag: tensor([5], dtype=torch.int32), speed: 4344.167
2022-11-23 14:45:21.085545 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 7.075486898422241
Process done with return code 0
Parent process ID: 13337 node: 172.31.22.229
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 64
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.2047593593597412
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_64.pt
2022-11-23 14:45:49.254137 resume step from  64
2022-11-23 14:45:59.180395 - Finished loading checkpoint, takes 9914.170 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 64, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 17605.067
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 65, CKPT_AND_STOP: False, flag: tensor([5], dtype=torch.int32), speed: 5802.326
2022-11-23 14:46:22.629349 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 6.702221393585205
Process done with return code 0
Parent process ID: 13848 node: 172.31.22.229
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 66
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.13317465782165527
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_66.pt
2022-11-23 14:46:50.657612 resume step from  66
2022-11-23 14:47:00.423919 - Finished loading checkpoint, takes 9753.984 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 66, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 18437.876
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 67, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5467.527
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 68, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5709.080
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 69, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5755.505
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 70, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5467.677
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 71, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4322.477
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 72, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4308.477
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 73, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4279.737
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 74, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4458.652
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 75, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4304.517
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 76, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4330.731
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 77, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4257.222
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 78, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4307.505
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 79, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4239.923
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 80, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.177
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 81, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4384.727
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 82, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4352.849
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 83, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4165.037
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 84, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4387.412
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 85, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4289.414
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 86, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4403.650
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 87, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.558
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 88, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4501.134
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 89, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4357.304
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 90, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4361.789
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 91, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4574.591
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 92, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4419.265
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 93, CKPT_AND_STOP: False, flag: tensor([4], dtype=torch.int32), speed: 4340.271
2022-11-23 14:49:21.320366 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 7.533636569976807
Process done with return code 0
Parent process ID: 14415 node: 172.31.22.229
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 94
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.11013340950012207
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_94.pt
2022-11-23 14:49:51.050128 resume step from  94
2022-11-23 14:50:01.159025 - Finished loading checkpoint, takes 10096.744 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 94, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 17898.955
2022-11-23 14:50:19.095078 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 7.352622032165527
Process done with return code 0
Parent process ID: 14927 node: 172.31.22.229
3 per stage
24 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 3
stage to rank map: 0,8,16;1,9,17;2,10,18;3,11,19;4,12,20;5,13,21;6,14,22;7,15,23;
World size is 24
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8,16;1,9,17;2,10,18;3,11,19;4,12,20;5,13,21;6,14,22;7,15,23; --batch-size=341 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 95
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.19202065467834473
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
43 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_95.pt
2022-11-23 14:50:50.868476 resume step from  95
2022-11-23 14:51:00.703694 - Finished loading checkpoint, takes 9822.798 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 95, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 13980.839
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 96, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4192.363
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 97, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4192.373
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 98, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4249.061
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 99, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4179.480
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 100, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3264.691
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 101, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3237.917
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 102, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3427.729
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 103, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3263.655
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 104, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3128.019
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 105, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3098.906
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 106, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3205.065
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 107, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3134.102
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 108, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3166.955
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 109, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3380.127
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 110, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3088.630
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 111, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3181.370
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 112, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3336.190
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 113, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3154.068
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 114, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3212.111
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 115, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3153.266
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 116, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3224.671
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 117, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3179.619
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 118, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3122.724
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 119, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3121.833
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 120, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3175.409
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 121, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3162.697
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 122, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3089.328
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 123, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3170.213
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 124, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3176.054
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 125, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4008.209
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 126, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3130.052
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 127, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3395.210
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 128, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3254.238
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 129, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3289.087
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 130, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3093.094
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 131, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3171.785
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 132, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3171.299
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 133, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3284.646
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 134, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3315.732
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 135, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3368.499
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 136, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3157.943
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 137, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3173.742
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 138, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3230.490
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 139, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3947.757
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 140, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3201.077
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 141, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 3197.910
2022-11-23 14:53:47.782509 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 1.8519198894500732
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Process done with return code 0
Parent process ID: 15258 node: 172.31.17.44
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 142
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.13497400283813477
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_142.pt
2022-11-23 14:54:22.007494 resume step from  142
2022-11-23 14:54:32.902482 - Finished loading checkpoint, takes 10882.871 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 142, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 17730.271
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 143, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5308.437
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 144, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5364.546
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 145, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5468.415
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 146, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5312.178
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 147, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4519.963
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 148, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4417.112
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 149, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4490.098
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 150, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4447.357
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 151, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4419.787
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 152, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4532.381
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 153, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4300.852
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 154, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 4217.092
2022-11-23 14:55:47.468334 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 7.929293155670166
Process done with return code 0
Parent process ID: 15815 node: 172.31.17.44
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 155
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.13841700553894043
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_155.pt
2022-11-23 14:56:18.426342 resume step from  155
2022-11-23 14:56:28.234147 - Finished loading checkpoint, takes 9795.963 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 13584.309
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 6397.117
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5539.648
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5613.042
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5541.549
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4417.266
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4159.804
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4444.488
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4356.427
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4492.282
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4434.641
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4468.112
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5416.259
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4521.447
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4488.846
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4176.055
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4528.685
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4408.288
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4426.437
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4473.065
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4418.792
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4482.851
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4497.960
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4490.279
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4577.474
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4436.399
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4788.511
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4440.602
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 183, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4354.585
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4745.759
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4556.542
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4327.021
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4426.229
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 188, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4442.601
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4740.106
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4304.254
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4178.926
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 192, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4235.798
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4292.561
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4401.201
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4260.148
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4641.357
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4343.955
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4251.700
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4325.425
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4227.334
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4226.229
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4279.392
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4453.782
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4417.338
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4747.176
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5259.751
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4377.329
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4294.053
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4287.596
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4209.374
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4606.544
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4402.017
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4524.234
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5035.787
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4543.941
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4708.499
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4251.087
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4240.015
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4424.183
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4582.630
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4335.819
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4826.688
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4489.124
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4449.528
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4487.928
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4261.588
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4402.364
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4486.028
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4547.577
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4302.626
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4148.116
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4322.243
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4367.950
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4445.638
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4196.393
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4270.832
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4323.764
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4297.461
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4445.382
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4368.059
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4534.234
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4451.598
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4721.592
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4448.137
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4396.561
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4451.351
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4360.858
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4483.450
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4182.827
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4162.113
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5038.744
Process done with return code 1
Parent process ID: 14447 node: 172.31.21.254
1 per stage
8 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 1
stage to rank map: 0;1;2;3;4;5;6;7;
World size is 8
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0;1;2;3;4;5;6;7; --batch-size=1024 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 155
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.2136077880859375
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
128 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_155.pt
2022-11-23 15:09:36.537140 resume step from  155
2022-11-23 15:09:47.744543 - Finished loading checkpoint, takes 11195.650 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 15506.953
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7014.342
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7142.630
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7155.647
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7412.200
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 6989.360
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7417.243
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7201.008
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7095.313
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7128.409
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7275.524
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7180.417
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7135.666
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7317.561
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 6999.982
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7237.583
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7323.640
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 6973.011
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7225.481
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7037.360
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7141.633
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7588.314
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7120.651
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7120.308
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7157.793
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7103.757
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7059.281
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 6822.788
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 183, CKPT_AND_STOP: True, flag: tensor([8], dtype=torch.int32), speed: 7195.777
2022-11-23 15:13:23.861763 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 9.907942056655884
Process done with return code 0
Parent process ID: 15006 node: 172.31.21.254
1 per stage
8 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 1
stage to rank map: 0;1;2;3;4;5;6;7;
World size is 8
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0;1;2;3;4;5;6;7; --batch-size=1024 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 184
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.07284688949584961
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
128 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_184.pt
2022-11-23 15:13:52.901726 resume step from  184
2022-11-23 15:14:01.231525 - Finished loading checkpoint, takes 8317.611 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 15994.256
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7286.196
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7610.548
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7542.742
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 188, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7447.086
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7620.736
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7718.261
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7506.158
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 192, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 7504.385
2022-11-23 15:15:17.498531 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 9.224662780761719
Process done with return code 0
Parent process ID: 15487 node: 172.31.21.254
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 193
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.7304062843322754
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_193.pt
2022-11-23 15:15:48.832349 resume step from  193
2022-11-23 15:15:57.322833 - Finished loading checkpoint, takes 8478.513 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 13776.954
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5454.016
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5179.334
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5350.489
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5423.940
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4096.632
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4213.145
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4345.746
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4333.030
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4285.152
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4343.088
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4092.332
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4243.639
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4083.782
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4277.337
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4171.680
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4514.967
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4278.563
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4187.656
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4287.563
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4111.334
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4099.589
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4262.975
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4108.521
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4234.418
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4261.840
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4114.216
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4239.122
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4463.744
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 4176.385
2022-11-23 15:18:18.371255 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 7 signal handler called with signal 10
Opt ckpt time 6.856463193893433
Process done with return code 0
Parent process ID: 16028 node: 172.31.21.254
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 223
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.08481359481811523
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_223.pt
2022-11-23 15:18:46.852918 resume step from  223
2022-11-23 15:18:56.494123 - Finished loading checkpoint, takes 9629.088 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 18109.863
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5327.866
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5299.280
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5192.185
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5258.908
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4405.932
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.701
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4174.998
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4236.936
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4241.874
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4237.878
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4259.558
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4113.976
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4348.330
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4167.066
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4235.234
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4216.030
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4248.979
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4056.029
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4243.095
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4368.605
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4183.474
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4188.584
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4344.570
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4196.426
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4311.860
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4207.709
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4192.737
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4251.271
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4205.795
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 253, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4278.163
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 254, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4095.654
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 255, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4134.404
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 256, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4100.622
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 257, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4121.273
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 258, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4331.826
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 259, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4347.443
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 260, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4188.276
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 261, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4383.950
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 262, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4245.147
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 263, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4308.524
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 264, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4283.639
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 265, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4125.915
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 266, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4343.422
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 267, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4179.510
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 268, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4345.919
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 269, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4262.203
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 270, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4274.999
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 271, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4369.912
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 272, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4221.342
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 273, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4205.240
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 274, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4270.829
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 275, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4193.671
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 276, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4221.862
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 277, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4142.682
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 278, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4085.747
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 279, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4244.315
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 280, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4147.973
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 281, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4250.073
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 282, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4384.667
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 283, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4167.057
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 284, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4171.176
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 285, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5243.819
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 286, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4374.338
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 287, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4255.781
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 288, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4330.549
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 289, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4147.697
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 290, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4301.119
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 291, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4249.192
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 292, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4123.795
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 293, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4357.345
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 294, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4157.092
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 295, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4343.567
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 296, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4134.303
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 297, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4328.176
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 298, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4153.080
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 299, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4267.013
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 300, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4239.572
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 301, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4372.639
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 302, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4460.460
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 303, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4602.256
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 304, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4633.640
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 305, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4157.583
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 306, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4254.520
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 307, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4266.994
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 308, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4191.597
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 309, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4177.097
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 310, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4127.864
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 311, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4168.395
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 312, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4260.195
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 313, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4082.245
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 314, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4467.781
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 315, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4243.501
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 316, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4202.658
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 317, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4159.621
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 318, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4160.520
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 319, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4157.480
Process done with return code 1
Parent process ID: 18186 node: 172.31.31.40
1 per stage
8 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 1
stage to rank map: 0;1;2;3;4;5;6;7;
World size is 8
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0;1;2;3;4;5;6;7; --batch-size=1024 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 223
Process done with return code 1
Parent process ID: 18503 node: 172.31.31.40
2 per stage
16 servers!
Config:
ranks: range(7, 8)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=7 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 223
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.2182164192199707
SHARED WEIGHTS ARE
[(0, 7)]
this rank  7 is part of pipeline replica  0
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_223.pt
2022-11-23 15:26:44.311950 resume step from  223
2022-11-23 15:26:55.283736 - Finished loading checkpoint, takes 10959.241 secs
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 17965.403
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5303.944
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5295.252
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5232.533
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5248.765
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4204.171
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4267.099
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4335.123
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4194.307
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4416.930
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4281.431
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4484.645
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4308.056
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4184.675
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4227.577
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4193.492
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4277.374
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4162.618
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4248.425
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4257.359
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4241.841
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4158.991
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4165.458
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4037.857
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4312.454
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4285.278
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4303.012
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4138.418
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4137.601
7 Overflow !!
7 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4069.090
