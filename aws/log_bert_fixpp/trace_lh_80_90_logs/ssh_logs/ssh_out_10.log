Parent process ID: 11640 node: 172.31.19.171
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.12699198722839355
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Finished iteration 0, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10681.245
Finished iteration 1, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5486.947
Finished iteration 2, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5495.478
Finished iteration 3, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5625.698
Finished iteration 4, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5426.691
Finished iteration 5, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4378.681
Finished iteration 6, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4498.476
Finished iteration 7, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4508.079
Finished iteration 8, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4371.440
Finished iteration 9, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4524.899
Finished iteration 10, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4216.344
Finished iteration 11, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4438.449
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 12, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4258.910
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 13, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4248.095
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 14, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4456.711
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 15, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4478.707
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 16, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4324.560
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 17, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4292.562
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 18, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4559.545
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 19, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5294.960
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 20, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4367.013
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 21, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4214.471
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 22, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4415.633
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 23, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4277.346
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 24, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4388.861
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 25, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4455.972
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 26, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4322.544
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 27, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4410.731
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 28, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4561.627
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 29, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4366.085
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 30, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4358.496
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 31, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4638.685
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 32, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4257.974
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 33, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4369.358
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 34, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4832.194
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 35, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4511.047
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 36, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4521.165
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 37, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4467.523
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 38, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4348.916
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 39, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4297.931
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 40, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.241
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 41, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4422.230
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 42, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4362.518
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 43, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4478.636
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 44, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4374.876
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 45, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4662.556
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 46, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4395.897
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 47, CKPT_AND_STOP: False, flag: tensor([3], dtype=torch.int32), speed: 4263.720
2022-11-23 14:43:19.364319 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 3.196882486343384
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Process done with return code 0
Parent process ID: 12233 node: 172.31.19.171
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 48
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.5965375900268555
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_48.pt
2022-11-23 14:43:47.764717 resume step from  48
2022-11-23 14:43:59.649606 - Finished loading checkpoint, takes 11873.846 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 48, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 11012.779
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 49, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5290.357
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 50, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5417.178
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 51, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5334.944
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 52, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5550.837
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 53, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4425.486
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 54, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5012.039
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 55, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4371.325
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 56, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4263.060
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 57, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4197.674
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 58, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4202.504
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 59, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4489.640
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 60, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4358.325
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 61, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4389.150
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 62, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4738.396
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 63, CKPT_AND_STOP: False, flag: tensor([5], dtype=torch.int32), speed: 4344.150
2022-11-23 14:45:21.085732 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 3.040318012237549
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Process done with return code 0
Parent process ID: 12792 node: 172.31.19.171
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 64
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.004048824310302734
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_64.pt
2022-11-23 14:45:54.289522 resume step from  64
2022-11-23 14:46:06.255896 - Finished loading checkpoint, takes 11955.079 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 64, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10528.704
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 65, CKPT_AND_STOP: False, flag: tensor([5], dtype=torch.int32), speed: 5802.372
2022-11-23 14:46:22.629519 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Opt ckpt time 3.079157590866089
Process done with return code 0
Parent process ID: 13293 node: 172.31.19.171
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 66
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.10298371315002441
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_66.pt
2022-11-23 14:46:56.126654 resume step from  66
2022-11-23 14:47:08.077238 - Finished loading checkpoint, takes 11939.117 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 66, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10773.410
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 67, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5467.491
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 68, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5709.038
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 69, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5755.465
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 70, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5467.823
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 71, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4322.482
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 72, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4308.495
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 73, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4279.715
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 74, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4458.700
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 75, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4304.518
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 76, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4330.628
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 77, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4257.311
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 78, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4307.509
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 79, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4239.850
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 80, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.141
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 81, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4384.817
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 82, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4352.698
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 83, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4165.131
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 84, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4387.362
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 85, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4289.419
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 86, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4403.795
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 87, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.483
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 88, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4501.193
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 89, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4357.238
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 90, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4361.812
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 91, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4574.487
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 92, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4419.259
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 93, CKPT_AND_STOP: False, flag: tensor([4], dtype=torch.int32), speed: 4340.351
2022-11-23 14:49:21.326001 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 3.511521339416504
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Process done with return code 0
Parent process ID: 13904 node: 172.31.19.171
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 94
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.09554433822631836
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_94.pt
2022-11-23 14:49:56.037611 resume step from  94
2022-11-23 14:50:03.056381 - Finished loading checkpoint, takes 7007.199 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 94, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 16001.175
2022-11-23 14:50:19.095257 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 3.0625863075256348
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Process done with return code 0
Parent process ID: 14401 node: 172.31.19.171
3 per stage
24 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 3
stage to rank map: 0,8,16;1,9,17;2,10,18;3,11,19;4,12,20;5,13,21;6,14,22;7,15,23;
World size is 24
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8,16;1,9,17;2,10,18;3,11,19;4,12,20;5,13,21;6,14,22;7,15,23; --batch-size=341 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 95
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.2077317237854004
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
43 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_95.pt
2022-11-23 14:50:55.856905 resume step from  95
2022-11-23 14:51:02.712855 - Finished loading checkpoint, takes 6844.696 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 95, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 11968.199
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 96, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4192.360
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 97, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4192.428
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 98, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4249.033
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 99, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4179.551
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 100, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3264.736
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 101, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3237.916
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 102, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3427.712
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 103, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3263.647
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 104, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3128.023
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 105, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3098.836
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 106, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3205.120
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 107, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3134.063
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 108, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3167.039
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 109, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3380.125
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 110, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3088.609
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 111, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3181.219
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 112, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3336.290
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 113, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3154.079
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 114, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3212.095
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 115, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3153.303
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 116, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3224.545
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 117, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3179.722
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 118, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3122.665
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 119, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3121.832
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 120, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3175.441
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 121, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3162.768
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 122, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3089.310
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 123, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3170.142
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 124, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3176.050
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 125, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4008.146
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 126, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3130.123
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 127, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3395.270
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 128, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3254.202
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 129, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3289.009
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 130, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3093.076
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 131, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3171.852
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 132, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3171.218
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 133, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3284.682
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 134, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3315.772
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 135, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3368.313
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 136, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3158.149
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 137, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3173.743
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 138, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3230.436
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 139, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3947.752
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 140, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3201.069
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 141, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 3197.889
2022-11-23 14:53:47.785219 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 2.701871395111084
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Process done with return code 0
Parent process ID: 15579 node: 172.31.21.109
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 142
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.11769771575927734
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_142.pt
2022-11-23 14:54:21.992617 resume step from  142
2022-11-23 14:54:30.142461 - Finished loading checkpoint, takes 8138.211 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 142, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 20488.987
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 143, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5308.364
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 144, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5364.681
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 145, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5468.457
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 146, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5312.114
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 147, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4519.954
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 148, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4417.183
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 149, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4490.178
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 150, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4447.292
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 151, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4419.720
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 152, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4532.447
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 153, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4300.890
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 154, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 4217.113
2022-11-23 14:55:47.467672 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 3.4744527339935303
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Process done with return code 0
Parent process ID: 16145 node: 172.31.21.109
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 155
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.13731932640075684
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_155.pt
2022-11-23 14:56:18.422070 resume step from  155
2022-11-23 14:56:25.621768 - Finished loading checkpoint, takes 7188.137 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 16194.629
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 6396.388
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5540.539
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5613.184
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5541.363
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4417.502
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4159.744
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4444.738
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4356.207
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4492.247
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4434.728
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4468.016
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5416.296
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4521.219
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4489.089
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4175.972
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4528.760
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4408.354
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4426.327
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4473.147
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4418.931
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4482.896
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4497.755
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4490.291
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4577.564
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4436.409
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4788.387
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4440.649
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 183, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4354.589
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4745.712
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4556.697
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4326.800
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4426.433
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 188, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4442.554
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4740.094
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4304.271
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4178.951
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 192, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4235.682
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4292.702
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4401.247
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4260.092
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4641.236
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4344.112
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4251.460
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4325.710
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4227.333
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4226.130
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4279.433
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4453.803
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4417.429
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4747.153
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5259.720
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4377.351
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4293.841
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4287.682
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4209.589
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4606.382
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4402.053
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4524.227
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5035.864
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4543.742
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4708.708
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4251.076
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4239.882
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4424.335
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4582.536
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4335.922
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4826.526
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4489.240
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4449.628
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4487.798
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4261.696
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4402.304
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4486.119
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4547.387
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4302.727
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4148.121
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4322.324
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4367.751
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4445.708
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4196.480
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4270.810
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4323.678
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4297.517
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4445.291
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4368.217
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4534.256
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4451.616
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4721.494
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4448.053
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4396.706
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4451.260
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4360.858
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4483.459
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4182.755
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4162.166
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5038.686
Process done with return code -6
Parent process ID: 16121 node: 172.31.31.40
1 per stage
8 servers!
10 8 I am of no use!
Parent process ID: 16446 node: 172.31.31.40
1 per stage
8 servers!
10 8 I am of no use!
Parent process ID: 16769 node: 172.31.31.40
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 193
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.7762906551361084
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_193.pt
2022-11-23 15:15:48.826331 resume step from  193
2022-11-23 15:15:54.680257 - Finished loading checkpoint, takes 5842.339 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 16418.341
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5454.057
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5179.367
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5350.420
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5424.024
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4096.605
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4213.167
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4345.676
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4333.143
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4285.109
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4343.003
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4092.409
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4243.630
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4083.910
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4277.101
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4171.740
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4515.008
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4278.499
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4187.790
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4287.465
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4111.301
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4099.811
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4262.826
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4108.437
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4234.477
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4261.888
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4114.042
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4239.232
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4463.819
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 4176.415
2022-11-23 15:18:18.370182 Begin to save checkpont to s3://spot-checkpoints/bert and exit
Opt ckpt time 3.8170664310455322
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 10 signal handler called with signal 10
Process done with return code 0
Parent process ID: 17362 node: 172.31.31.40
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 223
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.05358314514160156
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_223.pt
2022-11-23 15:18:46.866949 resume step from  223
2022-11-23 15:18:53.875746 - Finished loading checkpoint, takes 6997.638 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 20716.082
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5328.137
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5298.894
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5192.426
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5258.813
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4405.973
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4337.901
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4174.965
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4236.867
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4241.732
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4237.998
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4259.504
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4114.185
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4348.178
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4167.001
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4235.066
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4216.323
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4248.876
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4055.974
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4242.906
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4368.712
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4183.500
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4188.749
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4344.443
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4196.493
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4311.794
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4207.809
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4192.687
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4251.295
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4205.705
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 253, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4278.182
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 254, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4095.773
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 255, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4134.313
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 256, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4100.643
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 257, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4120.883
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 258, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4332.276
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 259, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4347.286
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 260, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4188.386
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 261, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4384.063
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 262, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4245.003
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 263, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4308.553
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 264, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4283.423
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 265, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4126.122
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 266, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4343.324
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 267, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4179.682
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 268, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4345.954
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 269, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4262.010
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 270, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4274.864
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 271, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4370.070
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 272, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4221.359
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 273, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4205.193
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 274, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4270.906
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 275, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4193.639
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 276, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4221.817
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 277, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4142.677
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 278, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4085.693
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 279, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4244.383
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 280, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4148.050
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 281, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4249.976
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 282, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4384.770
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 283, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4166.942
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 284, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4171.188
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 285, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5243.764
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 286, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4374.397
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 287, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4255.840
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 288, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4330.457
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 289, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4147.855
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 290, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4300.961
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 291, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4249.083
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 292, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4123.935
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 293, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4357.308
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 294, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4157.135
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 295, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4343.629
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 296, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4134.224
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 297, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4328.203
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 298, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4153.106
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 299, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4266.815
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 300, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4239.685
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 301, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4372.666
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 302, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4460.385
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 303, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4602.191
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 304, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4630.689
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 305, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4160.779
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 306, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4254.413
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 307, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4266.929
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 308, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4191.583
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 309, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4177.099
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 310, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4127.943
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 311, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4168.365
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 312, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4260.192
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 313, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4082.229
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 314, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4467.787
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 315, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4243.575
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 316, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4202.576
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 317, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4159.662
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 318, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4160.517
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 319, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4157.582
Process done with return code -6
Parent process ID: 16122 node: 172.31.24.208
1 per stage
8 servers!
10 8 I am of no use!
Parent process ID: 16434 node: 172.31.24.208
2 per stage
16 servers!
Config:
ranks: range(10, 11)
train batch size: 1024
partitions: 8
chunk_size: 8
data depth: 2
stage to rank map: 0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=10 --chunk_size=8 --local_rank=0 --stage_to_rank_map=0,8;1,9;2,10;3,11;4,12;5,13;6,14;7,15; --batch-size=512 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 223
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
dry run time 0.18071889877319336
SHARED WEIGHTS ARE
[(0, 7)]
this rank  10 is part of pipeline replica  1
64 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_223.pt
2022-11-23 15:26:44.307294 resume step from  223
2022-11-23 15:26:52.538320 - Finished loading checkpoint, takes 8219.322 secs
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 20697.034
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5307.880
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5295.206
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5232.494
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5248.676
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4204.163
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4267.285
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4335.222
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4194.276
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4416.881
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4281.475
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4484.591
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4308.063
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4184.490
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4227.825
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4193.288
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4277.568
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4162.495
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4248.342
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4257.364
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4242.043
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4158.815
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4165.605
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4037.690
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4312.528
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4285.411
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4303.018
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4138.376
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4137.558
10 Overflow !!
10 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4069.228
