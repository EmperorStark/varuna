Parent process ID: 109819 node: 172.31.22.165
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1000717.0997800314 0
End of simulation:  Mini-batch time (usec) = 1454691
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 46 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12826.751708984375 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009897
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 158 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 355 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 719 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1627 microseconds

{1: 1.454691, 2: 2.009897, 3: 6.713432, 4: 10.570352, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009897
9 per stage
18 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 9
stage to rank map: 0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17;
World size is 18
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19
[2022-12-01 17:30:45.492541] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8004300594329834
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
7 chunks
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:31:01.174255] Finished iteration 1, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9408.971
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:31:03.599650] Finished iteration 2, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2425.092
[2022-12-01 17:31:05.975874] Finished iteration 3, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2376.208
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 17:31:07.347561] Finished iteration 4, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1371.641
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-12-01 17:31:09.919251] Finished iteration 5, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2571.701
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-12-01 17:31:11.248491] Finished iteration 6, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1329.191
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-12-01 17:31:12.613014] Finished iteration 7, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1364.475
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
[2022-12-01 17:31:14.185984] Finished iteration 8, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1572.939
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
[2022-12-01 17:31:15.646534] Finished iteration 9, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1460.542
[2022-12-01 17:30:51.742578] Epoch: [0][ 10/223]	Time  1.545 ( 2.542)	Data  0.006 ( 0.488)	Loss 2.6246e+01 (1.9566e+01)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:31:17.189517] Finished iteration 10, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1542.919
[2022-12-01 17:31:18.592273] Finished iteration 11, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1402.737
[2022-12-01 17:31:19.976786] Finished iteration 12, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.480
[2022-12-01 17:31:21.410997] Finished iteration 13, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1434.197
[2022-12-01 17:31:22.863044] Finished iteration 14, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1451.989
[2022-12-01 17:31:24.302571] Finished iteration 15, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1439.489
[2022-12-01 17:31:25.752998] Finished iteration 16, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1450.383
[2022-12-01 17:31:27.102728] Finished iteration 17, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1349.693
[2022-12-01 17:31:28.690006] Finished iteration 18, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1587.236
[2022-12-01 17:31:30.167670] Finished iteration 19, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.629
[2022-12-01 17:30:51.742578] Epoch: [0][ 20/223]	Time  1.485 ( 1.994)	Data  0.003 ( 0.247)	Loss 5.2963e+00 (1.2869e+01)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:31:31.654850] Finished iteration 20, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1487.136
[2022-12-01 17:31:33.158298] Finished iteration 21, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1503.428
[2022-12-01 17:31:34.631766] Finished iteration 22, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1473.431
[2022-12-01 17:31:36.123775] Finished iteration 23, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1491.967
[2022-12-01 17:31:37.523579] Finished iteration 24, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1399.765
[2022-12-01 17:31:38.953029] Finished iteration 25, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1429.411
[2022-12-01 17:31:40.386821] Finished iteration 26, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1433.757
[2022-12-01 17:31:41.755537] Finished iteration 27, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1368.680
[2022-12-01 17:31:43.248867] Finished iteration 28, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1493.285
[2022-12-01 17:31:44.697613] Finished iteration 29, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1448.717
[2022-12-01 17:30:51.742578] Epoch: [0][ 30/223]	Time  1.386 ( 1.810)	Data  0.005 ( 0.166)	Loss 4.7656e+00 (1.0239e+01)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:31:46.082009] Finished iteration 30, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.312
[2022-12-01 17:31:47.594692] Finished iteration 31, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1512.658
[2022-12-01 17:31:49.052316] Finished iteration 32, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1457.586
[2022-12-01 17:31:50.564390] Finished iteration 33, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1512.051
[2022-12-01 17:31:51.936111] Finished iteration 34, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1371.670
[2022-12-01 17:31:53.355936] Finished iteration 35, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1419.807
[2022-12-01 17:31:54.860767] Finished iteration 36, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.781
[2022-12-01 17:31:56.324382] Finished iteration 37, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1463.579
[2022-12-01 17:31:57.693460] Finished iteration 38, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1369.044
[2022-12-01 17:31:59.061554] Finished iteration 39, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1368.056
[2022-12-01 17:30:51.742578] Epoch: [0][ 40/223]	Time  1.413 ( 1.718)	Data  0.004 ( 0.126)	Loss 4.6590e+00 (8.8519e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:32:00.474690] Finished iteration 40, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1413.094
[2022-12-01 17:32:01.874926] Finished iteration 41, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1400.213
[2022-12-01 17:32:03.317408] Finished iteration 42, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1442.444
[2022-12-01 17:32:04.740831] Finished iteration 43, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1423.388
[2022-12-01 17:32:06.156374] Finished iteration 44, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1415.493
[2022-12-01 17:32:07.530155] Finished iteration 45, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1373.749
[2022-12-01 17:32:09.007685] Finished iteration 46, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.493
[2022-12-01 17:32:10.591866] Finished iteration 47, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1584.142
[2022-12-01 17:32:11.987749] Finished iteration 48, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1395.848
[2022-12-01 17:32:13.372847] Finished iteration 49, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1385.060
[2022-12-01 17:30:51.742578] Epoch: [0][ 50/223]	Time  1.485 ( 1.662)	Data  0.005 ( 0.102)	Loss 4.6127e+00 (8.0082e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:32:14.857035] Finished iteration 50, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1484.148
[2022-12-01 17:32:16.283169] Finished iteration 51, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1426.107
[2022-12-01 17:32:17.781600] Finished iteration 52, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1498.398
[2022-12-01 17:32:19.268958] Finished iteration 53, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1487.282
[2022-12-01 17:32:20.691935] Finished iteration 54, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1422.945
[2022-12-01 17:32:22.148039] Finished iteration 55, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1456.056
[2022-12-01 17:32:23.514546] Finished iteration 56, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1366.476
[2022-12-01 17:32:24.996300] Finished iteration 57, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1481.715
[2022-12-01 17:32:26.366534] Finished iteration 58, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1370.191
[2022-12-01 17:32:27.808777] Finished iteration 59, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1442.236
[2022-12-01 17:30:51.742578] Epoch: [0][ 60/223]	Time  1.552 ( 1.627)	Data  0.004 ( 0.085)	Loss 4.6239e+00 (7.4432e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:32:29.360673] Finished iteration 60, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1551.819
[2022-12-01 17:32:30.745661] Finished iteration 61, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1385.012
[2022-12-01 17:32:32.185235] Finished iteration 62, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1439.514
[2022-12-01 17:32:33.514995] Finished iteration 63, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1329.712
[2022-12-01 17:32:34.982737] Finished iteration 64, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1467.693
[2022-12-01 17:32:36.422367] Finished iteration 65, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1439.612
[2022-12-01 17:32:37.844389] Finished iteration 66, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1421.983
[2022-12-01 17:32:39.256891] Finished iteration 67, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1412.442
[2022-12-01 17:32:40.749247] Finished iteration 68, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.320
[2022-12-01 17:32:42.073845] Finished iteration 69, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1324.553
[2022-12-01 17:30:51.742578] Epoch: [0][ 70/223]	Time  1.445 ( 1.596)	Data  0.005 ( 0.074)	Loss 4.6150e+00 (7.0399e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:32:43.517282] Finished iteration 70, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1443.392
[2022-12-01 17:32:44.912575] Finished iteration 71, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1395.302
[2022-12-01 17:32:46.291740] Finished iteration 72, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1379.135
[2022-12-01 17:32:47.665681] Finished iteration 73, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1373.904
[2022-12-01 17:32:49.187857] Finished iteration 74, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1522.128
[2022-12-01 17:32:50.731187] Finished iteration 75, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1543.257
[2022-12-01 17:32:52.162882] Finished iteration 76, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1431.666
[2022-12-01 17:32:53.664961] Finished iteration 77, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1502.037
[2022-12-01 17:32:55.071157] Finished iteration 78, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1406.169
[2022-12-01 17:32:56.550469] Finished iteration 79, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1479.267
[2022-12-01 17:30:51.742578] Epoch: [0][ 80/223]	Time  1.444 ( 1.578)	Data  0.004 ( 0.065)	Loss 4.6395e+00 (6.7376e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:32:57.995592] Finished iteration 80, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1445.108
[2022-12-01 17:32:59.511834] Finished iteration 81, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1516.210
[2022-12-01 17:33:00.929751] Finished iteration 82, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1417.897
[2022-12-01 17:33:02.460715] Finished iteration 83, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1530.882
[2022-12-01 17:33:03.953281] Finished iteration 84, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.522
[2022-12-01 17:33:05.390066] Finished iteration 85, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1436.759
[2022-12-01 17:33:06.879125] Finished iteration 86, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1489.012
[2022-12-01 17:33:08.314820] Finished iteration 87, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1435.658
[2022-12-01 17:33:09.711465] Finished iteration 88, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.597
[2022-12-01 17:33:11.150160] Finished iteration 89, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1438.677
[2022-12-01 17:30:51.742578] Epoch: [0][ 90/223]	Time  1.432 ( 1.565)	Data  0.004 ( 0.059)	Loss 4.6200e+00 (6.5024e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:33:12.582013] Finished iteration 90, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1431.794
[2022-12-01 17:33:14.020516] Finished iteration 91, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1438.482
[2022-12-01 17:33:15.442002] Finished iteration 92, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1421.445
[2022-12-01 17:33:16.899431] Finished iteration 93, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1457.394
[2022-12-01 17:33:18.409773] Finished iteration 94, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1510.394
[2022-12-01 17:33:19.778397] Finished iteration 95, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1368.491
[2022-12-01 17:33:21.165183] Finished iteration 96, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1386.748
[2022-12-01 17:33:22.612668] Finished iteration 97, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1447.482
[2022-12-01 17:33:24.031830] Finished iteration 98, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1419.103
[2022-12-01 17:33:25.559326] Finished iteration 99, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1527.450
[2022-12-01 17:30:51.742578] Epoch: [0][100/223]	Time  1.435 ( 1.552)	Data  0.004 ( 0.053)	Loss 4.6289e+00 (6.3141e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:33:26.994958] Finished iteration 100, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1435.591
[2022-12-01 17:33:28.415720] Finished iteration 101, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1420.735
[2022-12-01 17:33:29.919783] Finished iteration 102, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.019
[2022-12-01 17:33:31.451019] Finished iteration 103, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1531.225
[2022-12-01 17:33:32.948442] Finished iteration 104, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1497.369
[2022-12-01 17:33:34.334884] Finished iteration 105, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1386.399
[2022-12-01 17:33:35.775045] Finished iteration 106, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1440.134
[2022-12-01 17:33:37.853803] Finished iteration 107, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2078.755
[2022-12-01 17:33:39.339776] Finished iteration 108, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1485.899
[2022-12-01 17:33:40.800432] Finished iteration 109, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1460.607
[2022-12-01 17:30:51.742578] Epoch: [0][110/223]	Time  1.505 ( 1.550)	Data  0.005 ( 0.049)	Loss 4.6138e+00 (6.1601e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:33:42.304586] Finished iteration 110, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.140
[2022-12-01 17:33:43.746669] Finished iteration 111, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1442.096
[2022-12-01 17:33:45.286428] Finished iteration 112, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1539.666
[2022-12-01 17:33:46.614498] Finished iteration 113, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1328.022
[2022-12-01 17:33:47.998802] Finished iteration 114, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.309
[2022-12-01 17:33:49.439272] Finished iteration 115, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1440.375
[2022-12-01 17:33:50.910945] Finished iteration 116, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1471.637
[2022-12-01 17:33:52.388333] Finished iteration 117, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.346
[2022-12-01 17:33:53.814447] Finished iteration 118, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1426.085
[2022-12-01 17:33:55.272365] Finished iteration 119, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1457.891
[2022-12-01 17:30:51.742578] Epoch: [0][120/223]	Time  1.451 ( 1.541)	Data  0.003 ( 0.045)	Loss 4.6166e+00 (6.0319e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:33:56.726160] Finished iteration 120, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.743
[2022-12-01 17:33:58.160886] Finished iteration 121, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1434.679
[2022-12-01 17:33:59.553774] Finished iteration 122, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1392.896
[2022-12-01 17:34:00.981224] Finished iteration 123, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1427.404
[2022-12-01 17:34:02.400908] Finished iteration 124, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1419.643
[2022-12-01 17:34:03.883583] Finished iteration 125, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1482.625
[2022-12-01 17:34:05.340093] Finished iteration 126, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1456.451
[2022-12-01 17:34:06.881552] Finished iteration 127, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1541.446
[2022-12-01 17:34:08.357201] Finished iteration 128, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1475.582
[2022-12-01 17:34:09.872812] Finished iteration 129, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1515.575
[2022-12-01 17:30:51.742578] Epoch: [0][130/223]	Time  1.429 ( 1.535)	Data  0.006 ( 0.042)	Loss 4.6077e+00 (5.9227e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:34:11.300856] Finished iteration 130, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1427.998
[2022-12-01 17:34:12.755812] Finished iteration 131, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1454.968
[2022-12-01 17:34:14.166963] Finished iteration 132, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1411.118
[2022-12-01 17:34:15.549740] Finished iteration 133, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1382.755
[2022-12-01 17:34:17.035718] Finished iteration 134, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1485.893
[2022-12-01 17:34:18.506544] Finished iteration 135, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.784
[2022-12-01 17:34:19.935672] Finished iteration 136, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1429.093
[2022-12-01 17:34:21.294763] Finished iteration 137, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1359.076
[2022-12-01 17:34:22.707856] Finished iteration 138, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1413.055
[2022-12-01 17:34:24.108906] Finished iteration 139, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1400.987
[2022-12-01 17:30:51.742578] Epoch: [0][140/223]	Time  1.364 ( 1.526)	Data  0.004 ( 0.039)	Loss 4.6306e+00 (5.8293e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:34:25.475908] Finished iteration 140, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1366.963
[2022-12-01 17:34:26.826025] Finished iteration 141, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1350.093
[2022-12-01 17:34:28.231831] Finished iteration 142, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1405.766
[2022-12-01 17:34:29.657731] Finished iteration 143, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1425.909
[2022-12-01 17:34:31.052750] Finished iteration 144, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1394.940
[2022-12-01 17:34:32.430923] Finished iteration 145, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1378.130
[2022-12-01 17:34:33.829504] Finished iteration 146, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1398.586
[2022-12-01 17:34:35.256475] Finished iteration 147, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1426.926
Opt ckpt time 1.9646670818328857
Process done with return code 0
Parent process ID: 110526 node: 172.31.22.165
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1037195.476436041 0
End of simulation:  Mini-batch time (usec) = 1491169
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 40 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 12531.734466552734 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1936784
Min send: 10000000, max send 0
Min long send: 541659, max long send 557166
Min fwd: 19455, max fwd 25575; min bwd 50188, max bwd 55357
Min long fwd: 9714, max long fwd 12638; min long bwd 24390, max long bwd 30607
Time taken by simulation: 151 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 350 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 584 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1614 microseconds

{1: 1.491169, 2: 1.936784, 3: 6.713432, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.936784
10 per stage
20 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 147
[2022-12-01 17:34:55.536445] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 1.4761683940887451
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
7 chunks
>>>>> [2022-12-01 17:35:23.465302] Time taken to load checkpoint: 20.915s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:35:35.229032] Finished iteration 148, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8643.255
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:35:37.638444] Finished iteration 149, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2409.159
[2022-12-01 17:35:23.465512] Epoch: [0][150/223]	Time  2.508 ( 4.175)	Data  1.036 ( 0.732)	Loss 4.6283e+00 (4.6233e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:35:40.119891] Finished iteration 150, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2481.488
[2022-12-01 17:35:42.491063] Finished iteration 151, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2371.061
[2022-12-01 17:35:43.995462] Finished iteration 152, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.363
[2022-12-01 17:35:45.464944] Finished iteration 153, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1469.453
[2022-12-01 17:35:47.005438] Finished iteration 154, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1540.454
[2022-12-01 17:35:48.361375] Finished iteration 155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1355.892
[2022-12-01 17:35:49.742564] Finished iteration 156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1381.173
[2022-12-01 17:35:51.184006] Finished iteration 157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1441.389
[2022-12-01 17:35:52.597134] Finished iteration 158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1413.093
[2022-12-01 17:35:54.119970] Finished iteration 159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1522.789
[2022-12-01 17:35:23.465512] Epoch: [0][160/223]	Time  1.506 ( 2.233)	Data  0.013 ( 0.330)	Loss 4.6122e+00 (4.6197e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:35:55.623494] Finished iteration 160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1503.478
[2022-12-01 17:35:56.999373] Finished iteration 161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1375.858
[2022-12-01 17:35:58.453063] Finished iteration 162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.655
[2022-12-01 17:35:59.995673] Finished iteration 163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1542.586
[2022-12-01 17:36:01.504960] Finished iteration 164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1509.235
[2022-12-01 17:36:02.937353] Finished iteration 165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1432.341
[2022-12-01 17:36:04.453222] Finished iteration 166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1515.828
[2022-12-01 17:36:05.869340] Finished iteration 167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1416.082
[2022-12-01 17:36:07.291925] Finished iteration 168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1422.544
[2022-12-01 17:36:08.682779] Finished iteration 169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1390.821
[2022-12-01 17:35:23.465512] Epoch: [0][170/223]	Time  1.542 ( 1.897)	Data  0.005 ( 0.190)	Loss 4.6060e+00 (4.6170e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:36:10.225626] Finished iteration 170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1542.837
[2022-12-01 17:36:11.574239] Finished iteration 171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1348.558
[2022-12-01 17:36:12.999576] Finished iteration 172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1425.295
[2022-12-01 17:36:14.454667] Finished iteration 173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1455.053
[2022-12-01 17:36:15.947076] Finished iteration 174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.366
[2022-12-01 17:36:17.451637] Finished iteration 175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.509
[2022-12-01 17:36:18.862643] Finished iteration 176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1410.967
[2022-12-01 17:36:20.300163] Finished iteration 177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1437.491
[2022-12-01 17:36:21.744791] Finished iteration 178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1444.580
[2022-12-01 17:36:23.171353] Finished iteration 179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1426.525
[2022-12-01 17:35:23.465512] Epoch: [0][180/223]	Time  1.392 ( 1.757)	Data  0.005 ( 0.135)	Loss 4.6289e+00 (4.6177e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:36:24.565849] Finished iteration 180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1394.456
[2022-12-01 17:36:25.936218] Finished iteration 181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1370.344
[2022-12-01 17:36:27.349146] Finished iteration 182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1412.884
[2022-12-01 17:36:28.914836] Finished iteration 183, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1565.674
[2022-12-01 17:36:30.363599] Finished iteration 184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1448.705
[2022-12-01 17:36:31.811488] Finished iteration 185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1447.858
[2022-12-01 17:36:33.269625] Finished iteration 186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1458.114
[2022-12-01 17:36:34.629109] Finished iteration 187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1359.422
[2022-12-01 17:36:36.011134] Finished iteration 188, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1381.996
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 9 signal handler called with signal 10
Opt ckpt time 7.064891815185547
Process done with return code 0
Parent process ID: 111301 node: 172.31.22.165
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1054087.8195929518 0
End of simulation:  Mini-batch time (usec) = 1508061
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 49 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 12531.734466552734 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1936784
Min send: 10000000, max send 0
Min long send: 541659, max long send 557166
Min fwd: 19455, max fwd 25575; min bwd 50188, max bwd 55357
Min long fwd: 9714, max long fwd 12638; min long bwd 24390, max long bwd 30607
Time taken by simulation: 149 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 10 0 7426.251411437988 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5881272
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 9353, max fwd 19440; min bwd 21838, max bwd 41244
Min long fwd: 1820, max long fwd 9207; min long bwd 11095, max long bwd 16912
Time taken by simulation: 327 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 578 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1599 microseconds

{1: 1.508061, 2: 1.936784, 3: 5.881272, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.936784
10 per stage
20 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 188
[2022-12-01 17:36:57.227864] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8279719352722168
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
7 chunks
>>>>> [2022-12-01 17:37:30.091991] Time taken to load checkpoint: 26.533s
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 9 signal handler called with signal 10
2022-12-01 17:37:42.615563 Begin to exit
Process done with return code 0
Parent process ID: 111965 node: 172.31.22.165
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1070194.1820360157 0
End of simulation:  Mini-batch time (usec) = 1410943
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 38 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 13341.7387008667 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1874030
Min send: 10000000, max send 0
Min long send: 541803, max long send 558203
Min fwd: 19455, max fwd 25575; min bwd 51033, max bwd 53581
Min long fwd: 9714, max long fwd 13926; min long bwd 24633, max long bwd 28292
Time taken by simulation: 134 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 10 0 7426.251411437988 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5881272
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 9353, max fwd 19440; min bwd 21838, max bwd 41244
Min long fwd: 1820, max long fwd 9207; min long bwd 11095, max long bwd 16912
Time taken by simulation: 327 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 583 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1620 microseconds

{1: 1.410943, 2: 1.87403, 3: 5.881272, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.87403
11 per stage
22 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 11
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;
World size is 22
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21; --batch-size=192 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 188
[2022-12-01 17:37:57.239131] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8090267181396484
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
6 chunks
>>>>> [2022-12-01 17:38:29.348835] Time taken to load checkpoint: 25.799s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:38:50.874062] Finished iteration 189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8705.225
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:38:29.349101] Epoch: [0][190/260]	Time  2.228 ( 4.953)	Data  1.027 ( 0.949)	Loss 4.6035e+00 (4.6113e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:38:53.114205] Finished iteration 190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2239.867
[2022-12-01 17:38:55.453256] Finished iteration 191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2339.015
[2022-12-01 17:38:57.787578] Finished iteration 192, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2334.229
[2022-12-01 17:39:00.103259] Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2315.688
[2022-12-01 17:39:01.371089] Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1267.725
[2022-12-01 17:39:02.659249] Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1288.116
[2022-12-01 17:39:03.897331] Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1238.046
[2022-12-01 17:39:05.152846] Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.467
[2022-12-01 17:39:06.391955] Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1239.075
[2022-12-01 17:39:07.620186] Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1228.193
[2022-12-01 17:38:29.349101] Epoch: [0][200/260]	Time  1.199 ( 2.220)	Data  0.005 ( 0.422)	Loss 4.6217e+00 (4.6118e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:08.822100] Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1201.886
[2022-12-01 17:39:10.048108] Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1225.952
[2022-12-01 17:39:11.277229] Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.098
[2022-12-01 17:39:12.484041] Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1206.763
[2022-12-01 17:39:13.699242] Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1215.160
[2022-12-01 17:39:14.973286] Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1274.013
[2022-12-01 17:39:16.285797] Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1312.504
[2022-12-01 17:39:17.559306] Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1273.443
[2022-12-01 17:39:18.802466] Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1243.111
[2022-12-01 17:39:20.057971] Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.467
[2022-12-01 17:38:29.349101] Epoch: [0][210/260]	Time  1.289 ( 1.781)	Data  0.005 ( 0.233)	Loss 4.6243e+00 (4.6140e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:21.349412] Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1291.401
[2022-12-01 17:39:22.621840] Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1272.427
[2022-12-01 17:39:23.848065] Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1226.184
[2022-12-01 17:39:25.183630] Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1335.501
[2022-12-01 17:39:26.409557] Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1225.905
[2022-12-01 17:39:27.624020] Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1214.417
[2022-12-01 17:39:28.854019] Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.959
[2022-12-01 17:39:30.094901] Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1240.847
[2022-12-01 17:39:31.376652] Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1281.706
[2022-12-01 17:39:32.636165] Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1259.491
[2022-12-01 17:38:29.349101] Epoch: [0][220/260]	Time  1.256 ( 1.616)	Data  0.007 ( 0.162)	Loss 4.6100e+00 (4.6141e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:33.890994] Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1254.786
[2022-12-01 17:39:35.173702] Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1282.701
[2022-12-01 17:39:36.467286] Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1293.516
[2022-12-01 17:39:37.737510] Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1270.182
[2022-12-01 17:39:38.982268] Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1244.731
[2022-12-01 17:39:40.227315] Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1244.995
[2022-12-01 17:39:41.529250] Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1301.899
[2022-12-01 17:39:42.815945] Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1286.670
[2022-12-01 17:39:44.046300] Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1230.314
[2022-12-01 17:39:45.310106] Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1263.738
[2022-12-01 17:38:29.349101] Epoch: [0][230/260]	Time  1.384 ( 1.536)	Data  0.005 ( 0.125)	Loss 4.6146e+00 (4.6140e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:46.696839] Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1386.692
[2022-12-01 17:39:47.948547] Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1251.688
[2022-12-01 17:39:49.166504] Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1217.928
[2022-12-01 17:39:50.460177] Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1293.633
[2022-12-01 17:39:51.727288] Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1267.089
[2022-12-01 17:39:53.008832] Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1281.482
[2022-12-01 17:39:54.479198] Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.329
[2022-12-01 17:39:55.749063] Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1269.814
[2022-12-01 17:39:57.023080] Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1273.983
[2022-12-01 17:39:58.224983] Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1201.863
[2022-12-01 17:38:29.349101] Epoch: [0][240/260]	Time  1.256 ( 1.487)	Data  0.006 ( 0.102)	Loss 4.6081e+00 (4.6128e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:59.479895] Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1254.890
[2022-12-01 17:40:00.737365] Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1257.440
[2022-12-01 17:40:02.022900] Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1285.504
[2022-12-01 17:40:03.300652] Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1277.681
[2022-12-01 17:40:04.567081] Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1266.398
[2022-12-01 17:40:05.779977] Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1212.850
[2022-12-01 17:40:07.136911] Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1356.906
[2022-12-01 17:40:08.425128] Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1288.174
[2022-12-01 17:40:09.679262] Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1254.097
[2022-12-01 17:40:10.929649] Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1250.363
[2022-12-01 17:38:29.349101] Epoch: [0][250/260]	Time  1.303 ( 1.453)	Data  0.005 ( 0.086)	Loss 4.6217e+00 (4.6127e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:40:12.233865] Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1304.145
[2022-12-01 17:40:13.450178] Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1216.281
[2022-12-01 17:40:14.854829] Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1404.608
[2022-12-01 17:40:16.418087] Finished iteration 253, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1563.226
[2022-12-01 17:40:17.654388] Finished iteration 254, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1236.278
[2022-12-01 17:40:18.907057] Finished iteration 255, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.626
[2022-12-01 17:40:20.142060] Finished iteration 256, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1234.954
[2022-12-01 17:40:21.479085] Finished iteration 257, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1337.012
[2022-12-01 17:40:22.739941] Finished iteration 258, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1260.789
[2022-12-01 17:40:23.975035] Finished iteration 259, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1235.101
[2022-12-01 17:38:29.349101] Epoch: [0][260/260]	Time  1.278 ( 1.432)	Data  0.006 ( 0.075)	Loss 4.6120e+00 (4.6131e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:40:25.252262] Finished iteration 260, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1277.153
[2022-12-01 17:40:26.474082] Finished iteration 261, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1221.777
[2022-12-01 17:40:27.702195] Finished iteration 262, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1228.072
[2022-12-01 17:40:28.999445] Finished iteration 263, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1297.244
[2022-12-01 17:40:30.260425] Finished iteration 264, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1260.942
[2022-12-01 17:40:31.545662] Finished iteration 265, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1285.211
[2022-12-01 17:40:32.876183] Finished iteration 266, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1330.441
[2022-12-01 17:40:34.131820] Finished iteration 267, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.631
[2022-12-01 17:40:35.404664] Finished iteration 268, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1272.767
Opt ckpt time 1.631516933441162
Process done with return code 0
Parent process ID: 112856 node: 172.31.22.165
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1085584.4648944305 0
End of simulation:  Mini-batch time (usec) = 1426333
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 47 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 13341.7387008667 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1874030
Min send: 10000000, max send 0
Min long send: 541803, max long send 558203
Min fwd: 19455, max fwd 25575; min bwd 51033, max bwd 53581
Min long fwd: 9714, max long fwd 13926; min long bwd 24633, max long bwd 28292
Time taken by simulation: 128 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 10 0 7426.251411437988 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5881272
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 9353, max fwd 19440; min bwd 21838, max bwd 41244
Min long fwd: 1820, max long fwd 9207; min long bwd 11095, max long bwd 16912
Time taken by simulation: 327 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 637 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1592 microseconds

{1: 1.426333, 2: 1.87403, 3: 5.881272, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.87403
11 per stage
22 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 11
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;
World size is 22
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21; --batch-size=192 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 268
[2022-12-01 17:40:58.203715] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.7897601127624512
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
6 chunks
>>>>> [2022-12-01 17:41:25.338652] Time taken to load checkpoint: 20.806s
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 9 signal handler called with signal 10
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:41:42.576675] Finished iteration 269, CKPT_AND_STOP: True, flag: tensor([10], dtype=torch.int32), speed: 8810.560
Opt ckpt time 3.0068562030792236
Process done with return code 0
Parent process ID: 113598 node: 172.31.22.165
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1100319.6399779066 0
End of simulation:  Mini-batch time (usec) = 1441068
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 44 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 14791.502952575684 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1875480
Min send: 10000000, max send 0
Min long send: 541803, max long send 558203
Min fwd: 19455, max fwd 25575; min bwd 51033, max bwd 53581
Min long fwd: 9714, max long fwd 13926; min long bwd 24633, max long bwd 28292
Time taken by simulation: 140 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 8 0 7257.938385009766 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5013330
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 9569, max fwd 19440; min bwd 21459, max bwd 40310
Min long fwd: 3647, max long fwd 6960; min long bwd 11398, max long bwd 19649
Time taken by simulation: 266 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 11 0 3334.3632221221924 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8596253
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 14502, max bwd 31547
Min long fwd: 316, max long fwd 5135; min long bwd 7963, max long bwd 16258
Time taken by simulation: 548 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 16 0 1710.5143070220947 541471.8854995001
End of simulation:  Mini-batch time (usec) = 8451674
Min send: 10000000, max send 0
Min long send: 541525, max long send 566678
Min fwd: 1047, max fwd 12458; min bwd 6945, max bwd 22688
Min long fwd: 301, max long fwd 5892; min long bwd 586, max long bwd 6688
Time taken by simulation: 1136 microseconds

{1: 1.441068, 2: 1.87548, 3: 5.01333, 4: 8.596253, 6: 8.451674}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.87548
12 per stage
24 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 12
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22;1,3,5,7,9,11,13,15,17,19,21,23;
World size is 24
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22;1,3,5,7,9,11,13,15,17,19,21,23; --batch-size=192 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 269
[2022-12-01 17:41:58.983413] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.7911772727966309
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
6 chunks
>>>>> [2022-12-01 17:42:26.750930] Time taken to load checkpoint: 21.430s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:42:26.751142] Epoch: [0][270/260]	Time  8.157 ( 8.157)	Data  1.185 ( 1.185)	Loss 4.6126e+00 (4.6126e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:42:41.335139] Finished iteration 270, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9195.132
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:42:43.619513] Finished iteration 271, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2284.085
[2022-12-01 17:42:44.855308] Finished iteration 272, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1235.701
[2022-12-01 17:42:46.149014] Finished iteration 273, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1293.669
[2022-12-01 17:42:48.387330] Finished iteration 274, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2238.346
[2022-12-01 17:42:49.574317] Finished iteration 275, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1186.881
[2022-12-01 17:42:50.810486] Finished iteration 276, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1236.135
[2022-12-01 17:42:52.031931] Finished iteration 277, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1221.428
[2022-12-01 17:42:53.296145] Finished iteration 278, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1264.159
[2022-12-01 17:42:54.556647] Finished iteration 279, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1260.460
[2022-12-01 17:42:26.751142] Epoch: [0][280/260]	Time  1.184 ( 2.145)	Data  0.008 ( 0.394)	Loss 4.6074e+00 (4.6129e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:42:55.744839] Finished iteration 280, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1188.154
[2022-12-01 17:42:56.997606] Finished iteration 281, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.740
[2022-12-01 17:42:58.230402] Finished iteration 282, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1232.720
[2022-12-01 17:42:59.440214] Finished iteration 283, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1209.770
[2022-12-01 17:43:00.744377] Finished iteration 284, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1304.123
[2022-12-01 17:43:02.216341] Finished iteration 285, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1472.001
[2022-12-01 17:43:03.799498] Finished iteration 286, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.055
[2022-12-01 17:43:05.439293] Finished iteration 287, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1639.746
[2022-12-01 17:43:06.653952] Finished iteration 288, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1214.618
[2022-12-01 17:43:07.933355] Finished iteration 289, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1279.371
[2022-12-01 17:42:26.751142] Epoch: [0][290/260]	Time  1.299 ( 1.766)	Data  0.009 ( 0.211)	Loss 4.6185e+00 (4.6110e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:09.227661] Finished iteration 290, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.272
[2022-12-01 17:43:10.522870] Finished iteration 291, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1295.174
[2022-12-01 17:43:11.751807] Finished iteration 292, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1228.899
[2022-12-01 17:43:12.956818] Finished iteration 293, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1204.968
[2022-12-01 17:43:14.186362] Finished iteration 294, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.510
[2022-12-01 17:43:15.464154] Finished iteration 295, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1277.767
[2022-12-01 17:43:16.711805] Finished iteration 296, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1247.613
[2022-12-01 17:43:17.992849] Finished iteration 297, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1280.998
[2022-12-01 17:43:19.238541] Finished iteration 298, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.671
[2022-12-01 17:43:20.456965] Finished iteration 299, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1218.376
[2022-12-01 17:42:26.751142] Epoch: [0][300/260]	Time  1.249 ( 1.599)	Data  0.009 ( 0.146)	Loss 4.6250e+00 (4.6128e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:21.706503] Finished iteration 300, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.505
[2022-12-01 17:43:22.968165] Finished iteration 301, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1261.630
[2022-12-01 17:43:24.200274] Finished iteration 302, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1232.082
[2022-12-01 17:43:25.480923] Finished iteration 303, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1280.610
[2022-12-01 17:43:26.690835] Finished iteration 304, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1209.850
[2022-12-01 17:43:27.928406] Finished iteration 305, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1237.544
[2022-12-01 17:43:29.108306] Finished iteration 306, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1179.858
[2022-12-01 17:43:30.455400] Finished iteration 307, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1347.080
[2022-12-01 17:43:31.658987] Finished iteration 308, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1203.539
[2022-12-01 17:43:32.956052] Finished iteration 309, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1297.012
[2022-12-01 17:42:26.751142] Epoch: [0][310/260]	Time  1.228 ( 1.513)	Data  0.015 ( 0.113)	Loss 4.6074e+00 (4.6116e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:34.174653] Finished iteration 310, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1218.565
[2022-12-01 17:43:35.411888] Finished iteration 311, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1237.208
[2022-12-01 17:43:36.675609] Finished iteration 312, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1263.708
[2022-12-01 17:43:37.905083] Finished iteration 313, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.410
[2022-12-01 17:43:39.193652] Finished iteration 314, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1288.581
[2022-12-01 17:43:40.443110] Finished iteration 315, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.382
[2022-12-01 17:43:41.676796] Finished iteration 316, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1233.635
[2022-12-01 17:43:42.923283] Finished iteration 317, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1246.452
[2022-12-01 17:43:44.158798] Finished iteration 318, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1235.478
[2022-12-01 17:43:45.372333] Finished iteration 319, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1213.499
[2022-12-01 17:42:26.751142] Epoch: [0][320/260]	Time  1.195 ( 1.459)	Data  0.005 ( 0.093)	Loss 4.6061e+00 (4.6110e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:46.573797] Finished iteration 320, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1201.456
[2022-12-01 17:43:47.890902] Finished iteration 321, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1317.057
[2022-12-01 17:43:49.121899] Finished iteration 322, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1230.961
[2022-12-01 17:43:50.389329] Finished iteration 323, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1267.382
[2022-12-01 17:43:51.617298] Finished iteration 324, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1227.934
[2022-12-01 17:43:52.919669] Finished iteration 325, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1302.348
[2022-12-01 17:43:54.237985] Finished iteration 326, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1318.283
[2022-12-01 17:43:55.513306] Finished iteration 327, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1275.263
[2022-12-01 17:43:56.778707] Finished iteration 328, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1265.364
[2022-12-01 17:43:58.607188] Finished iteration 329, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1828.583
[2022-12-01 17:42:26.751142] Epoch: [0][330/260]	Time  1.396 ( 1.440)	Data  0.026 ( 0.079)	Loss 4.6035e+00 (4.6112e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:00.003650] Finished iteration 330, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.288
[2022-12-01 17:44:01.277984] Finished iteration 331, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1274.304
[2022-12-01 17:44:02.573424] Finished iteration 332, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1295.410
[2022-12-01 17:44:03.835428] Finished iteration 333, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1261.985
[2022-12-01 17:44:05.074887] Finished iteration 334, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1239.415
[2022-12-01 17:44:06.343386] Finished iteration 335, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1268.455
[2022-12-01 17:44:07.589298] Finished iteration 336, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.874
[2022-12-01 17:44:08.888608] Finished iteration 337, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1299.270
[2022-12-01 17:44:10.212776] Finished iteration 338, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1324.132
[2022-12-01 17:44:11.496157] Finished iteration 339, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1283.332
[2022-12-01 17:42:26.751142] Epoch: [0][340/260]	Time  1.248 ( 1.417)	Data  0.014 ( 0.069)	Loss 4.6243e+00 (4.6119e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:12.745994] Finished iteration 340, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.794
[2022-12-01 17:44:14.026837] Finished iteration 341, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1280.827
[2022-12-01 17:44:15.234454] Finished iteration 342, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1207.585
[2022-12-01 17:44:16.487375] Finished iteration 343, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.869
[2022-12-01 17:44:17.744202] Finished iteration 344, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1256.792
[2022-12-01 17:44:18.967509] Finished iteration 345, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1223.268
[2022-12-01 17:44:20.154404] Finished iteration 346, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1186.858
[2022-12-01 17:44:21.415480] Finished iteration 347, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1261.035
[2022-12-01 17:44:22.661566] Finished iteration 348, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1246.051
[2022-12-01 17:44:23.892536] Finished iteration 349, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1230.931
[2022-12-01 17:42:26.751142] Epoch: [0][350/260]	Time  1.220 ( 1.395)	Data  0.014 ( 0.062)	Loss 4.6100e+00 (4.6116e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:25.114340] Finished iteration 350, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1221.786
[2022-12-01 17:44:26.409168] Finished iteration 351, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.787
[2022-12-01 17:44:27.620184] Finished iteration 352, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1210.975
[2022-12-01 17:44:28.867542] Finished iteration 353, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1247.319
[2022-12-01 17:44:30.114168] Finished iteration 354, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1246.645
[2022-12-01 17:44:31.359923] Finished iteration 355, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.667
[2022-12-01 17:44:32.550718] Finished iteration 356, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1190.759
[2022-12-01 17:44:33.808678] Finished iteration 357, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1257.922
[2022-12-01 17:44:35.005398] Finished iteration 358, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1196.676
[2022-12-01 17:44:36.264417] Finished iteration 359, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1258.998
[2022-12-01 17:42:26.751142] Epoch: [0][360/260]	Time  1.262 ( 1.378)	Data  0.011 ( 0.056)	Loss 4.6126e+00 (4.6116e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:37.523007] Finished iteration 360, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1258.533
[2022-12-01 17:44:38.822549] Finished iteration 361, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1299.514
[2022-12-01 17:44:40.000255] Finished iteration 362, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1177.686
[2022-12-01 17:44:41.246141] Finished iteration 363, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.849
[2022-12-01 17:44:42.468912] Finished iteration 364, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1222.717
[2022-12-01 17:44:43.677969] Finished iteration 365, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1209.017
[2022-12-01 17:44:44.926528] Finished iteration 366, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1248.542
[2022-12-01 17:44:46.182978] Finished iteration 367, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1256.392
[2022-12-01 17:44:47.401896] Finished iteration 368, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1218.883
[2022-12-01 17:44:48.617950] Finished iteration 369, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1216.018
[2022-12-01 17:42:26.751142] Epoch: [0][370/260]	Time  1.216 ( 1.363)	Data  0.010 ( 0.052)	Loss 4.6022e+00 (4.6117e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:49.832267] Finished iteration 370, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1214.288
[2022-12-01 17:44:51.099296] Finished iteration 371, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1266.999
[2022-12-01 17:44:52.289512] Finished iteration 372, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1190.191
[2022-12-01 17:44:53.531914] Finished iteration 373, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1242.355
[2022-12-01 17:44:54.787000] Finished iteration 374, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.044
[2022-12-01 17:44:56.035654] Finished iteration 375, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1248.610
[2022-12-01 17:44:57.279424] Finished iteration 376, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1243.735
[2022-12-01 17:44:58.554593] Finished iteration 377, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1275.131
[2022-12-01 17:44:59.806846] Finished iteration 378, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.216
[2022-12-01 17:45:01.076981] Finished iteration 379, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1270.111
[2022-12-01 17:42:26.751142] Epoch: [0][380/260]	Time  1.248 ( 1.353)	Data  0.006 ( 0.048)	Loss 4.6068e+00 (4.6117e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:45:02.326774] Finished iteration 380, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.763
[2022-12-01 17:45:03.579674] Finished iteration 381, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.887
[2022-12-01 17:45:04.803110] Finished iteration 382, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1223.382
[2022-12-01 17:45:06.088973] Finished iteration 383, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1285.828
Opt ckpt time 2.59031081199646
Process done with return code 0
Parent process ID: 132791 node: 172.31.28.236
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1037195.476436041 0
End of simulation:  Mini-batch time (usec) = 1491169
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 42 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 12531.734466552734 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1936784
Min send: 10000000, max send 0
Min long send: 541659, max long send 557166
Min fwd: 19455, max fwd 25575; min bwd 50188, max bwd 55357
Min long fwd: 9714, max long fwd 12638; min long bwd 24390, max long bwd 30607
Time taken by simulation: 149 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 352 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 581 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1606 microseconds

{1: 1.491169, 2: 1.936784, 3: 6.713432, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.936784
10 per stage
20 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 383
[2022-12-01 17:45:59.448925] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.9686691761016846
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
7 chunks
>>>>> [2022-12-01 17:46:34.079657] Time taken to load checkpoint: 28.145s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:46:49.994861] Finished iteration 384, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9730.129
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:46:52.483738] Finished iteration 385, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2488.669
[2022-12-01 17:46:54.880812] Finished iteration 386, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2397.018
[2022-12-01 17:46:56.272645] Finished iteration 387, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1391.746
[2022-12-01 17:46:57.653017] Finished iteration 388, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1380.345
[2022-12-01 17:46:59.072968] Finished iteration 389, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1419.915
[2022-12-01 17:46:34.079856] Epoch: [0][390/223]	Time  1.433 ( 2.891)	Data  0.004 ( 0.645)	Loss 4.6127e+00 (4.6073e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:47:00.505678] Finished iteration 390, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1432.664
[2022-12-01 17:47:01.956222] Finished iteration 391, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1450.547
[2022-12-01 17:47:03.362118] Finished iteration 392, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1405.869
[2022-12-01 17:47:04.886218] Finished iteration 393, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1524.023
[2022-12-01 17:47:06.359469] Finished iteration 394, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1473.268
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 9 signal handler called with signal 10
Opt ckpt time 15.787671327590942
Process done with return code 0
Parent process ID: 133600 node: 172.31.28.236
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 959937.744140625 0
End of simulation:  Mini-batch time (usec) = 1413911
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 42 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009207
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 161 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 13 0 5941.788673400879 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7626781
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 21579, max bwd 43006
Min long fwd: 1397, max long fwd 9139; min long bwd 11398, max long bwd 19649
Time taken by simulation: 413 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 723 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2341 microseconds

{1: 1.413911, 2: 2.009207, 3: 7.626781, 4: 10.570352, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009207
8 per stage
16 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 8
stage to rank map: 0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15; --batch-size=256 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 394
[2022-12-01 17:47:56.789810] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8186092376708984
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
8 chunks
>>>>> [2022-12-01 17:48:29.381611] Time taken to load checkpoint: 26.305s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:48:44.151698] Finished iteration 395, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10148.246
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:48:46.579874] Finished iteration 396, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2427.940
[2022-12-01 17:48:49.173272] Finished iteration 397, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2593.328
[2022-12-01 17:48:51.669938] Finished iteration 398, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2496.678
[2022-12-01 17:48:54.197883] Finished iteration 399, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2527.910
[2022-12-01 17:48:29.381824] Epoch: [0][400/195]	Time  2.604 ( 3.628)	Data  1.033 ( 1.055)	Loss 4.6177e+00 (4.6117e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:48:55.774350] Finished iteration 400, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1576.320
[2022-12-01 17:48:57.255142] Finished iteration 401, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1480.773
[2022-12-01 17:48:58.704375] Finished iteration 402, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1449.201
[2022-12-01 17:49:00.281813] Finished iteration 403, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1577.408
[2022-12-01 17:49:01.846203] Finished iteration 404, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1564.334
[2022-12-01 17:49:03.386117] Finished iteration 405, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1539.927
[2022-12-01 17:49:04.906998] Finished iteration 406, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.798
[2022-12-01 17:49:06.347473] Finished iteration 407, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1440.473
Opt ckpt time 2.1614601612091064
Process done with return code 0
Parent process ID: 156230 node: 172.31.21.45
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 469314.3005371094 0
End of simulation:  Mini-batch time (usec) = 1031482
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31455, max long fwd 34870; min long bwd 76739, max long bwd 82859
Time taken by simulation: 47 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 10 0 14465.604782104492 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2417640
Min send: 10000000, max send 0
Min long send: 541659, max long send 557502
Min fwd: 17296, max fwd 25575; min bwd 47081, max bwd 56289
Min long fwd: 10095, max long fwd 15512; min long bwd 26495, max long bwd 30607
Time taken by simulation: 196 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 16 0 5187.531471252441 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8666579
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 8673, max fwd 19564; min bwd 21579, max bwd 41244
Min long fwd: 1397, max long fwd 8270; min long bwd 12229, max long bwd 19649
Time taken by simulation: 506 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 995 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2310 microseconds

{1: 1.031482, 2: 2.41764, 3: 8.666579, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.41764
7 per stage
14 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 7
stage to rank map: 0,2,4,6,8,10,12;1,3,5,7,9,11,13;
World size is 14
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12;1,3,5,7,9,11,13; --batch-size=288 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 407
[2022-12-01 17:49:54.092618] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.7754430770874023
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
9 chunks
>>>>> [2022-12-01 17:50:24.576049] Time taken to load checkpoint: 24.213s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:50:39.499884] Finished iteration 408, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9891.994
[2022-12-01 17:50:41.065344] Finished iteration 409, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1565.134
[2022-12-01 17:50:24.576259] Epoch: [0][410/173]	Time  1.511 ( 4.321)	Data  0.005 ( 0.801)	Loss 4.6207e+00 (4.6092e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:50:42.575595] Finished iteration 410, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1510.231
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:50:45.227747] Finished iteration 411, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2652.167
[2022-12-01 17:50:47.870634] Finished iteration 412, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2642.802
[2022-12-01 17:50:49.501130] Finished iteration 413, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1630.443
[2022-12-01 17:50:51.025168] Finished iteration 414, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1523.996
[2022-12-01 17:50:52.501084] Finished iteration 415, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1475.892
[2022-12-01 17:50:54.002075] Finished iteration 416, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1500.942
[2022-12-01 17:50:55.560955] Finished iteration 417, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1558.843
[2022-12-01 17:50:57.700886] Finished iteration 418, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2139.890
[2022-12-01 17:50:59.226104] Finished iteration 419, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1525.176
[2022-12-01 17:50:24.576259] Epoch: [0][420/173]	Time  1.526 ( 2.395)	Data  0.006 ( 0.268)	Loss 4.6111e+00 (4.6116e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:51:00.750701] Finished iteration 420, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1524.546
[2022-12-01 17:51:02.319461] Finished iteration 421, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1568.738
[2022-12-01 17:51:03.861493] Finished iteration 422, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1541.989
[2022-12-01 17:51:05.443492] Finished iteration 423, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1581.986
Opt ckpt time 2.215351104736328
Process done with return code 0
Parent process ID: 142778 node: 172.31.23.137
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 6 0 478294.921875 0
End of simulation:  Mini-batch time (usec) = 1146326
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31284, max long fwd 34870; min long bwd 74580, max long bwd 82859
Time taken by simulation: 61 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 11 0 13647.623062133789 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2484115
Min send: 10000000, max send 0
Min long send: 541803, max long send 558040
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 56289
Min long fwd: 7598, max long fwd 15512; min long bwd 23528, max long bwd 31338
Time taken by simulation: 214 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 16 0 5187.531471252441 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8666579
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 8673, max fwd 19564; min bwd 21579, max bwd 41244
Min long fwd: 1397, max long fwd 8270; min long bwd 12229, max long bwd 19649
Time taken by simulation: 503 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 1023 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2310 microseconds

{1: 1.146326, 2: 2.484115, 3: 8.666579, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.484115
6 per stage
12 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 6
stage to rank map: 0,2,4,6,8,10;1,3,5,7,9,11;
World size is 12
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10;1,3,5,7,9,11; --batch-size=352 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 423
[2022-12-01 17:51:52.827803] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.791832685470581
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
11 chunks
>>>>> [2022-12-01 17:52:22.039257] Time taken to load checkpoint: 22.991s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:52:33.762506] Finished iteration 424, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10650.706
[2022-12-01 17:52:36.603408] Finished iteration 425, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2840.662
[2022-12-01 17:52:38.288756] Finished iteration 426, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1685.256
[2022-12-01 17:52:41.060377] Finished iteration 427, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2771.637
[2022-12-01 17:52:43.874797] Finished iteration 428, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2814.362
[2022-12-01 17:52:45.637123] Finished iteration 429, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1762.220
[2022-12-01 17:52:22.039468] Epoch: [0][430/142]	Time  1.760 ( 3.469)	Data  0.005 ( 0.814)	Loss 4.6161e+00 (4.6131e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:52:47.398791] Finished iteration 430, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1761.620
[2022-12-01 17:52:49.040173] Finished iteration 431, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1641.395
[2022-12-01 17:52:50.798593] Finished iteration 432, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1758.379
[2022-12-01 17:52:52.616094] Finished iteration 433, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1817.459
[2022-12-01 17:52:54.327634] Finished iteration 434, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1711.509
[2022-12-01 17:52:56.035929] Finished iteration 435, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1708.211
[2022-12-01 17:52:57.756565] Finished iteration 436, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1720.593
[2022-12-01 17:52:59.616988] Finished iteration 437, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1860.387
[2022-12-01 17:53:01.376221] Finished iteration 438, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1759.206
[2022-12-01 17:53:03.096389] Finished iteration 439, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1720.140
[2022-12-01 17:52:22.039468] Epoch: [0][440/142]	Time  1.722 ( 2.453)	Data  0.002 ( 0.338)	Loss 4.6218e+00 (4.6122e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:53:04.820579] Finished iteration 440, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1724.153
[2022-12-01 17:53:06.643203] Finished iteration 441, CKPT_AND_STOP: False, flag: tensor([3], dtype=torch.int32), speed: 1822.590
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 9 signal handler called with signal 10
Opt ckpt time 4.908451557159424
Process done with return code 0
Parent process ID: 143480 node: 172.31.23.137
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 6 0 497567.2607421875 0
End of simulation:  Mini-batch time (usec) = 1165599
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31284, max long fwd 34870; min long bwd 74580, max long bwd 82859
Time taken by simulation: 49 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 13 0 12498.029708862305 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2874755
Min send: 10000000, max send 0
Min long send: 541803, max long send 563937
Min fwd: 17296, max fwd 25575; min bwd 47735, max bwd 55357
Min long fwd: 7598, max long fwd 14849; min long bwd 24322, max long bwd 32202
Time taken by simulation: 252 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 22 0 4141.171932220459 929913.8118823369
End of simulation:  Mini-batch time (usec) = 11451838
Min send: 10000000, max send 0
Min long send: 929967, max long send 954618
Min fwd: 8603, max fwd 20089; min bwd 21625, max bwd 40495
Min long fwd: 1164, max long fwd 9503; min long bwd 9931, max long bwd 18021
Time taken by simulation: 681 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 32 0 1087.188720703125 929913.8118823369
End of simulation:  Mini-batch time (usec) = 17990792
Min send: 10000000, max send 0
Min long send: 930050, max long send 957075
Min fwd: 2858, max fwd 17644; min bwd 11474, max bwd 32286
Min long fwd: 119, max long fwd 8691; min long bwd 8026, max long bwd 15012
Time taken by simulation: 1465 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 64 0 0 541471.8854995001
End of simulation:  Mini-batch time (usec) = 21532634
Min send: 10000000, max send 0
Min long send: 541471, max long send 571475
Min fwd: 85, max fwd 13150; min bwd 6220, max bwd 26656
Min long fwd: 6, max long fwd 6029; min long bwd 316, max long bwd 8101
Time taken by simulation: 4734 microseconds

{1: 1.165599, 2: 2.874755, 3: 11.451838, 4: 17.990792, 6: 21.532634}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.874755
5 per stage
10 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 5
stage to rank map: 0,2,4,6,8;1,3,5,7,9;
World size is 10
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8;1,3,5,7,9; --batch-size=416 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 441
[2022-12-01 17:53:51.473829] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.7814199924468994
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
13 chunks
>>>>> [2022-12-01 17:54:19.148407] Time taken to load checkpoint: 21.506s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:54:29.100113] Finished iteration 442, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9760.536
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:54:31.050366] Finished iteration 443, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1950.032
[2022-12-01 17:54:33.082118] Finished iteration 444, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2031.692
[2022-12-01 17:54:34.986329] Finished iteration 445, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1904.170
[2022-12-01 17:54:36.963614] Finished iteration 446, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1977.328
[2022-12-01 17:54:38.943322] Finished iteration 447, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1979.606
[2022-12-01 17:54:40.914010] Finished iteration 448, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1970.636
[2022-12-01 17:54:42.983135] Finished iteration 449, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2069.084
[2022-12-01 17:54:19.148651] Epoch: [0][450/120]	Time  1.890 ( 2.836)	Data  0.011 ( 0.288)	Loss 4.6190e+00 (4.6137e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:54:44.864129] Finished iteration 450, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1880.946
[2022-12-01 17:54:46.894003] Finished iteration 451, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2029.849
[2022-12-01 17:54:48.768047] Finished iteration 452, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1874.003
[2022-12-01 17:54:50.683106] Finished iteration 453, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1915.015
[2022-12-01 17:54:52.635303] Finished iteration 454, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1952.154
[2022-12-01 17:54:54.604526] Finished iteration 455, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1969.179
[2022-12-01 17:54:56.507388] Finished iteration 456, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1902.816
[2022-12-01 17:54:58.537427] Finished iteration 457, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2029.994
[2022-12-01 17:55:00.606205] Finished iteration 458, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2068.737
[2022-12-01 17:55:02.591768] Finished iteration 459, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1985.522
[2022-12-01 17:54:19.148651] Epoch: [0][460/120]	Time  2.025 ( 2.383)	Data  0.004 ( 0.138)	Loss 4.6166e+00 (4.6127e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:55:04.614961] Finished iteration 460, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2023.144
[2022-12-01 17:55:06.616263] Finished iteration 461, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2001.280
[2022-12-01 17:55:08.541756] Finished iteration 462, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1925.479
[2022-12-01 17:55:10.427799] Finished iteration 463, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1885.988
[2022-12-01 17:55:12.457655] Finished iteration 464, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2029.809
[2022-12-01 17:55:14.449869] Finished iteration 465, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1992.161
[2022-12-01 17:55:16.522928] Finished iteration 466, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2073.023
[2022-12-01 17:55:18.718564] Finished iteration 467, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2195.596
[2022-12-01 17:55:20.726671] Finished iteration 468, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2008.060
[2022-12-01 17:55:22.864423] Finished iteration 469, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2137.704
[2022-12-01 17:54:19.148651] Epoch: [0][470/120]	Time  2.021 ( 2.260)	Data  0.002 ( 0.091)	Loss 4.6166e+00 (4.6123e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:55:24.888263] Finished iteration 470, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2023.799
[2022-12-01 17:55:27.035970] Finished iteration 471, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2147.685
[2022-12-01 17:55:29.041292] Finished iteration 472, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2005.298
[2022-12-01 17:55:31.110298] Finished iteration 473, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2068.938
[2022-12-01 17:55:32.970928] Finished iteration 474, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1860.588
[2022-12-01 17:55:34.942369] Finished iteration 475, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1971.406
[2022-12-01 17:55:36.979197] Finished iteration 476, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2036.788
[2022-12-01 17:55:38.982609] Finished iteration 477, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2003.366
[2022-12-01 17:55:41.184222] Finished iteration 478, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2201.563
[2022-12-01 17:55:43.188998] Finished iteration 479, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2004.772
[2022-12-01 17:54:19.148651] Epoch: [0][480/120]	Time  2.063 ( 2.203)	Data  0.002 ( 0.068)	Loss 4.6112e+00 (4.6125e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:55:45.251692] Finished iteration 480, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2062.660
[2022-12-01 17:55:47.192651] Finished iteration 481, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1940.901
[2022-12-01 17:55:49.105987] Finished iteration 482, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1913.290
[2022-12-01 17:55:50.928248] Finished iteration 483, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1822.235
[2022-12-01 17:55:52.833622] Finished iteration 484, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1905.332
[2022-12-01 17:55:54.924744] Finished iteration 485, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2091.072
[2022-12-01 17:55:56.922819] Finished iteration 486, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1998.032
[2022-12-01 17:55:58.956450] Finished iteration 487, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2033.583
[2022-12-01 17:56:00.878664] Finished iteration 488, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1922.177
[2022-12-01 17:56:02.653240] Finished iteration 489, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1774.523
[2022-12-01 17:54:19.148651] Epoch: [0][490/120]	Time  1.965 ( 2.148)	Data  0.003 ( 0.055)	Loss 4.6229e+00 (4.6119e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:56:04.619573] Finished iteration 490, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1966.339
[2022-12-01 17:56:06.670507] Finished iteration 491, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2050.865
[2022-12-01 17:56:08.489756] Finished iteration 492, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1819.214
[2022-12-01 17:56:10.495311] Finished iteration 493, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2005.499
[2022-12-01 17:56:12.379371] Finished iteration 494, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1884.032
[2022-12-01 17:56:14.349994] Finished iteration 495, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1970.579
[2022-12-01 17:56:16.629755] Finished iteration 496, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2279.710
[2022-12-01 17:56:18.747034] Finished iteration 497, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2117.247
[2022-12-01 17:56:20.677603] Finished iteration 498, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1930.524
[2022-12-01 17:56:22.552361] Finished iteration 499, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1874.718
[2022-12-01 17:54:19.148651] Epoch: [0][500/120]	Time  1.886 ( 2.120)	Data  0.003 ( 0.046)	Loss 4.6097e+00 (4.6117e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:56:24.438320] Finished iteration 500, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1885.952
[2022-12-01 17:56:26.255538] Finished iteration 501, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1817.195
[2022-12-01 17:56:28.132380] Finished iteration 502, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1876.771
[2022-12-01 17:56:29.979840] Finished iteration 503, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1847.387
[2022-12-01 17:56:31.859962] Finished iteration 504, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1880.075
[2022-12-01 17:56:33.844215] Finished iteration 505, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1984.213
[2022-12-01 17:56:35.782400] Finished iteration 506, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1938.150
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 9 signal handler called with signal 10
Parent process ID: 144241 node: 172.31.23.137
Killing process on gpu with nvidia-smi | grep 'python' | awk '{ print $5 }' | xargs -n1 kill -9
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 6 0 478294.921875 0
End of simulation:  Mini-batch time (usec) = 1146326
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31284, max long fwd 34870; min long bwd 74580, max long bwd 82859
Time taken by simulation: 56 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 11 0 13647.623062133789 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2484115
Min send: 10000000, max send 0
Min long send: 541803, max long send 558040
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 56289
Min long fwd: 7598, max long fwd 15512; min long bwd 23528, max long bwd 31338
Time taken by simulation: 219 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 16 0 5187.531471252441 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8666579
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 8673, max fwd 19564; min bwd 21579, max bwd 41244
Min long fwd: 1397, max long fwd 8270; min long bwd 12229, max long bwd 19649
Time taken by simulation: 500 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 985 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2389 microseconds

{1: 1.146326, 2: 2.484115, 3: 8.666579, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.484115
6 per stage
12 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 6
stage to rank map: 0,2,4,6,8,10;1,3,5,7,9,11;
World size is 12
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10;1,3,5,7,9,11; --batch-size=352 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 506
[2022-12-01 17:56:51.225581] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.7411267757415771
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
11 chunks
>>>>> [2022-12-01 17:57:11.638217] Time taken to load checkpoint: 14.214s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:57:21.938884] Finished iteration 507, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10297.914
[2022-12-01 17:57:24.692110] Finished iteration 508, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2753.039
[2022-12-01 17:57:27.443615] Finished iteration 509, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2751.499
[2022-12-01 17:57:11.638525] Epoch: [0][510/142]	Time  2.732 ( 4.378)	Data  1.022 ( 0.952)	Loss 4.6179e+00 (4.6130e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:57:30.179264] Finished iteration 510, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2735.581
[2022-12-01 17:57:32.883109] Finished iteration 511, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2703.815
[2022-12-01 17:57:34.680924] Finished iteration 512, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1797.699
[2022-12-01 17:57:36.458218] Finished iteration 513, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1777.257
Opt ckpt time 3.2544031143188477
Signal handler called with signal 10


 STOPPING VARUNA !!



Process done with return code 0
Parent process ID: 144854 node: 172.31.23.137
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 469314.3005371094 0
End of simulation:  Mini-batch time (usec) = 1031482
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31455, max long fwd 34870; min long bwd 76739, max long bwd 82859
Time taken by simulation: 48 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 11 0 13647.623062133789 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2484115
Min send: 10000000, max send 0
Min long send: 541803, max long send 558040
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 56289
Min long fwd: 7598, max long fwd 15512; min long bwd 23528, max long bwd 31338
Time taken by simulation: 213 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 16 0 5187.531471252441 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8666579
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 8673, max fwd 19564; min bwd 21579, max bwd 41244
Min long fwd: 1397, max long fwd 8270; min long bwd 12229, max long bwd 19649
Time taken by simulation: 515 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 1072 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2379 microseconds

{1: 1.031482, 2: 2.484115, 3: 8.666579, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.484115
6 per stage
12 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 6
stage to rank map: 0,2,4,6,8,10;1,3,5,7,9,11;
World size is 12
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10;1,3,5,7,9,11; --batch-size=352 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 513
[2022-12-01 17:57:51.398067] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8010671138763428
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
11 chunks
>>>>> [2022-12-01 17:58:12.905161] Time taken to load checkpoint: 15.227s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:58:28.117722] Finished iteration 514, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10350.897
[2022-12-01 17:58:30.852622] Finished iteration 515, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2734.672
[2022-12-01 17:58:33.698681] Finished iteration 516, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2845.992
[2022-12-01 17:58:36.563606] Finished iteration 517, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2864.938
[2022-12-01 17:58:39.389545] Finished iteration 518, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2825.849
[2022-12-01 17:58:41.220848] Finished iteration 519, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1831.189
[2022-12-01 17:58:12.905402] Epoch: [0][520/142]	Time  1.758 ( 3.601)	Data  0.002 ( 1.003)	Loss 4.6129e+00 (4.6089e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:58:42.986798] Finished iteration 520, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1765.898
[2022-12-01 17:58:44.760000] Finished iteration 521, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1773.184
[2022-12-01 17:58:46.552682] Finished iteration 522, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1792.676
[2022-12-01 17:58:48.423241] Finished iteration 523, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1870.501
[2022-12-01 17:58:50.496757] Finished iteration 524, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2073.465
[2022-12-01 17:58:52.305530] Finished iteration 525, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1808.728
[2022-12-01 17:58:54.185239] Finished iteration 526, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1879.700
[2022-12-01 17:58:55.996158] Finished iteration 527, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1810.844
[2022-12-01 17:58:57.627479] Finished iteration 528, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1631.266
[2022-12-01 17:58:59.433004] Finished iteration 529, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1805.529
[2022-12-01 17:58:12.905402] Epoch: [0][530/142]	Time  1.851 ( 2.560)	Data  0.003 ( 0.416)	Loss 4.6122e+00 (4.6099e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:59:01.283719] Finished iteration 530, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1850.666
[2022-12-01 17:59:03.142201] Finished iteration 531, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1858.471
[2022-12-01 17:59:04.953177] Finished iteration 532, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1810.887
Opt ckpt time 2.960563898086548
Process done with return code 0
Parent process ID: 126442 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 6 0 478294.921875 0
End of simulation:  Mini-batch time (usec) = 1146326
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31284, max long fwd 34870; min long bwd 74580, max long bwd 82859
Time taken by simulation: 53 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 11 0 13647.623062133789 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2484115
Min send: 10000000, max send 0
Min long send: 541803, max long send 558040
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 56289
Min long fwd: 7598, max long fwd 15512; min long bwd 23528, max long bwd 31338
Time taken by simulation: 223 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 16 0 5187.531471252441 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8666579
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 8673, max fwd 19564; min bwd 21579, max bwd 41244
Min long fwd: 1397, max long fwd 8270; min long bwd 12229, max long bwd 19649
Time taken by simulation: 506 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 986 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2378 microseconds

{1: 1.146326, 2: 2.484115, 3: 8.666579, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.484115
6 per stage
12 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 6
stage to rank map: 0,2,4,6,8,10;1,3,5,7,9,11;
World size is 12
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10;1,3,5,7,9,11; --batch-size=352 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 532
[2022-12-01 17:59:51.886954] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.7632911205291748
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
11 chunks
>>>>> [2022-12-01 18:00:20.990865] Time taken to load checkpoint: 22.960s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:00:35.284511] Finished iteration 533, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10332.622
[2022-12-01 18:00:38.018100] Finished iteration 534, CKPT_AND_STOP: False, flag: tensor([4], dtype=torch.int32), speed: 2733.368
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 9 signal handler called with signal 10
Opt ckpt time 4.258408546447754
Parent process ID: 127077 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 469314.3005371094 0
End of simulation:  Mini-batch time (usec) = 1031482
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31455, max long fwd 34870; min long bwd 76739, max long bwd 82859
Time taken by simulation: 48 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 11 0 13647.623062133789 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2484115
Min send: 10000000, max send 0
Min long send: 541803, max long send 558040
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 56289
Min long fwd: 7598, max long fwd 15512; min long bwd 23528, max long bwd 31338
Time taken by simulation: 255 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 16 0 5187.531471252441 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8666579
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 8673, max fwd 19564; min bwd 21579, max bwd 41244
Min long fwd: 1397, max long fwd 8270; min long bwd 12229, max long bwd 19649
Time taken by simulation: 501 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 989 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2360 microseconds

{1: 1.031482, 2: 2.484115, 3: 8.666579, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.484115
6 per stage
12 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 6
stage to rank map: 0,2,4,6,8,10;1,3,5,7,9,11;
World size is 12
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10;1,3,5,7,9,11; --batch-size=352 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 534
[2022-12-01 18:00:51.623167] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.7301149368286133
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
11 chunks
>>>>> [2022-12-01 18:01:12.963250] Time taken to load checkpoint: 14.896s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:01:28.274019] Finished iteration 535, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10304.779
[2022-12-01 18:01:30.979446] Finished iteration 536, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2705.203
[2022-12-01 18:01:33.556825] Finished iteration 537, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2577.266
[2022-12-01 18:01:36.156517] Finished iteration 538, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2599.716
[2022-12-01 18:01:38.945582] Finished iteration 539, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2789.004
[2022-12-01 18:01:12.963461] Epoch: [0][540/142]	Time  2.689 ( 3.774)	Data  1.023 ( 0.989)	Loss 4.6112e+00 (4.6137e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:01:40.614630] Finished iteration 540, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1668.948
[2022-12-01 18:01:42.309868] Finished iteration 541, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1695.218
[2022-12-01 18:01:43.866199] Finished iteration 542, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1556.277
[2022-12-01 18:01:45.456823] Finished iteration 543, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1590.591
[2022-12-01 18:01:47.070025] Finished iteration 544, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1613.161
[2022-12-01 18:01:48.676898] Finished iteration 545, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1606.823
[2022-12-01 18:01:50.264535] Finished iteration 546, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1587.615
[2022-12-01 18:01:51.804923] Finished iteration 547, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1540.349
[2022-12-01 18:01:53.520050] Finished iteration 548, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1715.081
[2022-12-01 18:01:55.200322] Finished iteration 549, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1680.224
[2022-12-01 18:01:12.963461] Epoch: [0][550/142]	Time  1.719 ( 2.434)	Data  0.003 ( 0.373)	Loss 4.6112e+00 (4.6125e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:01:56.921952] Finished iteration 550, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1721.600
[2022-12-01 18:01:58.576496] Finished iteration 551, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1654.523
[2022-12-01 18:02:00.319530] Finished iteration 552, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1742.980
[2022-12-01 18:02:02.009445] Finished iteration 553, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1689.878
[2022-12-01 18:02:03.579216] Finished iteration 554, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1569.731
[2022-12-01 18:02:05.126418] Finished iteration 555, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1547.171
[2022-12-01 18:02:06.778188] Finished iteration 556, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1651.742
[2022-12-01 18:02:08.370166] Finished iteration 557, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1591.915
[2022-12-01 18:02:09.982996] Finished iteration 558, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1612.790
[2022-12-01 18:02:11.704922] Finished iteration 559, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1721.885
[2022-12-01 18:01:12.963461] Epoch: [0][560/142]	Time  1.681 ( 2.131)	Data  0.002 ( 0.230)	Loss 4.6136e+00 (4.6127e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:02:13.386561] Finished iteration 560, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1681.609
[2022-12-01 18:02:15.074613] Finished iteration 561, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1688.028
[2022-12-01 18:02:16.772728] Finished iteration 562, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1698.071
[2022-12-01 18:02:18.498017] Finished iteration 563, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1725.250
[2022-12-01 18:02:20.208041] Finished iteration 564, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1709.984
[2022-12-01 18:02:21.838737] Finished iteration 565, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1630.659
[2022-12-01 18:02:23.524784] Finished iteration 566, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1686.006
[2022-12-01 18:02:25.192147] Finished iteration 567, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1667.307
[2022-12-01 18:02:26.928982] Finished iteration 568, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1736.816
[2022-12-01 18:02:28.609479] Finished iteration 569, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1680.467
[2022-12-01 18:01:12.963461] Epoch: [0][570/142]	Time  1.650 ( 2.008)	Data  0.003 ( 0.167)	Loss 4.6065e+00 (4.6121e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:02:30.259062] Finished iteration 570, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1649.516
[2022-12-01 18:02:31.922040] Finished iteration 571, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1662.958
[2022-12-01 18:02:33.620990] Finished iteration 572, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1698.914
[2022-12-01 18:02:35.360505] Finished iteration 573, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1739.486
[2022-12-01 18:02:37.035703] Finished iteration 574, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1675.143
[2022-12-01 18:02:38.727528] Finished iteration 575, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1691.813
[2022-12-01 18:02:40.516350] Finished iteration 576, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1788.759
[2022-12-01 18:02:42.066107] Finished iteration 577, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1549.718
[2022-12-01 18:02:43.693118] Finished iteration 578, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1627.004
[2022-12-01 18:02:45.411195] Finished iteration 579, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1718.020
[2022-12-01 18:01:12.963461] Epoch: [0][580/142]	Time  1.612 ( 1.936)	Data  0.005 ( 0.131)	Loss 4.6151e+00 (4.6122e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:02:47.020720] Finished iteration 580, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1609.466
[2022-12-01 18:02:48.748699] Finished iteration 581, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1727.959
[2022-12-01 18:02:50.332811] Finished iteration 582, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1584.068
[2022-12-01 18:02:52.040129] Finished iteration 583, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1707.293
[2022-12-01 18:02:53.692418] Finished iteration 584, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1652.247
[2022-12-01 18:02:55.361820] Finished iteration 585, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1669.366
[2022-12-01 18:02:57.036634] Finished iteration 586, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1674.771
[2022-12-01 18:02:58.789060] Finished iteration 587, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1752.403
[2022-12-01 18:03:00.478864] Finished iteration 588, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1689.722
[2022-12-01 18:03:02.167104] Finished iteration 589, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1688.196
[2022-12-01 18:01:12.963461] Epoch: [0][590/142]	Time  1.641 ( 1.890)	Data  0.002 ( 0.108)	Loss 4.6154e+00 (4.6121e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:03:03.808813] Finished iteration 590, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1641.670
[2022-12-01 18:03:05.521799] Finished iteration 591, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1712.964
[2022-12-01 18:03:07.197209] Finished iteration 592, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1675.416
[2022-12-01 18:03:08.803223] Finished iteration 593, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1605.929
[2022-12-01 18:03:10.451653] Finished iteration 594, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1648.382
[2022-12-01 18:03:12.161632] Finished iteration 595, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1709.941
[2022-12-01 18:03:13.831513] Finished iteration 596, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1669.842
[2022-12-01 18:03:15.377213] Finished iteration 597, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1545.717
[2022-12-01 18:03:17.057654] Finished iteration 598, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1680.349
[2022-12-01 18:03:18.823309] Finished iteration 599, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1765.616
[2022-12-01 18:01:12.963461] Epoch: [0][600/142]	Time  1.742 ( 1.857)	Data  0.003 ( 0.092)	Loss 4.6129e+00 (4.6118e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:03:20.565210] Finished iteration 600, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1741.923
[2022-12-01 18:03:22.205794] Finished iteration 601, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1640.521
[2022-12-01 18:03:23.719320] Finished iteration 602, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.489
[2022-12-01 18:03:25.319318] Finished iteration 603, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1599.938
[2022-12-01 18:03:27.017434] Finished iteration 604, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1698.077
[2022-12-01 18:03:28.588535] Finished iteration 605, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1571.060
[2022-12-01 18:03:30.149779] Finished iteration 606, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1561.205
[2022-12-01 18:03:31.715743] Finished iteration 607, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1565.922
[2022-12-01 18:03:33.337551] Finished iteration 608, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1621.774
[2022-12-01 18:03:35.054101] Finished iteration 609, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1716.519
[2022-12-01 18:01:12.963461] Epoch: [0][610/142]	Time  1.595 ( 1.825)	Data  0.002 ( 0.081)	Loss 4.6012e+00 (4.6114e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:03:36.649391] Finished iteration 610, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1595.245
[2022-12-01 18:03:38.368027] Finished iteration 611, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1718.611
[2022-12-01 18:03:40.068925] Finished iteration 612, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1700.845
[2022-12-01 18:03:41.757434] Finished iteration 613, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1688.472
[2022-12-01 18:03:43.351648] Finished iteration 614, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1594.175
[2022-12-01 18:03:44.957123] Finished iteration 615, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1605.503
[2022-12-01 18:03:46.632893] Finished iteration 616, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1675.678
[2022-12-01 18:03:48.233222] Finished iteration 617, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1600.318
[2022-12-01 18:03:49.799747] Finished iteration 618, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1566.477
[2022-12-01 18:03:51.525434] Finished iteration 619, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1725.626
[2022-12-01 18:01:12.963461] Epoch: [0][620/142]	Time  1.735 ( 1.806)	Data  0.003 ( 0.072)	Loss 4.6097e+00 (4.6112e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:03:53.260561] Finished iteration 620, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1735.085
[2022-12-01 18:03:54.996963] Finished iteration 621, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1736.382
[2022-12-01 18:03:56.555351] Finished iteration 622, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1558.354
[2022-12-01 18:03:58.252115] Finished iteration 623, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1696.717
[2022-12-01 18:03:59.908897] Finished iteration 624, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1656.746
[2022-12-01 18:04:01.593449] Finished iteration 625, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1684.515
[2022-12-01 18:04:03.259153] Finished iteration 626, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1665.674
[2022-12-01 18:04:04.928437] Finished iteration 627, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1669.227
[2022-12-01 18:04:06.614925] Finished iteration 628, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1686.448
[2022-12-01 18:04:08.272162] Finished iteration 629, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1657.201
[2022-12-01 18:01:12.963461] Epoch: [0][630/142]	Time  1.589 ( 1.791)	Data  0.002 ( 0.064)	Loss 4.6122e+00 (4.6110e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:04:09.862102] Finished iteration 630, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1589.896
[2022-12-01 18:04:11.563848] Finished iteration 631, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1701.724
[2022-12-01 18:04:13.241092] Finished iteration 632, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1677.203
[2022-12-01 18:04:14.869591] Finished iteration 633, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1628.440
[2022-12-01 18:04:16.427602] Finished iteration 634, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1557.962
[2022-12-01 18:04:18.126951] Finished iteration 635, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1699.298
[2022-12-01 18:04:19.801586] Finished iteration 636, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1674.595
[2022-12-01 18:04:21.426652] Finished iteration 637, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1625.036
[2022-12-01 18:04:22.980692] Finished iteration 638, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1553.994
[2022-12-01 18:04:24.703738] Finished iteration 639, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1723.013
[2022-12-01 18:01:12.963461] Epoch: [0][640/142]	Time  1.664 ( 1.777)	Data  0.002 ( 0.059)	Loss 4.6044e+00 (4.6109e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:04:26.367941] Finished iteration 640, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1664.150
[2022-12-01 18:04:27.996421] Finished iteration 641, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1628.460
[2022-12-01 18:04:29.632592] Finished iteration 642, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1636.118
[2022-12-01 18:04:31.334525] Finished iteration 643, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1701.916
[2022-12-01 18:04:33.038348] Finished iteration 644, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1703.798
[2022-12-01 18:04:34.831296] Finished iteration 645, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1792.892
[2022-12-01 18:04:36.495871] Finished iteration 646, CKPT_AND_STOP: False, flag: tensor([3], dtype=torch.int32), speed: 1664.551
Opt ckpt time 3.29364275932312
Signal handler called with signal 10


 STOPPING VARUNA !!



Process done with return code 0
Parent process ID: 127914 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 469314.3005371094 0
End of simulation:  Mini-batch time (usec) = 1031482
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31455, max long fwd 34870; min long bwd 76739, max long bwd 82859
Time taken by simulation: 51 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 10 0 14465.604782104492 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2417640
Min send: 10000000, max send 0
Min long send: 541659, max long send 557502
Min fwd: 17296, max fwd 25575; min bwd 47081, max bwd 56289
Min long fwd: 10095, max long fwd 15512; min long bwd 26495, max long bwd 30607
Time taken by simulation: 194 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 16 0 5187.531471252441 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8666579
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 8673, max fwd 19564; min bwd 21579, max bwd 41244
Min long fwd: 1397, max long fwd 8270; min long bwd 12229, max long bwd 19649
Time taken by simulation: 505 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 979 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2344 microseconds

{1: 1.031482, 2: 2.41764, 3: 8.666579, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.41764
7 per stage
14 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 7
stage to rank map: 0,2,4,6,8,10,12;1,3,5,7,9,11,13;
World size is 14
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12;1,3,5,7,9,11,13; --batch-size=288 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 646
[2022-12-01 18:04:52.039176] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.9451148509979248
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
9 chunks
>>>>> [2022-12-01 18:05:13.367298] Time taken to load checkpoint: 14.785s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:05:22.805553] Finished iteration 647, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8847.009
[2022-12-01 18:05:25.330744] Finished iteration 648, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2525.022
[2022-12-01 18:05:27.804389] Finished iteration 649, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2473.607
[2022-12-01 18:05:13.367502] Epoch: [0][650/173]	Time  2.459 ( 3.818)	Data  1.033 ( 0.896)	Loss 4.6098e+00 (4.6084e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:05:29.234370] Finished iteration 650, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1429.871
[2022-12-01 18:05:31.685274] Finished iteration 651, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2450.990
[2022-12-01 18:05:33.096817] Finished iteration 652, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1411.394
[2022-12-01 18:05:34.546108] Finished iteration 653, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1449.256
[2022-12-01 18:05:35.944322] Finished iteration 654, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1398.187
[2022-12-01 18:05:37.328610] Finished iteration 655, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.246
[2022-12-01 18:05:38.706638] Finished iteration 656, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1378.008
[2022-12-01 18:05:40.094214] Finished iteration 657, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1387.504
[2022-12-01 18:05:41.545773] Finished iteration 658, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1451.526
[2022-12-01 18:05:42.948789] Finished iteration 659, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1402.997
[2022-12-01 18:05:13.367502] Epoch: [0][660/173]	Time  1.365 ( 2.168)	Data  0.004 ( 0.333)	Loss 4.6085e+00 (4.6084e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:05:44.318044] Finished iteration 660, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1369.188
[2022-12-01 18:05:45.674161] Finished iteration 661, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1356.094
[2022-12-01 18:05:47.101347] Finished iteration 662, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1427.147
[2022-12-01 18:05:48.500630] Finished iteration 663, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1399.265
[2022-12-01 18:05:49.954047] Finished iteration 664, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.359
[2022-12-01 18:05:51.358497] Finished iteration 665, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1404.447
[2022-12-01 18:05:52.798979] Finished iteration 666, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1440.413
[2022-12-01 18:05:54.207975] Finished iteration 667, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1408.971
[2022-12-01 18:05:55.658622] Finished iteration 668, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1450.597
[2022-12-01 18:05:57.141143] Finished iteration 669, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1482.533
[2022-12-01 18:05:13.367502] Epoch: [0][670/173]	Time  1.403 ( 1.858)	Data  0.006 ( 0.196)	Loss 4.6141e+00 (4.6105e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:05:58.546238] Finished iteration 670, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1405.013
[2022-12-01 18:05:59.966520] Finished iteration 671, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1420.245
[2022-12-01 18:06:01.358054] Finished iteration 672, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1391.520
[2022-12-01 18:06:02.793825] Finished iteration 673, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1435.711
[2022-12-01 18:06:04.193936] Finished iteration 674, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1400.073
[2022-12-01 18:06:05.638486] Finished iteration 675, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1444.540
[2022-12-01 18:06:07.008741] Finished iteration 676, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1370.203
[2022-12-01 18:06:08.424780] Finished iteration 677, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1416.008
[2022-12-01 18:06:09.836213] Finished iteration 678, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1411.399
[2022-12-01 18:06:11.268655] Finished iteration 679, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1432.428
[2022-12-01 18:05:13.367502] Epoch: [0][680/173]	Time  1.370 ( 1.726)	Data  0.005 ( 0.140)	Loss 4.6202e+00 (4.6119e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:06:12.641014] Finished iteration 680, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1372.275
[2022-12-01 18:06:14.036355] Finished iteration 681, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1395.314
[2022-12-01 18:06:15.478760] Finished iteration 682, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1442.372
[2022-12-01 18:06:16.891251] Finished iteration 683, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1412.477
[2022-12-01 18:06:18.297735] Finished iteration 684, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1406.426
[2022-12-01 18:06:19.702594] Finished iteration 685, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1404.821
[2022-12-01 18:06:21.107936] Finished iteration 686, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1405.308
[2022-12-01 18:06:22.543673] Finished iteration 687, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1435.694
[2022-12-01 18:06:23.927944] Finished iteration 688, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.252
[2022-12-01 18:06:25.351035] Finished iteration 689, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1423.051
[2022-12-01 18:05:13.367502] Epoch: [0][690/173]	Time  1.345 ( 1.653)	Data  0.003 ( 0.109)	Loss 4.6133e+00 (4.6113e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:06:26.703634] Finished iteration 690, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1352.549
[2022-12-01 18:06:28.120055] Finished iteration 691, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1416.404
[2022-12-01 18:06:29.488048] Finished iteration 692, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1367.967
[2022-12-01 18:06:30.930644] Finished iteration 693, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1442.542
[2022-12-01 18:06:32.363334] Finished iteration 694, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1432.648
[2022-12-01 18:06:33.765153] Finished iteration 695, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1401.818
[2022-12-01 18:06:35.152940] Finished iteration 696, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1387.706
Opt ckpt time 1.9788331985473633
Process done with return code 0
Parent process ID: 128619 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1000717.0997800314 0
End of simulation:  Mini-batch time (usec) = 1454691
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 42 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12826.751708984375 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009897
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 161 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 351 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 719 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1645 microseconds

{1: 1.454691, 2: 2.009897, 3: 6.713432, 4: 10.570352, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009897
9 per stage
18 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 9
stage to rank map: 0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17;
World size is 18
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 696
[2022-12-01 18:06:52.791431] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.9590814113616943
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
7 chunks
>>>>> [2022-12-01 18:07:15.295741] Time taken to load checkpoint: 15.959s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:07:27.314841] Finished iteration 697, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9621.696
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 18:07:29.640730] Finished iteration 698, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2325.624
[2022-12-01 18:07:31.042384] Finished iteration 699, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1401.566
[2022-12-01 18:07:15.295960] Epoch: [0][700/223]	Time  1.414 ( 3.689)	Data  0.005 ( 0.794)	Loss 4.6110e+00 (4.6119e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:07:33.481851] Finished iteration 700, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2439.507
[2022-12-01 18:07:35.860100] Finished iteration 701, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2378.194
[2022-12-01 18:07:37.244219] Finished iteration 702, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.045
[2022-12-01 18:07:38.600240] Finished iteration 703, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1355.959
[2022-12-01 18:07:39.996776] Finished iteration 704, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.504
[2022-12-01 18:07:41.402920] Finished iteration 705, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1406.125
[2022-12-01 18:07:42.778443] Finished iteration 706, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1375.493
[2022-12-01 18:07:44.163958] Finished iteration 707, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1385.476
[2022-12-01 18:07:45.689541] Finished iteration 708, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1525.559
[2022-12-01 18:07:47.485376] Finished iteration 709, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1795.797
[2022-12-01 18:07:15.295960] Epoch: [0][710/223]	Time  1.391 ( 2.227)	Data  0.007 ( 0.378)	Loss 4.6032e+00 (4.6101e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:07:48.872922] Finished iteration 710, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1387.491
[2022-12-01 18:07:50.275625] Finished iteration 711, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1402.664
[2022-12-01 18:07:51.684005] Finished iteration 712, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1408.333
[2022-12-01 18:07:53.094645] Finished iteration 713, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1410.601
[2022-12-01 18:07:54.505256] Finished iteration 714, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1410.616
[2022-12-01 18:07:55.863463] Finished iteration 715, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1358.129
[2022-12-01 18:07:57.284114] Finished iteration 716, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1420.616
[2022-12-01 18:07:58.635420] Finished iteration 717, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1351.270
[2022-12-01 18:08:00.019387] Finished iteration 718, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1383.933
[2022-12-01 18:08:01.458328] Finished iteration 719, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1438.921
[2022-12-01 18:07:15.295960] Epoch: [0][720/223]	Time  1.450 ( 1.884)	Data  0.004 ( 0.223)	Loss 4.6105e+00 (4.6099e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:08:02.908687] Finished iteration 720, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1450.298
[2022-12-01 18:08:04.298177] Finished iteration 721, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1389.469
[2022-12-01 18:08:05.689103] Finished iteration 722, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1390.891
[2022-12-01 18:08:07.130066] Finished iteration 723, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1440.918
[2022-12-01 18:08:08.647744] Finished iteration 724, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1517.610
[2022-12-01 18:08:10.060682] Finished iteration 725, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1412.940
[2022-12-01 18:08:11.478357] Finished iteration 726, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1417.628
[2022-12-01 18:08:12.894054] Finished iteration 727, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1415.633
[2022-12-01 18:08:14.305952] Finished iteration 728, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1411.854
[2022-12-01 18:08:15.755749] Finished iteration 729, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1449.759
[2022-12-01 18:07:15.295960] Epoch: [0][730/223]	Time  1.472 ( 1.751)	Data  0.005 ( 0.159)	Loss 4.6144e+00 (4.6107e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:08:17.226977] Finished iteration 730, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1471.213
[2022-12-01 18:08:18.619831] Finished iteration 731, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1392.844
[2022-12-01 18:08:20.002277] Finished iteration 732, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1382.393
[2022-12-01 18:08:21.430461] Finished iteration 733, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1428.130
[2022-12-01 18:08:22.816440] Finished iteration 734, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1385.941
[2022-12-01 18:08:24.197372] Finished iteration 735, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1380.893
[2022-12-01 18:08:25.628025] Finished iteration 736, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1430.666
[2022-12-01 18:08:27.000181] Finished iteration 737, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1372.139
[2022-12-01 18:08:28.397167] Finished iteration 738, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.915
[2022-12-01 18:08:29.781387] Finished iteration 739, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.344
[2022-12-01 18:07:15.295960] Epoch: [0][740/223]	Time  1.329 ( 1.668)	Data  0.006 ( 0.124)	Loss 4.6083e+00 (4.6107e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:08:31.110550] Finished iteration 740, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1328.925
[2022-12-01 18:08:32.491446] Finished iteration 741, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1380.877
[2022-12-01 18:08:33.917044] Finished iteration 742, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1425.557
[2022-12-01 18:08:35.376622] Finished iteration 743, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.546
[2022-12-01 18:08:36.767427] Finished iteration 744, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1390.829
[2022-12-01 18:08:38.157537] Finished iteration 745, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1390.010
[2022-12-01 18:08:39.553853] Finished iteration 746, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.312
[2022-12-01 18:08:40.967465] Finished iteration 747, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1413.542
[2022-12-01 18:08:42.337053] Finished iteration 748, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1369.544
[2022-12-01 18:08:43.747820] Finished iteration 749, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1410.735
[2022-12-01 18:07:15.295960] Epoch: [0][750/223]	Time  1.367 ( 1.619)	Data  0.004 ( 0.102)	Loss 4.6110e+00 (4.6103e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:08:45.114435] Finished iteration 750, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1366.578
[2022-12-01 18:08:46.491162] Finished iteration 751, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1376.728
[2022-12-01 18:08:47.855921] Finished iteration 752, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1364.721
[2022-12-01 18:08:49.233157] Finished iteration 753, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1377.228
[2022-12-01 18:08:50.686825] Finished iteration 754, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.581
[2022-12-01 18:08:52.103907] Finished iteration 755, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1417.041
[2022-12-01 18:08:53.501396] Finished iteration 756, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1397.463
[2022-12-01 18:08:54.885568] Finished iteration 757, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1384.131
[2022-12-01 18:08:56.256336] Finished iteration 758, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1370.762
[2022-12-01 18:08:57.636057] Finished iteration 759, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1379.654
[2022-12-01 18:07:15.295960] Epoch: [0][760/223]	Time  1.395 ( 1.583)	Data  0.006 ( 0.087)	Loss 4.6055e+00 (4.6100e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:08:59.031048] Finished iteration 760, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1395.074
[2022-12-01 18:09:00.413640] Finished iteration 761, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1382.481
[2022-12-01 18:09:01.813258] Finished iteration 762, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1399.577
[2022-12-01 18:09:03.232910] Finished iteration 763, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1419.668
[2022-12-01 18:09:04.668486] Finished iteration 764, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1435.461
[2022-12-01 18:09:06.112689] Finished iteration 765, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1444.198
[2022-12-01 18:09:07.471547] Finished iteration 766, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1358.776
[2022-12-01 18:09:08.924182] Finished iteration 767, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1452.601
[2022-12-01 18:09:10.339076] Finished iteration 768, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1414.879
[2022-12-01 18:09:11.763125] Finished iteration 769, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1424.081
[2022-12-01 18:07:15.295960] Epoch: [0][770/223]	Time  1.406 ( 1.560)	Data  0.006 ( 0.076)	Loss 4.6217e+00 (4.6098e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:09:13.168904] Finished iteration 770, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1405.640
[2022-12-01 18:09:14.563342] Finished iteration 771, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1394.415
[2022-12-01 18:09:15.917468] Finished iteration 772, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1354.091
[2022-12-01 18:09:17.302974] Finished iteration 773, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1385.517
[2022-12-01 18:09:18.636601] Finished iteration 774, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1333.570
[2022-12-01 18:09:19.993033] Finished iteration 775, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1356.389
[2022-12-01 18:09:21.346092] Finished iteration 776, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1353.032
[2022-12-01 18:09:22.752796] Finished iteration 777, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1406.631
[2022-12-01 18:09:24.212571] Finished iteration 778, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.739
[2022-12-01 18:09:25.568409] Finished iteration 779, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1355.803
[2022-12-01 18:07:15.295960] Epoch: [0][780/223]	Time  1.454 ( 1.540)	Data  0.007 ( 0.068)	Loss 4.6088e+00 (4.6096e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:09:27.020439] Finished iteration 780, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1452.041
[2022-12-01 18:09:28.439807] Finished iteration 781, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1419.390
[2022-12-01 18:09:29.865070] Finished iteration 782, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1425.164
[2022-12-01 18:09:31.223774] Finished iteration 783, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1358.598
[2022-12-01 18:09:32.604055] Finished iteration 784, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1380.243
[2022-12-01 18:09:34.000916] Finished iteration 785, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.848
[2022-12-01 18:09:35.406337] Finished iteration 786, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1405.377
Opt ckpt time 1.5821399688720703
Process done with return code 0
Parent process ID: 129444 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1019436.4886319825 0
End of simulation:  Mini-batch time (usec) = 1473410
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 47 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12826.751708984375 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009897
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 165 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 355 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 714 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1669 microseconds

{1: 1.47341, 2: 2.009897, 3: 6.713432, 4: 10.570352, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009897
9 per stage
18 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 9
stage to rank map: 0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17;
World size is 18
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 786
[2022-12-01 18:09:55.504447] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.9516482353210449
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
7 chunks
>>>>> [2022-12-01 18:10:27.429097] Time taken to load checkpoint: 25.322s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:10:43.234193] Finished iteration 787, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9651.026
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 18:10:45.589404] Finished iteration 788, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2355.007
[2022-12-01 18:10:47.955993] Finished iteration 789, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2366.526
[2022-12-01 18:10:27.429359] Epoch: [0][790/223]	Time  2.361 ( 3.927)	Data  1.026 ( 0.598)	Loss 4.6055e+00 (4.6094e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:10:50.323201] Finished iteration 790, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2367.174
[2022-12-01 18:10:52.713844] Finished iteration 791, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2390.558
[2022-12-01 18:10:54.036511] Finished iteration 792, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1322.621
[2022-12-01 18:10:55.315306] Finished iteration 793, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1278.772
[2022-12-01 18:10:56.659455] Finished iteration 794, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1344.097
[2022-12-01 18:10:58.030606] Finished iteration 795, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1371.118
[2022-12-01 18:10:59.303960] Finished iteration 796, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1273.323
[2022-12-01 18:11:00.638628] Finished iteration 797, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1334.618
[2022-12-01 18:11:01.950369] Finished iteration 798, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1311.798
[2022-12-01 18:11:03.260012] Finished iteration 799, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1309.503
[2022-12-01 18:10:27.429359] Epoch: [0][800/223]	Time  1.325 ( 2.214)	Data  0.005 ( 0.320)	Loss 4.6099e+00 (4.6083e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:11:04.583479] Finished iteration 800, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1323.417
[2022-12-01 18:11:05.899616] Finished iteration 801, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1316.111
[2022-12-01 18:11:07.170118] Finished iteration 802, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1270.463
[2022-12-01 18:11:08.481699] Finished iteration 803, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1311.565
[2022-12-01 18:11:09.784058] Finished iteration 804, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1302.292
[2022-12-01 18:11:11.075109] Finished iteration 805, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1291.009
[2022-12-01 18:11:12.376599] Finished iteration 806, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1301.449
[2022-12-01 18:11:13.689629] Finished iteration 807, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1312.997
[2022-12-01 18:11:15.063263] Finished iteration 808, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1373.609
[2022-12-01 18:11:16.337158] Finished iteration 809, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1273.897
[2022-12-01 18:10:27.429359] Epoch: [0][810/223]	Time  1.374 ( 1.839)	Data  0.004 ( 0.189)	Loss 4.6066e+00 (4.6077e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:11:17.711572] Finished iteration 810, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1374.317
[2022-12-01 18:11:19.067919] Finished iteration 811, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1356.325
[2022-12-01 18:11:20.363039] Finished iteration 812, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1295.085
[2022-12-01 18:11:21.711091] Finished iteration 813, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1348.022
[2022-12-01 18:11:23.016990] Finished iteration 814, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1305.856
[2022-12-01 18:11:24.373017] Finished iteration 815, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1355.964
[2022-12-01 18:11:25.761906] Finished iteration 816, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1388.844
[2022-12-01 18:11:27.099142] Finished iteration 817, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1337.209
[2022-12-01 18:11:28.439903] Finished iteration 818, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1340.710
[2022-12-01 18:11:29.721872] Finished iteration 819, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1281.960
[2022-12-01 18:10:27.429359] Epoch: [0][820/223]	Time  1.340 ( 1.690)	Data  0.004 ( 0.135)	Loss 4.6032e+00 (4.6077e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:11:31.066155] Finished iteration 820, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1344.209
[2022-12-01 18:11:32.393155] Finished iteration 821, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1327.029
[2022-12-01 18:11:33.720128] Finished iteration 822, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1326.890
[2022-12-01 18:11:35.027214] Finished iteration 823, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1307.046
[2022-12-01 18:11:36.318734] Finished iteration 824, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1291.470
[2022-12-01 18:11:37.681798] Finished iteration 825, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1363.030
[2022-12-01 18:11:39.008512] Finished iteration 826, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1326.684
[2022-12-01 18:11:40.299652] Finished iteration 827, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1291.082
[2022-12-01 18:11:41.659019] Finished iteration 828, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1359.335
[2022-12-01 18:11:43.010076] Finished iteration 829, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1351.015
[2022-12-01 18:10:27.429359] Epoch: [0][830/223]	Time  1.301 ( 1.607)	Data  0.007 ( 0.106)	Loss 4.6127e+00 (4.6077e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:11:44.311364] Finished iteration 830, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1301.240
[2022-12-01 18:11:45.614712] Finished iteration 831, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1303.323
[2022-12-01 18:11:46.967257] Finished iteration 832, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1352.513
[2022-12-01 18:11:48.311378] Finished iteration 833, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1344.093
[2022-12-01 18:11:49.593017] Finished iteration 834, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1281.595
[2022-12-01 18:11:50.887558] Finished iteration 835, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.490
[2022-12-01 18:11:52.174658] Finished iteration 836, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1287.056
[2022-12-01 18:11:53.441368] Finished iteration 837, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1266.675
[2022-12-01 18:11:54.819384] Finished iteration 838, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1377.989
[2022-12-01 18:11:56.114242] Finished iteration 839, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.862
[2022-12-01 18:10:27.429359] Epoch: [0][840/223]	Time  1.373 ( 1.554)	Data  0.003 ( 0.087)	Loss 4.6088e+00 (4.6078e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:11:57.488645] Finished iteration 840, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1374.293
[2022-12-01 18:11:58.829557] Finished iteration 841, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1340.889
[2022-12-01 18:12:00.111706] Finished iteration 842, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1282.112
[2022-12-01 18:12:01.437828] Finished iteration 843, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1326.098
[2022-12-01 18:12:02.751493] Finished iteration 844, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1313.721
[2022-12-01 18:12:04.046495] Finished iteration 845, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.910
[2022-12-01 18:12:05.351801] Finished iteration 846, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1305.218
Opt ckpt time 1.6864409446716309
Process done with return code 0
Parent process ID: 121179 node: 172.31.17.209
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 959937.744140625 0
End of simulation:  Mini-batch time (usec) = 1413911
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 47 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009207
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 171 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 13 0 5941.788673400879 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7626781
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 21579, max bwd 43006
Min long fwd: 1397, max long fwd 9139; min long bwd 11398, max long bwd 19649
Time taken by simulation: 429 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 723 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2309 microseconds

{1: 1.413911, 2: 2.009207, 3: 7.626781, 4: 10.570352, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009207
8 per stage
16 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 8
stage to rank map: 0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15; --batch-size=256 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 846
[2022-12-01 18:12:56.049233] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.9363703727722168
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
8 chunks
>>>>> [2022-12-01 18:13:28.546455] Time taken to load checkpoint: 25.901s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:13:42.707121] Finished iteration 847, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9886.176
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 18:13:45.257865] Finished iteration 848, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2550.573
[2022-12-01 18:13:47.720328] Finished iteration 849, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2462.363
[2022-12-01 18:13:28.546705] Epoch: [0][850/195]	Time  2.519 ( 4.097)	Data  1.032 ( 1.166)	Loss 4.6060e+00 (4.6082e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:13:50.236894] Finished iteration 850, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2516.531
[2022-12-01 18:13:52.679983] Finished iteration 851, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2443.032
[2022-12-01 18:13:54.204572] Finished iteration 852, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1524.493
[2022-12-01 18:13:55.694615] Finished iteration 853, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1490.011
[2022-12-01 18:13:57.266884] Finished iteration 854, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1572.213
[2022-12-01 18:13:58.705289] Finished iteration 855, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1438.390
[2022-12-01 18:14:00.153536] Finished iteration 856, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1448.202
[2022-12-01 18:14:01.674006] Finished iteration 857, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.453
[2022-12-01 18:14:03.203258] Finished iteration 858, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1529.196
[2022-12-01 18:14:04.694215] Finished iteration 859, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1490.915
[2022-12-01 18:13:28.546705] Epoch: [0][860/195]	Time  1.412 ( 2.377)	Data  0.003 ( 0.483)	Loss 4.6143e+00 (4.6099e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:14:06.110243] Finished iteration 860, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1415.990
Opt ckpt time 2.2523534297943115
Process done with return code 0
Parent process ID: 97190 node: 172.31.24.82
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 469314.3005371094 0
End of simulation:  Mini-batch time (usec) = 1031482
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31455, max long fwd 34870; min long bwd 76739, max long bwd 82859
Time taken by simulation: 47 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 10 0 14465.604782104492 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2417640
Min send: 10000000, max send 0
Min long send: 541659, max long send 557502
Min fwd: 17296, max fwd 25575; min bwd 47081, max bwd 56289
Min long fwd: 10095, max long fwd 15512; min long bwd 26495, max long bwd 30607
Time taken by simulation: 193 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 13 0 5941.788673400879 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7626781
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 21579, max bwd 43006
Min long fwd: 1397, max long fwd 9139; min long bwd 11398, max long bwd 19649
Time taken by simulation: 424 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 983 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2406 microseconds

{1: 1.031482, 2: 2.41764, 3: 7.626781, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.41764
7 per stage
14 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 7
stage to rank map: 0,2,4,6,8,10,12;1,3,5,7,9,11,13;
World size is 14
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12;1,3,5,7,9,11,13; --batch-size=288 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 860
[2022-12-01 18:14:54.082296] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 1.4079575538635254
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
9 chunks
>>>>> [2022-12-01 18:15:25.350323] Time taken to load checkpoint: 24.361s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:15:34.847717] Finished iteration 861, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9099.459
[2022-12-01 18:15:37.437388] Finished iteration 862, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2589.440
[2022-12-01 18:15:40.068856] Finished iteration 863, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2631.480
[2022-12-01 18:15:42.686798] Finished iteration 864, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2617.883
[2022-12-01 18:15:44.264746] Finished iteration 865, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1577.884
[2022-12-01 18:15:45.848588] Finished iteration 866, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.845
[2022-12-01 18:15:47.378377] Finished iteration 867, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1529.721
[2022-12-01 18:15:48.915248] Finished iteration 868, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1536.851
[2022-12-01 18:15:50.485186] Finished iteration 869, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1569.910
[2022-12-01 18:15:25.350571] Epoch: [0][870/173]	Time  1.481 ( 2.621)	Data  0.007 ( 0.459)	Loss 4.6141e+00 (4.6121e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:15:51.963704] Finished iteration 870, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1478.468
[2022-12-01 18:15:53.482395] Finished iteration 871, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1518.698
[2022-12-01 18:15:55.064475] Finished iteration 872, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1582.052
[2022-12-01 18:15:56.589795] Finished iteration 873, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1525.280
[2022-12-01 18:15:58.151739] Finished iteration 874, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1561.905
[2022-12-01 18:15:59.685453] Finished iteration 875, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1533.681
[2022-12-01 18:16:01.178829] Finished iteration 876, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1493.311
[2022-12-01 18:16:02.714825] Finished iteration 877, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1535.963
[2022-12-01 18:16:04.264173] Finished iteration 878, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1549.324
[2022-12-01 18:16:05.819607] Finished iteration 879, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1555.394
[2022-12-01 18:15:25.350571] Epoch: [0][880/173]	Time  1.547 ( 2.081)	Data  0.004 ( 0.232)	Loss 4.6124e+00 (4.6104e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:16:07.372468] Finished iteration 880, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1552.834
[2022-12-01 18:16:08.804228] Finished iteration 881, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1431.725
[2022-12-01 18:16:10.397416] Finished iteration 882, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1593.153
[2022-12-01 18:16:11.954236] Finished iteration 883, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1556.793
[2022-12-01 18:16:13.413643] Finished iteration 884, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.365
[2022-12-01 18:16:14.860463] Finished iteration 885, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1446.802
[2022-12-01 18:16:16.392869] Finished iteration 886, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1532.393
[2022-12-01 18:16:17.810665] Finished iteration 887, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1417.794
[2022-12-01 18:16:19.292549] Finished iteration 888, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1481.779
[2022-12-01 18:16:20.814752] Finished iteration 889, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1522.176
[2022-12-01 18:15:25.350571] Epoch: [0][890/173]	Time  1.571 ( 1.888)	Data  0.003 ( 0.156)	Loss 4.6042e+00 (4.6106e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:16:22.390860] Finished iteration 890, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1576.071
[2022-12-01 18:16:23.867628] Finished iteration 891, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1476.735
[2022-12-01 18:16:25.390185] Finished iteration 892, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1522.522
[2022-12-01 18:16:26.944587] Finished iteration 893, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1554.402
[2022-12-01 18:16:28.477093] Finished iteration 894, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1532.460
[2022-12-01 18:16:30.035888] Finished iteration 895, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1558.730
[2022-12-01 18:16:31.559627] Finished iteration 896, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1523.713
[2022-12-01 18:16:33.183685] Finished iteration 897, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1624.022
[2022-12-01 18:16:34.695541] Finished iteration 898, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1511.832
[2022-12-01 18:16:36.281662] Finished iteration 899, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1586.091
[2022-12-01 18:15:25.350571] Epoch: [0][900/173]	Time  1.610 ( 1.804)	Data  0.003 ( 0.119)	Loss 4.6011e+00 (4.6097e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:16:37.892824] Finished iteration 900, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1611.144
[2022-12-01 18:16:39.415719] Finished iteration 901, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1522.858
[2022-12-01 18:16:40.976200] Finished iteration 902, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1560.431
[2022-12-01 18:16:42.515739] Finished iteration 903, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1539.493
[2022-12-01 18:16:43.961486] Finished iteration 904, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1445.724
[2022-12-01 18:16:45.471036] Finished iteration 905, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1509.508
[2022-12-01 18:16:46.984429] Finished iteration 906, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.376
[2022-12-01 18:16:48.496102] Finished iteration 907, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1511.615
[2022-12-01 18:16:50.029329] Finished iteration 908, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1533.204
[2022-12-01 18:16:51.608548] Finished iteration 909, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1579.184
[2022-12-01 18:15:25.350571] Epoch: [0][910/173]	Time  1.536 ( 1.748)	Data  0.004 ( 0.096)	Loss 4.6124e+00 (4.6099e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:16:53.145088] Finished iteration 910, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1536.501
[2022-12-01 18:16:54.674838] Finished iteration 911, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1529.729
[2022-12-01 18:16:56.207295] Finished iteration 912, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1532.423
[2022-12-01 18:16:57.771758] Finished iteration 913, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1564.426
[2022-12-01 18:16:59.279596] Finished iteration 914, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1507.811
[2022-12-01 18:17:00.897665] Finished iteration 915, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1618.031
[2022-12-01 18:17:02.418531] Finished iteration 916, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.833
[2022-12-01 18:17:04.012358] Finished iteration 917, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1593.814
[2022-12-01 18:17:05.573377] Finished iteration 918, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1560.977
[2022-12-01 18:17:07.104382] Finished iteration 919, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1530.958
[2022-12-01 18:15:25.350571] Epoch: [0][920/173]	Time  1.529 ( 1.715)	Data  0.003 ( 0.081)	Loss 4.6159e+00 (4.6100e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:17:08.635508] Finished iteration 920, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1531.084
[2022-12-01 18:17:10.173325] Finished iteration 921, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1537.807
[2022-12-01 18:17:11.727898] Finished iteration 922, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1554.529
[2022-12-01 18:17:13.226785] Finished iteration 923, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1498.848
[2022-12-01 18:17:14.678650] Finished iteration 924, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1451.827
[2022-12-01 18:17:16.260444] Finished iteration 925, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1581.764
[2022-12-01 18:17:17.886654] Finished iteration 926, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1626.178
[2022-12-01 18:17:19.643296] Finished iteration 927, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1756.609
[2022-12-01 18:17:21.113706] Finished iteration 928, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.400
[2022-12-01 18:17:23.053034] Finished iteration 929, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1939.304
[2022-12-01 18:15:25.350571] Epoch: [0][930/173]	Time  1.470 ( 1.697)	Data  0.006 ( 0.070)	Loss 4.6033e+00 (4.6096e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:17:24.521315] Finished iteration 930, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1468.199
[2022-12-01 18:17:26.123890] Finished iteration 931, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1602.562
[2022-12-01 18:17:27.593679] Finished iteration 932, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1469.748
[2022-12-01 18:17:29.129432] Finished iteration 933, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1535.723
[2022-12-01 18:17:30.679237] Finished iteration 934, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1549.783
[2022-12-01 18:17:32.192759] Finished iteration 935, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.500
[2022-12-01 18:17:33.737452] Finished iteration 936, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1544.603
[2022-12-01 18:17:35.275833] Finished iteration 937, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1538.344
[2022-12-01 18:17:36.762536] Finished iteration 938, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1486.671
[2022-12-01 18:17:38.383202] Finished iteration 939, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1620.652
[2022-12-01 18:15:25.350571] Epoch: [0][940/173]	Time  1.537 ( 1.677)	Data  0.004 ( 0.062)	Loss 4.6124e+00 (4.6094e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:17:39.919517] Finished iteration 940, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1536.258
[2022-12-01 18:17:41.513206] Finished iteration 941, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1593.668
[2022-12-01 18:17:42.998486] Finished iteration 942, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1485.250
[2022-12-01 18:17:44.477428] Finished iteration 943, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1478.899
[2022-12-01 18:17:46.039578] Finished iteration 944, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1562.119
[2022-12-01 18:17:48.177936] Finished iteration 945, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2138.324
[2022-12-01 18:17:49.774152] Finished iteration 946, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1596.192
[2022-12-01 18:17:51.347677] Finished iteration 947, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1573.487
[2022-12-01 18:17:53.040072] Finished iteration 948, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1692.347
[2022-12-01 18:17:54.596726] Finished iteration 949, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1556.639
[2022-12-01 18:15:25.350571] Epoch: [0][950/173]	Time  1.515 ( 1.671)	Data  0.007 ( 0.055)	Loss 4.6159e+00 (4.6096e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:17:56.110886] Finished iteration 950, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1514.105
[2022-12-01 18:17:57.671186] Finished iteration 951, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1560.302
[2022-12-01 18:17:59.255870] Finished iteration 952, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1584.651
[2022-12-01 18:18:00.789864] Finished iteration 953, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1533.960
[2022-12-01 18:18:02.342069] Finished iteration 954, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1552.155
[2022-12-01 18:18:04.010229] Finished iteration 955, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1668.126
[2022-12-01 18:18:05.542574] Finished iteration 956, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1532.311
[2022-12-01 18:18:07.020215] Finished iteration 957, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.604
[2022-12-01 18:18:08.617073] Finished iteration 958, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1596.814
[2022-12-01 18:18:10.224154] Finished iteration 959, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1607.060
[2022-12-01 18:15:25.350571] Epoch: [0][960/173]	Time  1.502 ( 1.660)	Data  0.005 ( 0.050)	Loss 4.6168e+00 (4.6098e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:18:11.724005] Finished iteration 960, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1499.803
[2022-12-01 18:18:13.158822] Finished iteration 961, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1434.793
[2022-12-01 18:18:14.660042] Finished iteration 962, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1501.190
[2022-12-01 18:18:16.229477] Finished iteration 963, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1569.395
[2022-12-01 18:18:17.718517] Finished iteration 964, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1489.007
[2022-12-01 18:18:19.167805] Finished iteration 965, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1449.263
[2022-12-01 18:18:20.650980] Finished iteration 966, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1483.129
[2022-12-01 18:18:22.144848] Finished iteration 967, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1493.870
[2022-12-01 18:18:23.761243] Finished iteration 968, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1616.344
[2022-12-01 18:18:25.298593] Finished iteration 969, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1537.324
[2022-12-01 18:15:25.350571] Epoch: [0][970/173]	Time  1.563 ( 1.646)	Data  0.007 ( 0.046)	Loss 4.6115e+00 (4.6097e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:18:26.861774] Finished iteration 970, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1563.115
[2022-12-01 18:18:28.410916] Finished iteration 971, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1549.123
[2022-12-01 18:18:29.967834] Finished iteration 972, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1556.893
[2022-12-01 18:18:31.599463] Finished iteration 973, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1631.586
[2022-12-01 18:18:33.202579] Finished iteration 974, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1603.087
[2022-12-01 18:18:34.738289] Finished iteration 975, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1535.688
[2022-12-01 18:18:36.326129] Finished iteration 976, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1587.783
[2022-12-01 18:18:37.899576] Finished iteration 977, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1573.436
[2022-12-01 18:18:39.441435] Finished iteration 978, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1541.804
[2022-12-01 18:18:41.047654] Finished iteration 979, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1606.191
[2022-12-01 18:15:25.350571] Epoch: [0][980/173]	Time  1.575 ( 1.641)	Data  0.004 ( 0.043)	Loss 4.6050e+00 (4.6095e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:18:42.622422] Finished iteration 980, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1574.738
[2022-12-01 18:18:44.233876] Finished iteration 981, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1611.424
[2022-12-01 18:18:45.757148] Finished iteration 982, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1523.236
[2022-12-01 18:18:47.315026] Finished iteration 983, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1557.842
[2022-12-01 18:18:48.854836] Finished iteration 984, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1539.772
[2022-12-01 18:18:50.471830] Finished iteration 985, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1616.969
[2022-12-01 18:18:51.974179] Finished iteration 986, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1502.312
[2022-12-01 18:18:53.483889] Finished iteration 987, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1509.669
[2022-12-01 18:18:54.966473] Finished iteration 988, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1482.551
[2022-12-01 18:18:56.431039] Finished iteration 989, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1464.536
[2022-12-01 18:15:25.350571] Epoch: [0][990/173]	Time  1.477 ( 1.632)	Data  0.004 ( 0.040)	Loss 4.6133e+00 (4.6093e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:18:57.907593] Finished iteration 990, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1476.513
[2022-12-01 18:18:59.477205] Finished iteration 991, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1569.597
[2022-12-01 18:19:01.044312] Finished iteration 992, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1567.074
[2022-12-01 18:19:02.694317] Finished iteration 993, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1649.999
[2022-12-01 18:19:04.178734] Finished iteration 994, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1484.354
[2022-12-01 18:19:05.697592] Finished iteration 995, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1518.817
[2022-12-01 18:19:07.340076] Finished iteration 996, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1642.449
[2022-12-01 18:19:08.867263] Finished iteration 997, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1527.157
[2022-12-01 18:19:10.387372] Finished iteration 998, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.070
[2022-12-01 18:19:11.990353] Finished iteration 999, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1602.949
[2022-12-01 18:15:25.350571] Epoch: [0][1000/173]	Time  1.616 ( 1.628)	Data  0.003 ( 0.037)	Loss 4.6098e+00 (4.6093e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:19:13.606313] Finished iteration 1000, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1615.925
[2022-12-01 18:19:15.258534] Finished iteration 1001, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1652.206
[2022-12-01 18:19:16.779419] Finished iteration 1002, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.847
[2022-12-01 18:19:18.349030] Finished iteration 1003, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1569.574
[2022-12-01 18:19:20.316265] Finished iteration 1004, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1967.200
[2022-12-01 18:19:21.963414] Finished iteration 1005, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1647.115
[2022-12-01 18:19:23.460187] Finished iteration 1006, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1496.741
[2022-12-01 18:19:25.058206] Finished iteration 1007, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1597.982
[2022-12-01 18:19:26.659273] Finished iteration 1008, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1601.026
[2022-12-01 18:19:28.189925] Finished iteration 1009, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1530.619
[2022-12-01 18:15:25.350571] Epoch: [0][1010/173]	Time  1.469 ( 1.626)	Data  0.004 ( 0.035)	Loss 4.6115e+00 (4.6091e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:19:29.665242] Finished iteration 1010, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1475.279
[2022-12-01 18:19:31.124903] Finished iteration 1011, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.683
[2022-12-01 18:19:32.646203] Finished iteration 1012, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1521.230
[2022-12-01 18:19:34.158984] Finished iteration 1013, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1512.769
[2022-12-01 18:19:35.694157] Finished iteration 1014, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1535.114
[2022-12-01 18:19:37.278030] Finished iteration 1015, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.845
[2022-12-01 18:19:38.751221] Finished iteration 1016, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1473.187
[2022-12-01 18:19:40.243115] Finished iteration 1017, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1491.822
[2022-12-01 18:19:41.801720] Finished iteration 1018, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1558.596
[2022-12-01 18:19:43.271517] Finished iteration 1019, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1469.740
[2022-12-01 18:15:25.350571] Epoch: [0][1020/173]	Time  1.548 ( 1.619)	Data  0.004 ( 0.033)	Loss 4.6037e+00 (4.6090e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:19:44.823178] Finished iteration 1020, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1551.626
[2022-12-01 18:19:46.356180] Finished iteration 1021, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1532.979
[2022-12-01 18:19:47.869973] Finished iteration 1022, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.762
[2022-12-01 18:19:49.451496] Finished iteration 1023, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1581.507
[2022-12-01 18:19:51.071509] Finished iteration 1024, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1619.992
[2022-12-01 18:19:52.617226] Finished iteration 1025, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1545.655
[2022-12-01 18:19:53.987304] Finished iteration 1026, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1370.048
[2022-12-01 18:19:55.418660] Finished iteration 1027, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1431.318
[2022-12-01 18:19:56.927468] Finished iteration 1028, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1508.765
[2022-12-01 18:19:58.396058] Finished iteration 1029, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1468.565
[2022-12-01 18:15:25.350571] Epoch: [0][1030/173]	Time  1.487 ( 1.613)	Data  0.006 ( 0.032)	Loss 4.6089e+00 (4.6089e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:19:59.882694] Finished iteration 1030, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1486.598
[2022-12-01 18:20:01.306610] Finished iteration 1031, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1423.897
[2022-12-01 18:20:02.714265] Finished iteration 1032, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1407.626
[2022-12-01 18:20:04.162904] Finished iteration 1033, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1448.594
[2022-12-01 18:20:07.904250] Finished iteration 1034, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3645.831
[2022-12-01 18:20:09.443678] Finished iteration 1035, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1539.200
[2022-12-01 18:20:11.009924] Finished iteration 1036, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1566.221
[2022-12-01 18:20:12.471843] Finished iteration 1037, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1461.879
[2022-12-01 18:20:13.952166] Finished iteration 1038, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1480.308
[2022-12-01 18:20:15.499542] Finished iteration 1039, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1547.324
[2022-12-01 18:20:04.249063] Epoch: [1][1040/173]	Time  1.535 ( 1.825)	Data  0.003 ( 0.163)	Loss 4.6059e+00 (4.6085e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:20:17.035179] Finished iteration 1040, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1535.594
[2022-12-01 18:20:18.543723] Finished iteration 1041, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1508.519
[2022-12-01 18:20:20.063297] Finished iteration 1042, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1519.544
[2022-12-01 18:20:21.654133] Finished iteration 1043, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1590.809
[2022-12-01 18:20:23.253243] Finished iteration 1044, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1599.065
[2022-12-01 18:20:24.872613] Finished iteration 1045, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1619.337
[2022-12-01 18:20:26.455597] Finished iteration 1046, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1582.939
[2022-12-01 18:20:28.063289] Finished iteration 1047, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1607.668
[2022-12-01 18:20:29.590670] Finished iteration 1048, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1527.341
[2022-12-01 18:20:31.195251] Finished iteration 1049, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1604.551
[2022-12-01 18:20:04.249063] Epoch: [1][1050/173]	Time  1.483 ( 1.672)	Data  0.003 ( 0.070)	Loss 4.6020e+00 (4.6070e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:20:32.678737] Finished iteration 1050, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1483.443
[2022-12-01 18:20:34.239104] Finished iteration 1051, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1560.352
[2022-12-01 18:20:35.735034] Finished iteration 1052, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1495.911
[2022-12-01 18:20:37.435696] Finished iteration 1053, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1700.612
[2022-12-01 18:20:38.940254] Finished iteration 1054, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.525
[2022-12-01 18:20:40.412414] Finished iteration 1055, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1472.119
[2022-12-01 18:20:41.957765] Finished iteration 1056, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1545.326
[2022-12-01 18:20:43.549303] Finished iteration 1057, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1591.508
[2022-12-01 18:20:45.121113] Finished iteration 1058, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1571.784
[2022-12-01 18:20:46.651363] Finished iteration 1059, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1530.232
[2022-12-01 18:20:04.249063] Epoch: [1][1060/173]	Time  1.466 ( 1.624)	Data  0.003 ( 0.046)	Loss 4.6050e+00 (4.6078e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:20:48.120485] Finished iteration 1060, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1469.048
[2022-12-01 18:20:49.687295] Finished iteration 1061, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1566.794
[2022-12-01 18:20:51.219042] Finished iteration 1062, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1531.713
[2022-12-01 18:20:52.850993] Finished iteration 1063, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1631.915
[2022-12-01 18:20:54.463825] Finished iteration 1064, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1612.807
[2022-12-01 18:20:55.972114] Finished iteration 1065, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1508.243
[2022-12-01 18:20:57.530375] Finished iteration 1066, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1558.258
[2022-12-01 18:20:59.124408] Finished iteration 1067, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1594.000
[2022-12-01 18:21:00.650402] Finished iteration 1068, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1525.960
[2022-12-01 18:21:02.124084] Finished iteration 1069, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1473.621
[2022-12-01 18:20:04.249063] Epoch: [1][1070/173]	Time  1.645 ( 1.608)	Data  0.004 ( 0.035)	Loss 4.6098e+00 (4.6083e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:21:03.771133] Finished iteration 1070, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1647.012
[2022-12-01 18:21:05.355510] Finished iteration 1071, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1584.349
[2022-12-01 18:21:06.910452] Finished iteration 1072, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1554.904
[2022-12-01 18:21:08.501334] Finished iteration 1073, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1590.848
[2022-12-01 18:21:10.032266] Finished iteration 1074, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1530.897
[2022-12-01 18:21:11.659522] Finished iteration 1075, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1627.220
[2022-12-01 18:21:13.194168] Finished iteration 1076, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1534.638
[2022-12-01 18:21:14.664450] Finished iteration 1077, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.225
[2022-12-01 18:21:16.171716] Finished iteration 1078, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1507.231
[2022-12-01 18:21:17.759574] Finished iteration 1079, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1587.842
[2022-12-01 18:20:04.249063] Epoch: [1][1080/173]	Time  1.519 ( 1.596)	Data  0.003 ( 0.028)	Loss 4.6042e+00 (4.6084e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:21:19.278831] Finished iteration 1080, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1519.201
[2022-12-01 18:21:20.862742] Finished iteration 1081, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.895
[2022-12-01 18:21:22.438163] Finished iteration 1082, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1575.382
[2022-12-01 18:21:24.063630] Finished iteration 1083, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1625.439
[2022-12-01 18:21:25.542575] Finished iteration 1084, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1478.909
[2022-12-01 18:21:27.077578] Finished iteration 1085, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1534.970
[2022-12-01 18:21:28.981992] Finished iteration 1086, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1904.397
[2022-12-01 18:21:30.542828] Finished iteration 1087, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1560.801
[2022-12-01 18:21:32.085036] Finished iteration 1088, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1542.154
[2022-12-01 18:21:33.662218] Finished iteration 1089, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1577.181
[2022-12-01 18:20:04.249063] Epoch: [1][1090/173]	Time  1.451 ( 1.594)	Data  0.005 ( 0.024)	Loss 4.6063e+00 (4.6086e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:21:35.115836] Finished iteration 1090, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.544
[2022-12-01 18:21:36.624723] Finished iteration 1091, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1508.862
[2022-12-01 18:21:38.195577] Finished iteration 1092, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1570.851
[2022-12-01 18:21:39.708489] Finished iteration 1093, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1512.849
[2022-12-01 18:21:41.371181] Finished iteration 1094, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1662.661
[2022-12-01 18:21:42.861490] Finished iteration 1095, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1490.265
[2022-12-01 18:21:44.468783] Finished iteration 1096, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1607.259
[2022-12-01 18:21:45.853979] Finished iteration 1097, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1385.149
[2022-12-01 18:21:47.251155] Finished iteration 1098, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1397.129
[2022-12-01 18:21:48.894423] Finished iteration 1099, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1643.270
[2022-12-01 18:20:04.249063] Epoch: [1][1100/173]	Time  1.474 ( 1.584)	Data  0.004 ( 0.021)	Loss 4.6003e+00 (4.6085e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:21:50.369882] Finished iteration 1100, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1475.408
[2022-12-01 18:21:51.934579] Finished iteration 1101, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1564.658
[2022-12-01 18:21:53.501733] Finished iteration 1102, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1567.122
[2022-12-01 18:21:55.015181] Finished iteration 1103, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.428
[2022-12-01 18:21:56.563188] Finished iteration 1104, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1547.973
[2022-12-01 18:21:58.105940] Finished iteration 1105, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1542.706
[2022-12-01 18:21:59.689156] Finished iteration 1106, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.190
[2022-12-01 18:22:01.272067] Finished iteration 1107, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1582.864
[2022-12-01 18:22:02.849726] Finished iteration 1108, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1577.623
[2022-12-01 18:22:04.355208] Finished iteration 1109, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1505.451
[2022-12-01 18:20:04.249063] Epoch: [1][1110/173]	Time  1.582 ( 1.580)	Data  0.003 ( 0.019)	Loss 4.6063e+00 (4.6086e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:22:05.938364] Finished iteration 1110, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.144
[2022-12-01 18:22:07.437445] Finished iteration 1111, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1499.065
[2022-12-01 18:22:08.873611] Finished iteration 1112, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1436.105
[2022-12-01 18:22:10.349287] Finished iteration 1113, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1475.644
[2022-12-01 18:22:11.850444] Finished iteration 1114, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1501.149
[2022-12-01 18:22:13.390064] Finished iteration 1115, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1539.553
[2022-12-01 18:22:14.912871] Finished iteration 1116, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1522.809
[2022-12-01 18:22:16.417973] Finished iteration 1117, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1505.043
[2022-12-01 18:22:18.008965] Finished iteration 1118, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1590.977
[2022-12-01 18:22:19.460501] Finished iteration 1119, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1451.477
[2022-12-01 18:20:04.249063] Epoch: [1][1120/173]	Time  1.531 ( 1.572)	Data  0.004 ( 0.018)	Loss 4.5990e+00 (4.6084e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:22:20.990890] Finished iteration 1120, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1530.350
[2022-12-01 18:22:22.563091] Finished iteration 1121, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1572.188
[2022-12-01 18:22:24.217907] Finished iteration 1122, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1654.780
[2022-12-01 18:22:25.738297] Finished iteration 1123, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.352
[2022-12-01 18:22:27.197615] Finished iteration 1124, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.296
[2022-12-01 18:22:28.794568] Finished iteration 1125, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1596.916
[2022-12-01 18:22:30.297228] Finished iteration 1126, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1502.650
[2022-12-01 18:22:31.817506] Finished iteration 1127, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.222
[2022-12-01 18:22:33.326257] Finished iteration 1128, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1508.711
[2022-12-01 18:22:34.832660] Finished iteration 1129, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1506.378
[2022-12-01 18:20:04.249063] Epoch: [1][1130/173]	Time  1.552 ( 1.568)	Data  0.007 ( 0.016)	Loss 4.6176e+00 (4.6084e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:22:36.384882] Finished iteration 1130, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1552.229
Opt ckpt time 2.5177993774414062
Process done with return code 0
Parent process ID: 98441 node: 172.31.24.82
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 980927.4647721202 0
End of simulation:  Mini-batch time (usec) = 1434901
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 45 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009207
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 167 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 13 0 5941.788673400879 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7626781
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 21579, max bwd 43006
Min long fwd: 1397, max long fwd 9139; min long bwd 11398, max long bwd 19649
Time taken by simulation: 417 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 713 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2339 microseconds

{1: 1.434901, 2: 2.009207, 3: 7.626781, 4: 10.570352, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009207
8 per stage
16 servers!
Config:
ranks: range(9, 10)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 8
stage to rank map: 0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u main.py --rank=9 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15; --batch-size=256 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 1130
[2022-12-01 18:22:53.522379] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.974999189376831
SHARED WEIGHTS ARE
None
this rank  9 is part of pipeline replica  4
8 chunks
>>>>> [2022-12-01 18:23:16.811502] Time taken to load checkpoint: 16.773s
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 18:23:30.724170] Finished iteration 1131, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 10139.518
9 Overflow !!
9 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 18:23:33.541453] Finished iteration 1132, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2817.038
[2022-12-01 18:23:36.005336] Finished iteration 1133, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2463.876
[2022-12-01 18:23:38.495109] Finished iteration 1134, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2489.708
[2022-12-01 18:23:40.929874] Finished iteration 1135, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2434.710
[2022-12-01 18:23:42.417382] Finished iteration 1136, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1487.449
[2022-12-01 18:23:43.900321] Finished iteration 1137, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1482.901
[2022-12-01 18:23:45.351747] Finished iteration 1138, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1451.386
[2022-12-01 18:23:46.879994] Finished iteration 1139, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1528.215
[2022-12-01 18:23:16.811710] Epoch: [0][1140/195]	Time  1.570 ( 2.786)	Data  0.007 ( 0.644)	Loss 4.6104e+00 (4.6091e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:23:48.448399] Finished iteration 1140, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1568.369
[2022-12-01 18:23:49.898547] Finished iteration 1141, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1450.135
[2022-12-01 18:23:51.438647] Finished iteration 1142, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1540.095
[2022-12-01 18:23:53.003776] Finished iteration 1143, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1565.081
[2022-12-01 18:23:54.481603] Finished iteration 1144, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.787
[2022-12-01 18:23:55.889357] Finished iteration 1145, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1407.726
[2022-12-01 18:23:57.383861] Finished iteration 1146, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1494.441
[2022-12-01 18:23:58.889848] Finished iteration 1147, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1505.987
[2022-12-01 18:24:00.343220] Finished iteration 1148, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.315
[2022-12-01 18:24:01.864923] Finished iteration 1149, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1521.697
[2022-12-01 18:23:16.811710] Epoch: [0][1150/195]	Time  1.546 ( 2.141)	Data  0.004 ( 0.324)	Loss 4.6069e+00 (4.6097e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:24:03.410420] Finished iteration 1150, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1545.431
[2022-12-01 18:24:04.905057] Finished iteration 1151, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1494.605
[2022-12-01 18:24:06.384096] Finished iteration 1152, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1479.011
[2022-12-01 18:24:07.900257] Finished iteration 1153, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1516.173
[2022-12-01 18:24:09.436846] Finished iteration 1154, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1536.558
[2022-12-01 18:24:10.882951] Finished iteration 1155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1446.021
[2022-12-01 18:24:12.412913] Finished iteration 1156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1529.991
[2022-12-01 18:24:13.866318] Finished iteration 1157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.302
[2022-12-01 18:24:15.449528] Finished iteration 1158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.181
[2022-12-01 18:24:17.040833] Finished iteration 1159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1591.301
[2022-12-01 18:23:16.811710] Epoch: [0][1160/195]	Time  1.556 ( 1.934)	Data  0.004 ( 0.218)	Loss 4.6094e+00 (4.6097e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:24:18.597822] Finished iteration 1160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1556.915
[2022-12-01 18:24:20.106702] Finished iteration 1161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1508.884
[2022-12-01 18:24:21.606832] Finished iteration 1162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1500.111
[2022-12-01 18:24:23.059712] Finished iteration 1163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1452.815
[2022-12-01 18:24:24.565522] Finished iteration 1164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1505.802
[2022-12-01 18:24:26.059743] Finished iteration 1165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1494.158
[2022-12-01 18:24:27.502049] Finished iteration 1166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1442.299
[2022-12-01 18:24:28.989986] Finished iteration 1167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1487.900
[2022-12-01 18:24:30.389185] Finished iteration 1168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1399.182
[2022-12-01 18:24:31.802394] Finished iteration 1169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1413.131
[2022-12-01 18:23:16.811710] Epoch: [0][1170/195]	Time  1.462 ( 1.817)	Data  0.004 ( 0.164)	Loss 4.6128e+00 (4.6098e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:24:33.264900] Finished iteration 1170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1462.496
[2022-12-01 18:24:34.732165] Finished iteration 1171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1467.243
[2022-12-01 18:24:36.168302] Finished iteration 1172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1436.076
[2022-12-01 18:24:37.759695] Finished iteration 1173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1591.382
[2022-12-01 18:24:39.273034] Finished iteration 1174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.341
[2022-12-01 18:24:40.732748] Finished iteration 1175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.617
[2022-12-01 18:24:42.243979] Finished iteration 1176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1511.203
[2022-12-01 18:24:43.788136] Finished iteration 1177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1544.107
[2022-12-01 18:24:45.336054] Finished iteration 1178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1547.917
[2022-12-01 18:24:46.867683] Finished iteration 1179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1531.585
[2022-12-01 18:23:16.811710] Epoch: [0][1180/195]	Time  1.488 ( 1.755)	Data  0.004 ( 0.132)	Loss 4.6030e+00 (4.6090e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:24:48.357744] Finished iteration 1180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1490.021
[2022-12-01 18:24:49.764755] Finished iteration 1181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1406.994
[2022-12-01 18:24:51.253755] Finished iteration 1182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1488.922
[2022-12-01 18:24:52.866814] Finished iteration 1183, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1613.037
[2022-12-01 18:24:54.266162] Finished iteration 1184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1399.316
[2022-12-01 18:24:55.699204] Finished iteration 1185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1432.992
[2022-12-01 18:24:57.052722] Finished iteration 1186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1353.478
[2022-12-01 18:24:58.460938] Finished iteration 1187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1408.217
[2022-12-01 18:24:59.927986] Finished iteration 1188, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1466.978
[2022-12-01 18:25:01.427486] Finished iteration 1189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1499.468
[2022-12-01 18:23:16.811710] Epoch: [0][1190/195]	Time  1.625 ( 1.708)	Data  0.004 ( 0.111)	Loss 4.6118e+00 (4.6088e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:25:03.052364] Finished iteration 1190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1624.834
[2022-12-01 18:25:04.572533] Finished iteration 1191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1520.147
[2022-12-01 18:25:06.049215] Finished iteration 1192, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1476.661
[2022-12-01 18:25:07.499240] Finished iteration 1193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1449.981
[2022-12-01 18:25:08.902832] Finished iteration 1194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1403.559
[2022-12-01 18:25:10.279958] Finished iteration 1195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1377.095
[2022-12-01 18:25:11.729066] Finished iteration 1196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1449.064
[2022-12-01 18:25:13.186399] Finished iteration 1197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1457.302
[2022-12-01 18:25:14.647450] Finished iteration 1198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1461.047
[2022-12-01 18:25:16.145877] Finished iteration 1199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1498.385
[2022-12-01 18:23:16.811710] Epoch: [0][1200/195]	Time  1.467 ( 1.672)	Data  0.003 ( 0.096)	Loss 4.6040e+00 (4.6087e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:25:17.613244] Finished iteration 1200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1467.311
[2022-12-01 18:25:19.021060] Finished iteration 1201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1407.825
[2022-12-01 18:25:20.432112] Finished iteration 1202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1410.990
[2022-12-01 18:25:21.935381] Finished iteration 1203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1503.232
[2022-12-01 18:25:23.396948] Finished iteration 1204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1461.594
[2022-12-01 18:25:24.789365] Finished iteration 1205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1392.323
[2022-12-01 18:25:26.319192] Finished iteration 1206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1529.820
[2022-12-01 18:25:27.790344] Finished iteration 1207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1471.115
[2022-12-01 18:25:29.267691] Finished iteration 1208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.279
[2022-12-01 18:25:30.697933] Finished iteration 1209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1430.218
[2022-12-01 18:23:16.811710] Epoch: [0][1210/195]	Time  1.526 ( 1.645)	Data  0.003 ( 0.084)	Loss 4.6025e+00 (4.6086e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 18:25:32.224964] Finished iteration 1210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1527.014
[2022-12-01 18:25:33.634453] Finished iteration 1211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1409.463
