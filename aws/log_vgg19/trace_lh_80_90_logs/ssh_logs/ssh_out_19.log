Parent process ID: 135186 node: 172.31.30.133
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1037195.476436041 0
End of simulation:  Mini-batch time (usec) = 1491169
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 38 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 12531.734466552734 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1936784
Min send: 10000000, max send 0
Min long send: 541659, max long send 557166
Min fwd: 19455, max fwd 25575; min bwd 50188, max bwd 55357
Min long fwd: 9714, max long fwd 12638; min long bwd 24390, max long bwd 30607
Time taken by simulation: 145 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 354 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 580 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1591 microseconds

{1: 1.491169, 2: 1.936784, 3: 6.713432, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.936784
10 per stage
20 servers!
Config:
ranks: range(19, 20)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=19 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 147
[2022-12-01 17:34:55.534036] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 1.4862415790557861
SHARED WEIGHTS ARE
None
this rank  19 is part of pipeline replica  9
7 chunks
>>>>> [2022-12-01 17:35:21.584335] Time taken to load checkpoint: 19.040s
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:35:35.225104] Finished iteration 148, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8643.089
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:35:37.634323] Finished iteration 149, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2408.986
[2022-12-01 17:35:21.584540] Epoch: [0][150/223]	Time  1.490 ( 4.175)	Data  0.017 ( 0.545)	Loss 4.6289e+00 (4.6189e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:35:40.115386] Finished iteration 150, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2481.100
[2022-12-01 17:35:42.487220] Finished iteration 151, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2371.743
[2022-12-01 17:35:43.991500] Finished iteration 152, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.205
[2022-12-01 17:35:45.461172] Finished iteration 153, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1469.609
[2022-12-01 17:35:47.001547] Finished iteration 154, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1540.343
[2022-12-01 17:35:48.357522] Finished iteration 155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1355.981
[2022-12-01 17:35:49.738694] Finished iteration 156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1381.087
[2022-12-01 17:35:51.180004] Finished iteration 157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1441.272
[2022-12-01 17:35:52.593393] Finished iteration 158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1413.419
[2022-12-01 17:35:54.116103] Finished iteration 159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1522.606
[2022-12-01 17:35:21.584540] Epoch: [0][160/223]	Time  1.503 ( 2.233)	Data  0.003 ( 0.287)	Loss 4.6205e+00 (4.6201e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:35:55.619705] Finished iteration 160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1503.556
[2022-12-01 17:35:56.995591] Finished iteration 161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1375.865
[2022-12-01 17:35:58.449187] Finished iteration 162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1453.559
[2022-12-01 17:35:59.991785] Finished iteration 163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1542.570
[2022-12-01 17:36:01.501204] Finished iteration 164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1509.375
[2022-12-01 17:36:02.933424] Finished iteration 165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1432.219
[2022-12-01 17:36:04.449062] Finished iteration 166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1515.597
[2022-12-01 17:36:05.865497] Finished iteration 167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1416.398
[2022-12-01 17:36:07.287932] Finished iteration 168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1422.385
[2022-12-01 17:36:08.678903] Finished iteration 169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1390.947
[2022-12-01 17:35:21.584540] Epoch: [0][170/223]	Time  1.554 ( 1.897)	Data  0.017 ( 0.165)	Loss 4.6105e+00 (4.6179e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:36:10.221653] Finished iteration 170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1542.691
[2022-12-01 17:36:11.570366] Finished iteration 171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1348.672
[2022-12-01 17:36:12.995647] Finished iteration 172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1425.240
[2022-12-01 17:36:14.450827] Finished iteration 173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1455.171
[2022-12-01 17:36:15.943188] Finished iteration 174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.290
[2022-12-01 17:36:17.447619] Finished iteration 175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.406
[2022-12-01 17:36:18.858871] Finished iteration 176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1411.211
[2022-12-01 17:36:20.296224] Finished iteration 177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1437.305
[2022-12-01 17:36:21.740993] Finished iteration 178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1444.745
[2022-12-01 17:36:23.167484] Finished iteration 179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1426.451
[2022-12-01 17:35:21.584540] Epoch: [0][180/223]	Time  1.391 ( 1.757)	Data  0.005 ( 0.117)	Loss 4.6088e+00 (4.6171e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:36:24.561993] Finished iteration 180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1394.454
[2022-12-01 17:36:25.932258] Finished iteration 181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1370.241
[2022-12-01 17:36:27.345124] Finished iteration 182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1412.840
[2022-12-01 17:36:28.910986] Finished iteration 183, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1565.810
[2022-12-01 17:36:30.359806] Finished iteration 184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1448.805
[2022-12-01 17:36:31.807605] Finished iteration 185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1447.735
[2022-12-01 17:36:33.265653] Finished iteration 186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1458.015
[2022-12-01 17:36:34.625235] Finished iteration 187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1359.524
[2022-12-01 17:36:36.007224] Finished iteration 188, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1381.951
Opt ckpt time 9.484984874725342
Process done with return code 0
Parent process ID: 135960 node: 172.31.30.133
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1054087.8195929518 0
End of simulation:  Mini-batch time (usec) = 1508061
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 47 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 12531.734466552734 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1936784
Min send: 10000000, max send 0
Min long send: 541659, max long send 557166
Min fwd: 19455, max fwd 25575; min bwd 50188, max bwd 55357
Min long fwd: 9714, max long fwd 12638; min long bwd 24390, max long bwd 30607
Time taken by simulation: 147 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 10 0 7426.251411437988 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5881272
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 9353, max fwd 19440; min bwd 21838, max bwd 41244
Min long fwd: 1820, max long fwd 9207; min long bwd 11095, max long bwd 16912
Time taken by simulation: 330 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 580 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1638 microseconds

{1: 1.508061, 2: 1.936784, 3: 5.881272, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.936784
10 per stage
20 servers!
Config:
ranks: range(19, 20)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=19 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 188
[2022-12-01 17:36:57.225144] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8406684398651123
SHARED WEIGHTS ARE
None
this rank  19 is part of pipeline replica  9
7 chunks
>>>>> [2022-12-01 17:37:29.899537] Time taken to load checkpoint: 26.346s
2022-12-01 17:37:42.610709 Begin to exit
Process done with return code 0
Parent process ID: 136624 node: 172.31.30.133
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1070194.1820360157 0
End of simulation:  Mini-batch time (usec) = 1410943
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 37 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 13341.7387008667 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1874030
Min send: 10000000, max send 0
Min long send: 541803, max long send 558203
Min fwd: 19455, max fwd 25575; min bwd 51033, max bwd 53581
Min long fwd: 9714, max long fwd 13926; min long bwd 24633, max long bwd 28292
Time taken by simulation: 132 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 10 0 7426.251411437988 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5881272
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 9353, max fwd 19440; min bwd 21838, max bwd 41244
Min long fwd: 1820, max long fwd 9207; min long bwd 11095, max long bwd 16912
Time taken by simulation: 324 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 578 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1598 microseconds

{1: 1.410943, 2: 1.87403, 3: 5.881272, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.87403
11 per stage
22 servers!
Config:
ranks: range(19, 20)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 11
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;
World size is 22
/opt/conda/envs/varuna/bin/python -u main.py --rank=19 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21; --batch-size=192 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 188
[2022-12-01 17:37:57.237010] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.800410270690918
SHARED WEIGHTS ARE
None
this rank  19 is part of pipeline replica  9
6 chunks
>>>>> [2022-12-01 17:38:29.990319] Time taken to load checkpoint: 26.437s
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:38:50.870003] Finished iteration 189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8705.887
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:38:29.990537] Epoch: [0][190/260]	Time  2.240 ( 5.471)	Data  0.005 ( 0.552)	Loss 4.6146e+00 (4.6243e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:38:53.110327] Finished iteration 190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2240.130
[2022-12-01 17:38:55.449326] Finished iteration 191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2339.024
[2022-12-01 17:38:57.783583] Finished iteration 192, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2334.136
[2022-12-01 17:39:00.099233] Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2315.644
[2022-12-01 17:39:01.367132] Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1267.791
[2022-12-01 17:39:02.655329] Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1288.158
[2022-12-01 17:39:03.893504] Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1238.190
[2022-12-01 17:39:05.149013] Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.439
[2022-12-01 17:39:06.388145] Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1239.075
[2022-12-01 17:39:07.616341] Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1228.188
[2022-12-01 17:38:29.990537] Epoch: [0][200/260]	Time  1.200 ( 2.221)	Data  0.004 ( 0.267)	Loss 4.6081e+00 (4.6159e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:08.818287] Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1201.868
[2022-12-01 17:39:10.044292] Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1225.987
[2022-12-01 17:39:11.273381] Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.087
[2022-12-01 17:39:12.480212] Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1206.783
[2022-12-01 17:39:13.695355] Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1215.092
[2022-12-01 17:39:14.969482] Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1274.103
[2022-12-01 17:39:16.281936] Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1312.394
[2022-12-01 17:39:17.555428] Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1273.447
[2022-12-01 17:39:18.798573] Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1243.109
[2022-12-01 17:39:20.054044] Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.439
[2022-12-01 17:38:29.990537] Epoch: [0][210/260]	Time  1.292 ( 1.781)	Data  0.004 ( 0.148)	Loss 4.6126e+00 (4.6139e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:21.345616] Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1291.530
[2022-12-01 17:39:22.617920] Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1272.393
[2022-12-01 17:39:23.844233] Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1226.159
[2022-12-01 17:39:25.179761] Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1335.485
[2022-12-01 17:39:26.405611] Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1225.819
[2022-12-01 17:39:27.620180] Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1214.568
[2022-12-01 17:39:28.850108] Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.850
[2022-12-01 17:39:30.090753] Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1240.605
[2022-12-01 17:39:31.372705] Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1281.917
[2022-12-01 17:39:32.632341] Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1259.599
[2022-12-01 17:38:29.990537] Epoch: [0][220/260]	Time  1.257 ( 1.616)	Data  0.006 ( 0.103)	Loss 4.6042e+00 (4.6144e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:33.887005] Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1254.706
[2022-12-01 17:39:35.169849] Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1282.738
[2022-12-01 17:39:36.463381] Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1293.491
[2022-12-01 17:39:37.733695] Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1270.303
[2022-12-01 17:39:38.978310] Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1244.572
[2022-12-01 17:39:40.223481] Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.135
[2022-12-01 17:39:41.525448] Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1301.953
[2022-12-01 17:39:42.812084] Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1286.573
[2022-12-01 17:39:44.042078] Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.949
[2022-12-01 17:39:45.306121] Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1264.013
[2022-12-01 17:38:29.990537] Epoch: [0][230/260]	Time  1.383 ( 1.536)	Data  0.004 ( 0.080)	Loss 4.6380e+00 (4.6143e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:46.692920] Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1386.725
[2022-12-01 17:39:47.944605] Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1251.670
[2022-12-01 17:39:49.162660] Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1218.014
[2022-12-01 17:39:50.456205] Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1293.530
[2022-12-01 17:39:51.723441] Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1267.171
[2022-12-01 17:39:53.004983] Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1281.502
[2022-12-01 17:39:54.475372] Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.354
[2022-12-01 17:39:55.744926] Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1269.518
[2022-12-01 17:39:57.019211] Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1274.244
[2022-12-01 17:39:58.221134] Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1201.885
[2022-12-01 17:38:29.990537] Epoch: [0][240/260]	Time  1.255 ( 1.487)	Data  0.004 ( 0.065)	Loss 4.6224e+00 (4.6155e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:39:59.476081] Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1254.905
[2022-12-01 17:40:00.733495] Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1257.433
[2022-12-01 17:40:02.019046] Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1285.481
[2022-12-01 17:40:03.296849] Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1277.757
[2022-12-01 17:40:04.563280] Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1266.396
[2022-12-01 17:40:05.776158] Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1212.840
[2022-12-01 17:40:07.133051] Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1356.850
[2022-12-01 17:40:08.421271] Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1288.179
[2022-12-01 17:40:09.675372] Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1254.093
[2022-12-01 17:40:10.925745] Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1250.311
[2022-12-01 17:38:29.990537] Epoch: [0][250/260]	Time  1.304 ( 1.453)	Data  0.004 ( 0.055)	Loss 4.6152e+00 (4.6157e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:40:12.230023] Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1304.269
[2022-12-01 17:40:13.446317] Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1216.264
[2022-12-01 17:40:14.850912] Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1404.549
[2022-12-01 17:40:16.414159] Finished iteration 253, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1563.198
[2022-12-01 17:40:17.650426] Finished iteration 254, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1236.226
[2022-12-01 17:40:18.903177] Finished iteration 255, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.709
[2022-12-01 17:40:20.138223] Finished iteration 256, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1235.028
[2022-12-01 17:40:21.475214] Finished iteration 257, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1336.942
[2022-12-01 17:40:22.736031] Finished iteration 258, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1260.846
[2022-12-01 17:40:23.971170] Finished iteration 259, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1235.118
[2022-12-01 17:38:29.990537] Epoch: [0][260/260]	Time  1.277 ( 1.432)	Data  0.004 ( 0.048)	Loss 4.6074e+00 (4.6152e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:40:25.248189] Finished iteration 260, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1276.888
[2022-12-01 17:40:26.470097] Finished iteration 261, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1221.883
[2022-12-01 17:40:27.698413] Finished iteration 262, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1228.400
[2022-12-01 17:40:28.995549] Finished iteration 263, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1296.979
[2022-12-01 17:40:30.256370] Finished iteration 264, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1260.778
[2022-12-01 17:40:31.541847] Finished iteration 265, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1285.464
[2022-12-01 17:40:32.872290] Finished iteration 266, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1330.381
[2022-12-01 17:40:34.127702] Finished iteration 267, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.374
[2022-12-01 17:40:35.400766] Finished iteration 268, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1273.022
Opt ckpt time 1.3235523700714111
Process done with return code 0
Parent process ID: 137521 node: 172.31.30.133
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1085584.4648944305 0
End of simulation:  Mini-batch time (usec) = 1426333
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 39 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 13341.7387008667 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1874030
Min send: 10000000, max send 0
Min long send: 541803, max long send 558203
Min fwd: 19455, max fwd 25575; min bwd 51033, max bwd 53581
Min long fwd: 9714, max long fwd 13926; min long bwd 24633, max long bwd 28292
Time taken by simulation: 133 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 10 0 7426.251411437988 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5881272
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 9353, max fwd 19440; min bwd 21838, max bwd 41244
Min long fwd: 1820, max long fwd 9207; min long bwd 11095, max long bwd 16912
Time taken by simulation: 327 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 581 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1620 microseconds

{1: 1.426333, 2: 1.87403, 3: 5.881272, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.87403
11 per stage
22 servers!
Config:
ranks: range(19, 20)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 11
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;
World size is 22
/opt/conda/envs/varuna/bin/python -u main.py --rank=19 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21; --batch-size=192 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 268
[2022-12-01 17:40:58.201022] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8139529228210449
SHARED WEIGHTS ARE
None
this rank  19 is part of pipeline replica  9
6 chunks
>>>>> [2022-12-01 17:41:25.164664] Time taken to load checkpoint: 20.636s
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:41:42.572537] Finished iteration 269, CKPT_AND_STOP: False, flag: tensor([10], dtype=torch.int32), speed: 8811.264
Opt ckpt time 1.1814379692077637
Process done with return code 0
Parent process ID: 138261 node: 172.31.30.133
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1100319.6399779066 0
End of simulation:  Mini-batch time (usec) = 1441068
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 38 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 14791.502952575684 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1875480
Min send: 10000000, max send 0
Min long send: 541803, max long send 558203
Min fwd: 19455, max fwd 25575; min bwd 51033, max bwd 53581
Min long fwd: 9714, max long fwd 13926; min long bwd 24633, max long bwd 28292
Time taken by simulation: 133 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 8 0 7257.938385009766 929913.8118823369
End of simulation:  Mini-batch time (usec) = 5013330
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 9569, max fwd 19440; min bwd 21459, max bwd 40310
Min long fwd: 3647, max long fwd 6960; min long bwd 11398, max long bwd 19649
Time taken by simulation: 270 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 11 0 3334.3632221221924 929913.8118823369
End of simulation:  Mini-batch time (usec) = 8596253
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 14502, max bwd 31547
Min long fwd: 316, max long fwd 5135; min long bwd 7963, max long bwd 16258
Time taken by simulation: 505 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 16 0 1710.5143070220947 541471.8854995001
End of simulation:  Mini-batch time (usec) = 8451674
Min send: 10000000, max send 0
Min long send: 541525, max long send 566678
Min fwd: 1047, max fwd 12458; min bwd 6945, max bwd 22688
Min long fwd: 301, max long fwd 5892; min long bwd 586, max long bwd 6688
Time taken by simulation: 1181 microseconds

{1: 1.441068, 2: 1.87548, 3: 5.01333, 4: 8.596253, 6: 8.451674}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.87548
12 per stage
24 servers!
Config:
ranks: range(19, 20)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 12
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22;1,3,5,7,9,11,13,15,17,19,21,23;
World size is 24
/opt/conda/envs/varuna/bin/python -u main.py --rank=19 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22;1,3,5,7,9,11,13,15,17,19,21,23; --batch-size=192 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 269
[2022-12-01 17:41:58.980455] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8108954429626465
SHARED WEIGHTS ARE
None
this rank  19 is part of pipeline replica  9
6 chunks
>>>>> [2022-12-01 17:42:26.166220] Time taken to load checkpoint: 20.845s
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:42:26.166420] Epoch: [0][270/260]	Time  8.159 ( 8.159)	Data  1.339 ( 1.339)	Loss 4.6165e+00 (4.6165e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:42:41.331050] Finished iteration 270, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9195.092
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:42:43.615135] Finished iteration 271, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2283.809
[2022-12-01 17:42:44.851261] Finished iteration 272, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1236.050
[2022-12-01 17:42:46.145157] Finished iteration 273, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1293.846
[2022-12-01 17:42:48.383162] Finished iteration 274, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2238.036
[2022-12-01 17:42:49.570366] Finished iteration 275, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1187.121
[2022-12-01 17:42:50.806589] Finished iteration 276, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1236.166
[2022-12-01 17:42:52.028063] Finished iteration 277, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1221.473
[2022-12-01 17:42:53.292179] Finished iteration 278, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1264.038
[2022-12-01 17:42:54.552761] Finished iteration 279, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1260.544
[2022-12-01 17:42:26.166420] Epoch: [0][280/260]	Time  1.190 ( 2.145)	Data  0.007 ( 0.407)	Loss 4.5964e+00 (4.6145e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:42:55.740800] Finished iteration 280, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1187.992
[2022-12-01 17:42:56.993665] Finished iteration 281, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.846
[2022-12-01 17:42:58.226413] Finished iteration 282, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1232.810
[2022-12-01 17:42:59.436253] Finished iteration 283, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1209.696
[2022-12-01 17:43:00.740541] Finished iteration 284, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1304.253
[2022-12-01 17:43:02.212202] Finished iteration 285, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1471.620
[2022-12-01 17:43:03.795593] Finished iteration 286, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1583.377
[2022-12-01 17:43:05.435226] Finished iteration 287, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1639.567
[2022-12-01 17:43:06.649961] Finished iteration 288, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1214.723
[2022-12-01 17:43:07.929409] Finished iteration 289, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1279.438
[2022-12-01 17:42:26.166420] Epoch: [0][290/260]	Time  1.292 ( 1.766)	Data  0.006 ( 0.217)	Loss 4.6198e+00 (4.6138e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:09.223707] Finished iteration 290, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.206
[2022-12-01 17:43:10.518957] Finished iteration 291, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1295.228
[2022-12-01 17:43:11.747881] Finished iteration 292, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1228.900
[2022-12-01 17:43:12.952795] Finished iteration 293, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1204.902
[2022-12-01 17:43:14.182275] Finished iteration 294, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.399
[2022-12-01 17:43:15.460197] Finished iteration 295, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1277.906
[2022-12-01 17:43:16.707805] Finished iteration 296, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1247.569
[2022-12-01 17:43:17.988924] Finished iteration 297, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1281.051
[2022-12-01 17:43:19.234623] Finished iteration 298, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.657
[2022-12-01 17:43:20.452969] Finished iteration 299, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1218.305
[2022-12-01 17:42:26.166420] Epoch: [0][300/260]	Time  1.253 ( 1.599)	Data  0.008 ( 0.149)	Loss 4.6217e+00 (4.6146e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:21.702514] Finished iteration 300, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.498
[2022-12-01 17:43:22.964220] Finished iteration 301, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1261.689
[2022-12-01 17:43:24.196459] Finished iteration 302, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1232.197
[2022-12-01 17:43:25.476912] Finished iteration 303, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1280.414
[2022-12-01 17:43:26.686739] Finished iteration 304, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1209.784
[2022-12-01 17:43:27.924472] Finished iteration 305, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1237.701
[2022-12-01 17:43:29.104290] Finished iteration 306, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1179.779
[2022-12-01 17:43:30.451456] Finished iteration 307, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1347.138
[2022-12-01 17:43:31.654995] Finished iteration 308, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1203.483
[2022-12-01 17:43:32.952157] Finished iteration 309, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1297.124
[2022-12-01 17:42:26.166420] Epoch: [0][310/260]	Time  1.215 ( 1.513)	Data  0.005 ( 0.114)	Loss 4.6087e+00 (4.6143e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:34.170718] Finished iteration 310, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1218.518
[2022-12-01 17:43:35.407846] Finished iteration 311, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1237.102
[2022-12-01 17:43:36.671741] Finished iteration 312, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1263.861
[2022-12-01 17:43:37.901172] Finished iteration 313, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1229.394
[2022-12-01 17:43:39.189770] Finished iteration 314, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1288.560
[2022-12-01 17:43:40.439126] Finished iteration 315, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.325
[2022-12-01 17:43:41.672847] Finished iteration 316, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1233.679
[2022-12-01 17:43:42.919333] Finished iteration 317, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1246.447
[2022-12-01 17:43:44.154841] Finished iteration 318, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1235.497
[2022-12-01 17:43:45.368372] Finished iteration 319, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1213.474
[2022-12-01 17:42:26.166420] Epoch: [0][320/260]	Time  1.200 ( 1.459)	Data  0.004 ( 0.093)	Loss 4.6185e+00 (4.6143e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:46.569855] Finished iteration 320, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1201.466
[2022-12-01 17:43:47.886853] Finished iteration 321, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1316.945
[2022-12-01 17:43:49.118011] Finished iteration 322, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1231.118
[2022-12-01 17:43:50.385299] Finished iteration 323, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1267.247
[2022-12-01 17:43:51.613208] Finished iteration 324, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1227.837
[2022-12-01 17:43:52.915726] Finished iteration 325, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1302.512
[2022-12-01 17:43:54.233980] Finished iteration 326, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1318.180
[2022-12-01 17:43:55.509245] Finished iteration 327, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1275.224
[2022-12-01 17:43:56.774571] Finished iteration 328, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1265.296
[2022-12-01 17:43:58.601085] Finished iteration 329, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1826.470
[2022-12-01 17:42:26.166420] Epoch: [0][330/260]	Time  1.389 ( 1.440)	Data  0.010 ( 0.078)	Loss 4.6185e+00 (4.6145e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:43:59.999683] Finished iteration 330, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1398.558
[2022-12-01 17:44:01.274103] Finished iteration 331, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1274.395
[2022-12-01 17:44:02.569453] Finished iteration 332, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1295.343
[2022-12-01 17:44:03.831533] Finished iteration 333, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1262.010
[2022-12-01 17:44:05.070919] Finished iteration 334, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1239.345
[2022-12-01 17:44:06.339394] Finished iteration 335, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1268.441
[2022-12-01 17:44:07.585285] Finished iteration 336, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.849
[2022-12-01 17:44:08.884571] Finished iteration 337, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1299.242
[2022-12-01 17:44:10.208840] Finished iteration 338, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1324.232
[2022-12-01 17:44:11.492203] Finished iteration 339, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1283.325
[2022-12-01 17:42:26.166420] Epoch: [0][340/260]	Time  1.251 ( 1.417)	Data  0.006 ( 0.069)	Loss 4.6139e+00 (4.6143e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:12.742116] Finished iteration 340, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.895
[2022-12-01 17:44:14.022790] Finished iteration 341, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1280.621
[2022-12-01 17:44:15.230519] Finished iteration 342, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1207.691
[2022-12-01 17:44:16.483319] Finished iteration 343, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.877
[2022-12-01 17:44:17.740267] Finished iteration 344, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1256.795
[2022-12-01 17:44:18.963546] Finished iteration 345, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1223.246
[2022-12-01 17:44:20.150539] Finished iteration 346, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1187.019
[2022-12-01 17:44:21.411614] Finished iteration 347, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1261.009
[2022-12-01 17:44:22.657580] Finished iteration 348, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.895
[2022-12-01 17:44:23.888645] Finished iteration 349, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1231.020
[2022-12-01 17:42:26.166420] Epoch: [0][350/260]	Time  1.219 ( 1.395)	Data  0.004 ( 0.061)	Loss 4.6211e+00 (4.6141e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:25.110492] Finished iteration 350, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1221.878
[2022-12-01 17:44:26.405257] Finished iteration 351, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.669
[2022-12-01 17:44:27.616259] Finished iteration 352, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1210.960
[2022-12-01 17:44:28.863652] Finished iteration 353, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1247.355
[2022-12-01 17:44:30.110086] Finished iteration 354, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1246.397
[2022-12-01 17:44:31.355869] Finished iteration 355, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.744
[2022-12-01 17:44:32.546749] Finished iteration 356, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1190.840
[2022-12-01 17:44:33.804694] Finished iteration 357, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1257.909
[2022-12-01 17:44:35.001472] Finished iteration 358, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1196.770
[2022-12-01 17:44:36.260598] Finished iteration 359, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1259.048
[2022-12-01 17:42:26.166420] Epoch: [0][360/260]	Time  1.259 ( 1.378)	Data  0.006 ( 0.055)	Loss 4.6217e+00 (4.6144e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:37.519045] Finished iteration 360, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1258.412
[2022-12-01 17:44:38.818494] Finished iteration 361, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1299.427
[2022-12-01 17:44:39.996379] Finished iteration 362, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1177.922
[2022-12-01 17:44:41.242144] Finished iteration 363, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1245.651
[2022-12-01 17:44:42.464856] Finished iteration 364, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1222.670
[2022-12-01 17:44:43.673944] Finished iteration 365, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1209.052
[2022-12-01 17:44:44.922628] Finished iteration 366, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1248.641
[2022-12-01 17:44:46.178850] Finished iteration 367, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1256.183
[2022-12-01 17:44:47.397828] Finished iteration 368, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1218.940
[2022-12-01 17:44:48.613988] Finished iteration 369, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1216.120
[2022-12-01 17:42:26.166420] Epoch: [0][370/260]	Time  1.208 ( 1.363)	Data  0.004 ( 0.050)	Loss 4.6198e+00 (4.6144e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:44:49.828152] Finished iteration 370, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1214.144
[2022-12-01 17:44:51.095317] Finished iteration 371, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1267.117
[2022-12-01 17:44:52.285571] Finished iteration 372, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1190.216
[2022-12-01 17:44:53.527918] Finished iteration 373, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1242.310
[2022-12-01 17:44:54.783027] Finished iteration 374, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.084
[2022-12-01 17:44:56.031762] Finished iteration 375, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1248.680
[2022-12-01 17:44:57.275513] Finished iteration 376, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1243.718
[2022-12-01 17:44:58.550616] Finished iteration 377, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1275.066
[2022-12-01 17:44:59.802792] Finished iteration 378, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.138
[2022-12-01 17:45:01.072964] Finished iteration 379, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1270.132
[2022-12-01 17:42:26.166420] Epoch: [0][380/260]	Time  1.246 ( 1.353)	Data  0.004 ( 0.046)	Loss 4.6048e+00 (4.6139e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:45:02.322837] Finished iteration 380, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1249.833
[2022-12-01 17:45:03.575749] Finished iteration 381, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1252.882
[2022-12-01 17:45:04.799197] Finished iteration 382, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1223.436
[2022-12-01 17:45:06.085067] Finished iteration 383, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1285.943
Opt ckpt time 1.9625909328460693
Process done with return code 0
Parent process ID: 121966 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1037195.476436041 0
End of simulation:  Mini-batch time (usec) = 1491169
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 39 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 12531.734466552734 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1936784
Min send: 10000000, max send 0
Min long send: 541659, max long send 557166
Min fwd: 19455, max fwd 25575; min bwd 50188, max bwd 55357
Min long fwd: 9714, max long fwd 12638; min long bwd 24390, max long bwd 30607
Time taken by simulation: 144 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 349 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 2854.649543762207 929913.8118823369
End of simulation:  Mini-batch time (usec) = 9518264
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4126, max fwd 15893; min bwd 13534, max bwd 32007
Min long fwd: 861, max long fwd 5714; min long bwd 9661, max long bwd 16258
Time taken by simulation: 577 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1594 microseconds

{1: 1.491169, 2: 1.936784, 3: 6.713432, 4: 9.518264, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.936784
10 per stage
20 servers!
Config:
ranks: range(19, 20)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=19 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 383
[2022-12-01 17:45:59.438856] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.96293044090271
SHARED WEIGHTS ARE
None
this rank  19 is part of pipeline replica  9
7 chunks
>>>>> [2022-12-01 17:46:34.287143] Time taken to load checkpoint: 28.367s
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 17:46:49.991789] Finished iteration 384, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9730.870
19 Overflow !!
19 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 17:46:52.480136] Finished iteration 385, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2488.084
[2022-12-01 17:46:54.877252] Finished iteration 386, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2397.101
[2022-12-01 17:46:56.269508] Finished iteration 387, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1392.132
[2022-12-01 17:46:57.650016] Finished iteration 388, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1380.471
[2022-12-01 17:46:59.070094] Finished iteration 389, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1420.048
[2022-12-01 17:46:34.287359] Epoch: [0][390/223]	Time  1.432 ( 2.890)	Data  0.011 ( 0.612)	Loss 4.6071e+00 (4.6135e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 17:47:00.502664] Finished iteration 390, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1432.528
[2022-12-01 17:47:01.953246] Finished iteration 391, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1450.591
[2022-12-01 17:47:03.359244] Finished iteration 392, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1405.932
[2022-12-01 17:47:04.883345] Finished iteration 393, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1524.064
[2022-12-01 17:47:06.356512] Finished iteration 394, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1473.149
Opt ckpt time 1.390416145324707
Process done with return code 0
