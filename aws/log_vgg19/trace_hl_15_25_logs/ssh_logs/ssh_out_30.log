Parent process ID: 88522 node: 172.31.25.155
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 2 0 1199922.1801757812 0
End of simulation:  Mini-batch time (usec) = 1424058
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 32895; min long bwd 78677, max long bwd 79978
Time taken by simulation: 44 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 22892.793655395508 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1466822
Min send: 10000000, max send 0
Min long send: 541803, max long send 554555
Min fwd: 21083, max fwd 25575; min bwd 48477, max bwd 54184
Min long fwd: 7473, max long fwd 14307; min long bwd 25716, max long bwd 30607
Time taken by simulation: 97 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 7 0 7540.138721466064 929913.8118823369
End of simulation:  Mini-batch time (usec) = 4955939
Min send: 10000000, max send 0
Min long send: 930245, max long send 945608
Min fwd: 8775, max fwd 19684; min bwd 24478, max bwd 41849
Min long fwd: 2259, max long fwd 7334; min long bwd 12226, max long bwd 16590
Time taken by simulation: 230 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 8 0 3659.188747406006 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6836714
Min send: 10000000, max send 0
Min long send: 929995, max long send 954618
Min fwd: 4418, max fwd 15941; min bwd 13005, max bwd 30581
Min long fwd: 989, max long fwd 6784; min long bwd 7050, max long bwd 13429
Time taken by simulation: 368 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 13 0 1801.1889457702637 541471.8854995001
End of simulation:  Mini-batch time (usec) = 7858281
Min send: 10000000, max send 0
Min long send: 541553, max long send 566176
Min fwd: 380, max fwd 12458; min bwd 8532, max bwd 24401
Min long fwd: 1017, max long fwd 4595; min long bwd 780, max long bwd 6417
Time taken by simulation: 950 microseconds

{1: 1.424058, 2: 1.466822, 3: 4.955939, 4: 6.836714, 6: 7.858281}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.466822
16 per stage
32 servers!
Config:
ranks: range(30, 31)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 16
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31;
World size is 32
/opt/conda/envs/varuna/bin/python -u main.py --rank=30 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31; --batch-size=128 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 288
[2022-12-01 19:46:22.753426] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8139350414276123
SHARED WEIGHTS ARE
None
this rank  30 is part of pipeline replica  15
4 chunks
>>>>> [2022-12-01 19:46:46.288213] Time taken to load checkpoint: 16.857s
30 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 19:47:14.092457] Finished iteration 289, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8722.849
30 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 19:46:46.288452] Epoch: [0][290/390]	Time  1.461 ( 5.089)	Data  0.006 ( 0.508)	Loss 4.6211e+00 (4.6162e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:47:16.585671] Finished iteration 290, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2492.809
30 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 19:47:18.924818] Finished iteration 291, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2339.103
[2022-12-01 19:47:21.517537] Finished iteration 292, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2592.742
[2022-12-01 19:47:23.924987] Finished iteration 293, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2407.353
[2022-12-01 19:47:25.384057] Finished iteration 294, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.018
[2022-12-01 19:47:27.056873] Finished iteration 295, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1672.780
[2022-12-01 19:47:28.633854] Finished iteration 296, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1576.998
[2022-12-01 19:47:30.188464] Finished iteration 297, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1554.478
[2022-12-01 19:47:31.651375] Finished iteration 298, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1462.900
[2022-12-01 19:47:33.186670] Finished iteration 299, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1535.222
[2022-12-01 19:46:46.288452] Epoch: [0][300/390]	Time  1.709 ( 2.460)	Data  0.006 ( 0.347)	Loss 4.6123e+00 (4.6207e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:47:34.895576] Finished iteration 300, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1708.851
[2022-12-01 19:47:36.581962] Finished iteration 301, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1686.361
[2022-12-01 19:47:38.611587] Finished iteration 302, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2029.569
[2022-12-01 19:47:40.169593] Finished iteration 303, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1558.045
[2022-12-01 19:47:41.468148] Finished iteration 304, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1298.418
[2022-12-01 19:47:42.879690] Finished iteration 305, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1411.683
[2022-12-01 19:47:44.226726] Finished iteration 306, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1346.912
[2022-12-01 19:47:45.719162] Finished iteration 307, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.340
[2022-12-01 19:47:46.994768] Finished iteration 308, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1275.488
[2022-12-01 19:47:48.371861] Finished iteration 309, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1377.142
[2022-12-01 19:46:46.288452] Epoch: [0][310/390]	Time  1.474 ( 2.021)	Data  0.006 ( 0.192)	Loss 4.6084e+00 (4.6164e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:47:49.844827] Finished iteration 310, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1472.814
[2022-12-01 19:47:51.435901] Finished iteration 311, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1591.063
[2022-12-01 19:47:53.234165] Finished iteration 312, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1798.245
[2022-12-01 19:47:54.576376] Finished iteration 313, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1342.123
[2022-12-01 19:47:55.820680] Finished iteration 314, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1244.259
[2022-12-01 19:47:57.491223] Finished iteration 315, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1670.492
[2022-12-01 19:47:58.951099] Finished iteration 316, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1459.829
[2022-12-01 19:48:00.293536] Finished iteration 317, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1342.399
[2022-12-01 19:48:01.864172] Finished iteration 318, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1570.586
[2022-12-01 19:48:03.204874] Finished iteration 319, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1340.659
[2022-12-01 19:46:46.288452] Epoch: [0][320/390]	Time  1.663 ( 1.859)	Data  0.005 ( 0.134)	Loss 4.6074e+00 (4.6145e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:48:04.873645] Finished iteration 320, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1668.714
[2022-12-01 19:48:06.191836] Finished iteration 321, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1318.155
[2022-12-01 19:48:07.695937] Finished iteration 322, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.083
[2022-12-01 19:48:09.020675] Finished iteration 323, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1324.672
[2022-12-01 19:48:10.395109] Finished iteration 324, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1374.384
[2022-12-01 19:48:12.073456] Finished iteration 325, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1678.304
[2022-12-01 19:48:13.395202] Finished iteration 326, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1321.703
[2022-12-01 19:48:14.782026] Finished iteration 327, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1386.774
[2022-12-01 19:48:16.220417] Finished iteration 328, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1438.343
[2022-12-01 19:48:18.078122] Finished iteration 329, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1857.689
[2022-12-01 19:46:46.288452] Epoch: [0][330/390]	Time  1.652 ( 1.770)	Data  0.006 ( 0.103)	Loss 4.6045e+00 (4.6139e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:48:19.730205] Finished iteration 330, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1652.015
[2022-12-01 19:48:21.124461] Finished iteration 331, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1394.215
[2022-12-01 19:48:22.805546] Finished iteration 332, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1681.035
[2022-12-01 19:48:24.169632] Finished iteration 333, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1364.020
[2022-12-01 19:48:25.388743] Finished iteration 334, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1219.134
[2022-12-01 19:48:26.917110] Finished iteration 335, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1528.291
[2022-12-01 19:48:28.384417] Finished iteration 336, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1467.248
[2022-12-01 19:48:29.745656] Finished iteration 337, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1361.167
[2022-12-01 19:48:31.080785] Finished iteration 338, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1335.101
[2022-12-01 19:48:32.594191] Finished iteration 339, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.377
[2022-12-01 19:46:46.288452] Epoch: [0][340/390]	Time  1.456 ( 1.705)	Data  0.006 ( 0.084)	Loss 4.6162e+00 (4.6138e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:48:34.049448] Finished iteration 340, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1455.199
[2022-12-01 19:48:35.463835] Finished iteration 341, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1414.353
[2022-12-01 19:48:36.903366] Finished iteration 342, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1439.474
[2022-12-01 19:48:38.222870] Finished iteration 343, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1319.464
[2022-12-01 19:48:39.578585] Finished iteration 344, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1355.673
[2022-12-01 19:48:41.318215] Finished iteration 345, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1739.614
[2022-12-01 19:48:42.759397] Finished iteration 346, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1441.149
[2022-12-01 19:48:44.229665] Finished iteration 347, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.181
[2022-12-01 19:48:45.517664] Finished iteration 348, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1287.935
[2022-12-01 19:48:46.889598] Finished iteration 349, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1371.893
[2022-12-01 19:46:46.288452] Epoch: [0][350/390]	Time  1.451 ( 1.661)	Data  0.005 ( 0.072)	Loss 4.6133e+00 (4.6141e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:48:48.340840] Finished iteration 350, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1451.171
[2022-12-01 19:48:49.866225] Finished iteration 351, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1525.424
[2022-12-01 19:48:51.467241] Finished iteration 352, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1600.899
[2022-12-01 19:48:53.208378] Finished iteration 353, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1741.091
[2022-12-01 19:48:54.525807] Finished iteration 354, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1317.442
[2022-12-01 19:48:55.843845] Finished iteration 355, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1317.911
[2022-12-01 19:48:57.351757] Finished iteration 356, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1507.867
[2022-12-01 19:48:58.853900] Finished iteration 357, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1502.105
[2022-12-01 19:49:00.406815] Finished iteration 358, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1552.871
[2022-12-01 19:49:01.938360] Finished iteration 359, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1531.495
[2022-12-01 19:46:46.288452] Epoch: [0][360/390]	Time  1.295 ( 1.637)	Data  0.005 ( 0.063)	Loss 4.6123e+00 (4.6146e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:49:03.232875] Finished iteration 360, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.460
[2022-12-01 19:49:04.742897] Finished iteration 361, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1510.015
[2022-12-01 19:49:06.135184] Finished iteration 362, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1392.228
[2022-12-01 19:49:07.426197] Finished iteration 363, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1290.979
[2022-12-01 19:49:09.011184] Finished iteration 364, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1584.918
[2022-12-01 19:49:10.458313] Finished iteration 365, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1447.111
[2022-12-01 19:49:11.948632] Finished iteration 366, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1490.259
[2022-12-01 19:49:13.688157] Finished iteration 367, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1739.459
[2022-12-01 19:49:15.343282] Finished iteration 368, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1655.106
[2022-12-01 19:49:16.664231] Finished iteration 369, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1320.895
[2022-12-01 19:46:46.288452] Epoch: [0][370/390]	Time  1.341 ( 1.617)	Data  0.005 ( 0.056)	Loss 4.6172e+00 (4.6149e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:49:18.005290] Finished iteration 370, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1341.007
[2022-12-01 19:49:19.845507] Finished iteration 371, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1840.181
[2022-12-01 19:49:21.393083] Finished iteration 372, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1547.542
[2022-12-01 19:49:22.717576] Finished iteration 373, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1324.430
[2022-12-01 19:49:23.993962] Finished iteration 374, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1276.369
[2022-12-01 19:49:25.525410] Finished iteration 375, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1531.364
[2022-12-01 19:49:27.002684] Finished iteration 376, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.278
[2022-12-01 19:49:28.309672] Finished iteration 377, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1306.922
[2022-12-01 19:49:29.705258] Finished iteration 378, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1395.483
[2022-12-01 19:49:30.813489] Finished iteration 379, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1108.186
[2022-12-01 19:46:46.288452] Epoch: [0][380/390]	Time  1.313 ( 1.595)	Data  0.005 ( 0.050)	Loss 4.6221e+00 (4.6149e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:49:32.127132] Finished iteration 380, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1313.600
[2022-12-01 19:49:33.759988] Finished iteration 381, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1632.825
[2022-12-01 19:49:35.090282] Finished iteration 382, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1330.341
[2022-12-01 19:49:36.402191] Finished iteration 383, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1311.787
[2022-12-01 19:49:37.737625] Finished iteration 384, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1335.366
[2022-12-01 19:49:39.021628] Finished iteration 385, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1283.949
[2022-12-01 19:49:40.511772] Finished iteration 386, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1490.103
[2022-12-01 19:49:41.998641] Finished iteration 387, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1486.863
[2022-12-01 19:49:43.288573] Finished iteration 388, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1289.935
[2022-12-01 19:49:44.761482] Finished iteration 389, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1472.771
[2022-12-01 19:46:46.288452] Epoch: [0][390/390]	Time  1.469 ( 1.577)	Data  0.005 ( 0.046)	Loss 4.5986e+00 (4.6145e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:49:46.231802] Finished iteration 390, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.313
[2022-12-01 19:49:47.606591] Finished iteration 391, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1374.763
[2022-12-01 19:49:49.303077] Finished iteration 392, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1696.416
[2022-12-01 19:49:50.775879] Finished iteration 393, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1472.741
[2022-12-01 19:49:52.343005] Finished iteration 394, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1567.085
[2022-12-01 19:49:53.816478] Finished iteration 395, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1473.515
[2022-12-01 19:49:55.559254] Finished iteration 396, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1742.633
[2022-12-01 19:49:57.042081] Finished iteration 397, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1482.840
[2022-12-01 19:49:58.399306] Finished iteration 398, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1357.108
[2022-12-01 19:49:59.822961] Finished iteration 399, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1423.612
[2022-12-01 19:46:46.288452] Epoch: [0][400/390]	Time  1.441 ( 1.570)	Data  0.006 ( 0.043)	Loss 4.6240e+00 (4.6147e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:50:01.264059] Finished iteration 400, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1441.056
[2022-12-01 19:50:02.708224] Finished iteration 401, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1444.140
[2022-12-01 19:50:04.179902] Finished iteration 402, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1471.626
[2022-12-01 19:50:05.491029] Finished iteration 403, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1311.078
[2022-12-01 19:50:07.112547] Finished iteration 404, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1621.460
[2022-12-01 19:50:08.445791] Finished iteration 405, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1333.208
[2022-12-01 19:50:09.792404] Finished iteration 406, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1346.552
[2022-12-01 19:50:11.306088] Finished iteration 407, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1513.675
[2022-12-01 19:50:12.599612] Finished iteration 408, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1293.422
[2022-12-01 19:50:13.910333] Finished iteration 409, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1310.732
[2022-12-01 19:46:46.288452] Epoch: [0][410/390]	Time  1.419 ( 1.557)	Data  0.005 ( 0.040)	Loss 4.6191e+00 (4.6142e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:50:15.330000] Finished iteration 410, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1419.603
[2022-12-01 19:50:16.682698] Finished iteration 411, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1352.628
[2022-12-01 19:50:17.976747] Finished iteration 412, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1294.101
[2022-12-01 19:50:19.259890] Finished iteration 413, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1283.060
[2022-12-01 19:50:20.709363] Finished iteration 414, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1449.368
[2022-12-01 19:50:22.025669] Finished iteration 415, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1316.260
[2022-12-01 19:50:23.346315] Finished iteration 416, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1320.632
[2022-12-01 19:50:24.725944] Finished iteration 417, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1379.550
[2022-12-01 19:50:26.124866] Finished iteration 418, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1398.872
[2022-12-01 19:50:27.766855] Finished iteration 419, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1641.938
[2022-12-01 19:46:46.288452] Epoch: [0][420/390]	Time  1.456 ( 1.544)	Data  0.005 ( 0.037)	Loss 4.6074e+00 (4.6141e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:50:29.222735] Finished iteration 420, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1455.833
[2022-12-01 19:50:30.510702] Finished iteration 421, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1287.935
[2022-12-01 19:50:31.921895] Finished iteration 422, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1411.147
[2022-12-01 19:50:33.198041] Finished iteration 423, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1276.097
[2022-12-01 19:50:35.029189] Finished iteration 424, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1831.150
[2022-12-01 19:50:36.569997] Finished iteration 425, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1540.759
[2022-12-01 19:50:38.174329] Finished iteration 426, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1604.233
[2022-12-01 19:50:39.659992] Finished iteration 427, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1485.582
[2022-12-01 19:50:40.952114] Finished iteration 428, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1292.113
[2022-12-01 19:50:42.578115] Finished iteration 429, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1625.966
[2022-12-01 19:46:46.288452] Epoch: [0][430/390]	Time  1.297 ( 1.539)	Data  0.005 ( 0.035)	Loss 4.6016e+00 (4.6139e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:50:43.876224] Finished iteration 430, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1298.012
[2022-12-01 19:50:45.191561] Finished iteration 431, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1315.311
[2022-12-01 19:50:46.865529] Finished iteration 432, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1673.940
[2022-12-01 19:50:48.336665] Finished iteration 433, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1471.057
[2022-12-01 19:50:49.640993] Finished iteration 434, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1304.362
[2022-12-01 19:50:51.089797] Finished iteration 435, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1448.738
[2022-12-01 19:50:52.414110] Finished iteration 436, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1324.246
[2022-12-01 19:50:53.877404] Finished iteration 437, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1463.212
[2022-12-01 19:50:55.562353] Finished iteration 438, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1684.994
[2022-12-01 19:50:57.063164] Finished iteration 439, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1500.656
[2022-12-01 19:46:46.288452] Epoch: [0][440/390]	Time  1.339 ( 1.533)	Data  0.006 ( 0.033)	Loss 4.6221e+00 (4.6141e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:50:58.401345] Finished iteration 440, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1338.125
[2022-12-01 19:51:00.022707] Finished iteration 441, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1621.338
[2022-12-01 19:51:01.593783] Finished iteration 442, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1571.043
[2022-12-01 19:51:03.123852] Finished iteration 443, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1530.021
[2022-12-01 19:51:04.584048] Finished iteration 444, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1460.120
[2022-12-01 19:51:05.860232] Finished iteration 445, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1276.142
[2022-12-01 19:51:07.115543] Finished iteration 446, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1255.267
[2022-12-01 19:51:08.537852] Finished iteration 447, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1422.270
[2022-12-01 19:51:10.000102] Finished iteration 448, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1462.187
[2022-12-01 19:51:11.457399] Finished iteration 449, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1457.257
[2022-12-01 19:46:46.288452] Epoch: [0][450/390]	Time  1.297 ( 1.527)	Data  0.005 ( 0.032)	Loss 4.6191e+00 (4.6142e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:51:12.754976] Finished iteration 450, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1297.503
[2022-12-01 19:51:14.267749] Finished iteration 451, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1512.765
[2022-12-01 19:51:15.760101] Finished iteration 452, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.309
[2022-12-01 19:51:17.423783] Finished iteration 453, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1663.713
[2022-12-01 19:51:18.882133] Finished iteration 454, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1458.252
[2022-12-01 19:51:20.181110] Finished iteration 455, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1298.887
[2022-12-01 19:51:21.519526] Finished iteration 456, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1338.389
[2022-12-01 19:51:22.828078] Finished iteration 457, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1308.488
[2022-12-01 19:51:24.323427] Finished iteration 458, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1495.317
[2022-12-01 19:51:26.020663] Finished iteration 459, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1697.165
[2022-12-01 19:46:46.288452] Epoch: [0][460/390]	Time  1.782 ( 1.526)	Data  0.005 ( 0.030)	Loss 4.6113e+00 (4.6139e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:51:27.803218] Finished iteration 460, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1782.486
[2022-12-01 19:51:29.041113] Finished iteration 461, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1237.875
[2022-12-01 19:51:30.497555] Finished iteration 462, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1456.398
[2022-12-01 19:51:31.960051] Finished iteration 463, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1462.450
[2022-12-01 19:51:33.403908] Finished iteration 464, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1443.795
[2022-12-01 19:51:34.953444] Finished iteration 465, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1549.489
[2022-12-01 19:51:36.740636] Finished iteration 466, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1787.231
[2022-12-01 19:51:38.070846] Finished iteration 467, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1330.064
[2022-12-01 19:51:39.393249] Finished iteration 468, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1322.357
[2022-12-01 19:51:40.695631] Finished iteration 469, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1302.334
[2022-12-01 19:46:46.288452] Epoch: [0][470/390]	Time  1.466 ( 1.521)	Data  0.005 ( 0.029)	Loss 4.6025e+00 (4.6136e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:51:42.161819] Finished iteration 470, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1466.126
[2022-12-01 19:51:43.646485] Finished iteration 471, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1484.660
[2022-12-01 19:51:45.081320] Finished iteration 472, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1434.758
[2022-12-01 19:51:46.485182] Finished iteration 473, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1403.834
[2022-12-01 19:51:47.804030] Finished iteration 474, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1318.775
[2022-12-01 19:51:49.517296] Finished iteration 475, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1713.217
[2022-12-01 19:51:50.992888] Finished iteration 476, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1475.540
[2022-12-01 19:51:52.543340] Finished iteration 477, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1550.386
[2022-12-01 19:51:54.089436] Finished iteration 478, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1546.065
[2022-12-01 19:51:55.431787] Finished iteration 479, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1342.307
[2022-12-01 19:46:46.288452] Epoch: [0][480/390]	Time  1.080 ( 1.516)	Data  0.005 ( 0.027)	Loss 4.6221e+00 (4.6135e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:51:56.512248] Finished iteration 480, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1080.401
[2022-12-01 19:51:57.785149] Finished iteration 481, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1272.881
[2022-12-01 19:51:59.289427] Finished iteration 482, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1504.239
[2022-12-01 19:52:00.537475] Finished iteration 483, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1248.000
[2022-12-01 19:52:01.942312] Finished iteration 484, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1404.831
[2022-12-01 19:52:03.336369] Finished iteration 485, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1394.032
[2022-12-01 19:52:04.845040] Finished iteration 486, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1508.561
[2022-12-01 19:52:06.316274] Finished iteration 487, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1471.229
[2022-12-01 19:52:07.632648] Finished iteration 488, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1316.270
[2022-12-01 19:52:09.097621] Finished iteration 489, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1464.956
[2022-12-01 19:46:46.288452] Epoch: [0][490/390]	Time  1.436 ( 1.511)	Data  0.005 ( 0.026)	Loss 4.6006e+00 (4.6133e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:52:10.534713] Finished iteration 490, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1437.028
[2022-12-01 19:52:11.857916] Finished iteration 491, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1323.182
[2022-12-01 19:52:12.933206] Finished iteration 492, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1075.313
[2022-12-01 19:52:14.425564] Finished iteration 493, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.229
[2022-12-01 19:52:16.079409] Finished iteration 494, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1653.798
[2022-12-01 19:52:17.394718] Finished iteration 495, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1315.270
[2022-12-01 19:52:18.917930] Finished iteration 496, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1523.155
[2022-12-01 19:52:20.480617] Finished iteration 497, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1562.620
[2022-12-01 19:52:21.764248] Finished iteration 498, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1283.630
[2022-12-01 19:52:23.469151] Finished iteration 499, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1704.881
[2022-12-01 19:46:46.288452] Epoch: [0][500/390]	Time  1.208 ( 1.506)	Data  0.005 ( 0.025)	Loss 4.6084e+00 (4.6135e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:52:24.676476] Finished iteration 500, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1207.195
[2022-12-01 19:52:26.152621] Finished iteration 501, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1476.191
[2022-12-01 19:52:27.776214] Finished iteration 502, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1623.491
[2022-12-01 19:52:28.934926] Finished iteration 503, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1158.645
[2022-12-01 19:52:30.037709] Finished iteration 504, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1102.776
[2022-12-01 19:52:31.435499] Finished iteration 505, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1397.722
[2022-12-01 19:52:32.992720] Finished iteration 506, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1557.164
[2022-12-01 19:52:34.165176] Finished iteration 507, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1172.417
[2022-12-01 19:52:35.380306] Finished iteration 508, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1215.125
[2022-12-01 19:52:36.854879] Finished iteration 509, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1474.492
[2022-12-01 19:46:46.288452] Epoch: [0][510/390]	Time  1.288 ( 1.499)	Data  0.005 ( 0.024)	Loss 4.6162e+00 (4.6136e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:52:38.143584] Finished iteration 510, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1288.674
[2022-12-01 19:52:39.426922] Finished iteration 511, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1283.370
[2022-12-01 19:52:41.109593] Finished iteration 512, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1682.540
[2022-12-01 19:52:42.397543] Finished iteration 513, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1287.894
[2022-12-01 19:52:43.667357] Finished iteration 514, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1269.763
[2022-12-01 19:52:45.079383] Finished iteration 515, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1412.004
[2022-12-01 19:52:46.554319] Finished iteration 516, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1474.906
[2022-12-01 19:52:47.841807] Finished iteration 517, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1287.402
[2022-12-01 19:52:49.238232] Finished iteration 518, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.407
[2022-12-01 19:52:50.731106] Finished iteration 519, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.815
[2022-12-01 19:46:46.288452] Epoch: [0][520/390]	Time  1.664 ( 1.496)	Data  0.005 ( 0.024)	Loss 4.6172e+00 (4.6134e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:52:52.395671] Finished iteration 520, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1664.510
[2022-12-01 19:52:54.061015] Finished iteration 521, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1665.324
[2022-12-01 19:52:55.619399] Finished iteration 522, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1558.338
[2022-12-01 19:52:57.164027] Finished iteration 523, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1544.580
[2022-12-01 19:52:58.645950] Finished iteration 524, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1481.869
[2022-12-01 19:52:59.890883] Finished iteration 525, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1244.946
[2022-12-01 19:53:01.378864] Finished iteration 526, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1487.885
[2022-12-01 19:53:02.657380] Finished iteration 527, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1278.494
[2022-12-01 19:53:04.015787] Finished iteration 528, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1358.324
[2022-12-01 19:53:05.678598] Finished iteration 529, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1662.786
[2022-12-01 19:46:46.288452] Epoch: [0][530/390]	Time  1.652 ( 1.496)	Data  0.005 ( 0.023)	Loss 4.6084e+00 (4.6132e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:53:07.330406] Finished iteration 530, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1651.741
[2022-12-01 19:53:08.615201] Finished iteration 531, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1284.768
[2022-12-01 19:53:10.375553] Finished iteration 532, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1760.312
[2022-12-01 19:53:11.672389] Finished iteration 533, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1296.770
[2022-12-01 19:53:13.182048] Finished iteration 534, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1509.613
[2022-12-01 19:53:14.666426] Finished iteration 535, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1484.309
[2022-12-01 19:53:16.152313] Finished iteration 536, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1485.885
[2022-12-01 19:53:17.424190] Finished iteration 537, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1271.784
[2022-12-01 19:53:18.725783] Finished iteration 538, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1301.593
[2022-12-01 19:53:20.417800] Finished iteration 539, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1691.919
[2022-12-01 19:46:46.288452] Epoch: [0][540/390]	Time  1.318 ( 1.493)	Data  0.006 ( 0.022)	Loss 4.6201e+00 (4.6132e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 19:53:21.734348] Finished iteration 540, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1316.507
[2022-12-01 19:53:23.087489] Finished iteration 541, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1353.122
[2022-12-01 19:53:24.364345] Finished iteration 542, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1276.797
[2022-12-01 19:53:26.217860] Finished iteration 543, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1853.480
Opt ckpt time 1.2741060256958008
Process done with return code 0
Parent process ID: 117921 node: 172.31.27.155
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1188930.0075556464 0
End of simulation:  Mini-batch time (usec) = 1529679
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 42 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 5 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1774283
Min send: 10000000, max send 0
Min long send: 541803, max long send 554555
Min fwd: 18455, max fwd 25575; min bwd 51079, max bwd 53581
Min long fwd: 8875, max long fwd 13712; min long bwd 25318, max long bwd 30607
Time taken by simulation: 113 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 7 0 7540.138721466064 929913.8118823369
End of simulation:  Mini-batch time (usec) = 4955939
Min send: 10000000, max send 0
Min long send: 930245, max long send 945608
Min fwd: 8775, max fwd 19684; min bwd 24478, max bwd 41849
Min long fwd: 2259, max long fwd 7334; min long bwd 12226, max long bwd 16590
Time taken by simulation: 232 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 10 0 3605.3318977355957 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7727483
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4418, max fwd 15893; min bwd 14410, max bwd 31066
Min long fwd: 532, max long fwd 8412; min long bwd 9236, max long bwd 15394
Time taken by simulation: 479 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 13 0 1801.1889457702637 541471.8854995001
End of simulation:  Mini-batch time (usec) = 7858281
Min send: 10000000, max send 0
Min long send: 541553, max long send 566176
Min fwd: 380, max fwd 12458; min bwd 8532, max bwd 24401
Min long fwd: 1017, max long fwd 4595; min long bwd 780, max long bwd 6417
Time taken by simulation: 911 microseconds

{1: 1.529679, 2: 1.774283, 3: 4.955939, 4: 7.727483, 6: 7.858281}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.774283
15 per stage
30 servers!
30 30 I am of no use!
Parent process ID: 148403 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1188930.0075556464 0
End of simulation:  Mini-batch time (usec) = 1529679
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 42 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 5 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1774283
Min send: 10000000, max send 0
Min long send: 541803, max long send 554555
Min fwd: 18455, max fwd 25575; min bwd 51079, max bwd 53581
Min long fwd: 8875, max long fwd 13712; min long bwd 25318, max long bwd 30607
Time taken by simulation: 115 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 7 0 7540.138721466064 929913.8118823369
End of simulation:  Mini-batch time (usec) = 4955939
Min send: 10000000, max send 0
Min long send: 930245, max long send 945608
Min fwd: 8775, max fwd 19684; min bwd 24478, max bwd 41849
Min long fwd: 2259, max long fwd 7334; min long bwd 12226, max long bwd 16590
Time taken by simulation: 232 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 10 0 3605.3318977355957 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7727483
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4418, max fwd 15893; min bwd 14410, max bwd 31066
Min long fwd: 532, max long fwd 8412; min long bwd 9236, max long bwd 15394
Time taken by simulation: 459 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 13 0 1801.1889457702637 541471.8854995001
End of simulation:  Mini-batch time (usec) = 7858281
Min send: 10000000, max send 0
Min long send: 541553, max long send 566176
Min fwd: 380, max fwd 12458; min bwd 8532, max bwd 24401
Min long fwd: 1017, max long fwd 4595; min long bwd 780, max long bwd 6417
Time taken by simulation: 931 microseconds

{1: 1.529679, 2: 1.774283, 3: 4.955939, 4: 7.727483, 6: 7.858281}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.774283
15 per stage
30 servers!
30 30 I am of no use!
Parent process ID: 148735 node: 172.31.28.143
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 2 0 1199922.1801757812 0
End of simulation:  Mini-batch time (usec) = 1424058
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 32895; min long bwd 78677, max long bwd 79978
Time taken by simulation: 34 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 22892.793655395508 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1466822
Min send: 10000000, max send 0
Min long send: 541803, max long send 554555
Min fwd: 21083, max fwd 25575; min bwd 48477, max bwd 54184
Min long fwd: 7473, max long fwd 14307; min long bwd 25716, max long bwd 30607
Time taken by simulation: 99 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 7 0 7540.138721466064 929913.8118823369
End of simulation:  Mini-batch time (usec) = 4955939
Min send: 10000000, max send 0
Min long send: 930245, max long send 945608
Min fwd: 8775, max fwd 19684; min bwd 24478, max bwd 41849
Min long fwd: 2259, max long fwd 7334; min long bwd 12226, max long bwd 16590
Time taken by simulation: 230 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 8 0 3659.188747406006 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6836714
Min send: 10000000, max send 0
Min long send: 929995, max long send 954618
Min fwd: 4418, max fwd 15941; min bwd 13005, max bwd 30581
Min long fwd: 989, max long fwd 6784; min long bwd 7050, max long bwd 13429
Time taken by simulation: 371 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 13 0 1801.1889457702637 541471.8854995001
End of simulation:  Mini-batch time (usec) = 7858281
Min send: 10000000, max send 0
Min long send: 541553, max long send 566176
Min fwd: 380, max fwd 12458; min bwd 8532, max bwd 24401
Min long fwd: 1017, max long fwd 4595; min long bwd 780, max long bwd 6417
Time taken by simulation: 908 microseconds

{1: 1.424058, 2: 1.466822, 3: 4.955939, 4: 6.836714, 6: 7.858281}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.466822
16 per stage
32 servers!
Config:
ranks: range(30, 31)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 16
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31;
World size is 32
/opt/conda/envs/varuna/bin/python -u main.py --rank=30 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31; --batch-size=128 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 833
[2022-12-01 20:04:24.572216] => creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.9497125148773193
SHARED WEIGHTS ARE
None
this rank  30 is part of pipeline replica  15
4 chunks
>>>>> [2022-12-01 20:04:50.336396] Time taken to load checkpoint: 19.084s
30 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 20:05:32.401699] Finished iteration 834, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8567.411
30 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 20:05:34.490058] Finished iteration 835, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2088.054
30 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 20:05:36.586306] Finished iteration 836, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2096.218
[2022-12-01 20:05:38.645688] Finished iteration 837, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2059.366
[2022-12-01 20:05:40.696014] Finished iteration 838, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2050.261
[2022-12-01 20:05:41.754480] Finished iteration 839, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1058.397
[2022-12-01 20:04:50.336633] Epoch: [0][840/390]	Time  1.034 ( 2.707)	Data  0.005 ( 0.401)	Loss 4.6084e+00 (4.6059e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:05:42.789957] Finished iteration 840, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1035.435
[2022-12-01 20:05:43.836705] Finished iteration 841, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1046.728
[2022-12-01 20:05:44.870618] Finished iteration 842, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1033.872
[2022-12-01 20:05:45.892894] Finished iteration 843, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1022.238
[2022-12-01 20:05:46.889431] Finished iteration 844, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 996.498
[2022-12-01 20:05:47.915810] Finished iteration 845, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1026.342
[2022-12-01 20:05:48.917839] Finished iteration 846, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1002.144
[2022-12-01 20:05:49.972603] Finished iteration 847, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1054.598
[2022-12-01 20:05:50.964606] Finished iteration 848, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 991.958
[2022-12-01 20:05:52.027932] Finished iteration 849, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1063.330
[2022-12-01 20:04:50.336633] Epoch: [0][850/390]	Time  1.053 ( 1.720)	Data  0.005 ( 0.168)	Loss 4.6152e+00 (4.6083e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:05:53.082799] Finished iteration 850, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1054.756
[2022-12-01 20:05:54.129477] Finished iteration 851, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1046.674
[2022-12-01 20:05:55.390741] Finished iteration 852, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1261.210
[2022-12-01 20:05:56.434248] Finished iteration 853, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1043.468
[2022-12-01 20:05:57.450969] Finished iteration 854, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1016.681
[2022-12-01 20:05:58.530515] Finished iteration 855, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1079.500
[2022-12-01 20:05:59.574717] Finished iteration 856, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1044.204
[2022-12-01 20:06:00.634231] Finished iteration 857, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1059.466
[2022-12-01 20:06:01.661139] Finished iteration 858, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1026.894
[2022-12-01 20:06:02.674354] Finished iteration 859, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1013.148
[2022-12-01 20:04:50.336633] Epoch: [0][860/390]	Time  1.081 ( 1.478)	Data  0.005 ( 0.108)	Loss 4.6045e+00 (4.6096e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:06:03.755649] Finished iteration 860, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1081.246
[2022-12-01 20:06:04.797077] Finished iteration 861, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1041.391
[2022-12-01 20:06:05.846823] Finished iteration 862, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1049.718
[2022-12-01 20:06:06.870304] Finished iteration 863, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1023.511
[2022-12-01 20:06:07.938685] Finished iteration 864, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1068.285
[2022-12-01 20:06:08.982696] Finished iteration 865, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1043.983
[2022-12-01 20:06:10.039109] Finished iteration 866, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1056.370
[2022-12-01 20:06:11.355197] Finished iteration 867, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1316.045
[2022-12-01 20:06:12.761492] Finished iteration 868, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1406.244
[2022-12-01 20:06:13.793844] Finished iteration 869, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1032.312
[2022-12-01 20:04:50.336633] Epoch: [0][870/390]	Time  1.000 ( 1.377)	Data  0.005 ( 0.080)	Loss 4.6025e+00 (4.6102e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:06:14.793439] Finished iteration 870, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 999.542
[2022-12-01 20:06:15.845000] Finished iteration 871, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1051.545
[2022-12-01 20:06:16.946124] Finished iteration 872, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1101.133
[2022-12-01 20:06:18.018788] Finished iteration 873, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1072.582
[2022-12-01 20:06:19.042299] Finished iteration 874, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1023.473
[2022-12-01 20:06:20.091393] Finished iteration 875, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1049.038
[2022-12-01 20:06:21.141721] Finished iteration 876, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1050.289
[2022-12-01 20:06:22.161285] Finished iteration 877, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1019.564
[2022-12-01 20:06:23.202081] Finished iteration 878, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1040.716
[2022-12-01 20:06:24.239367] Finished iteration 879, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1037.256
[2022-12-01 20:04:50.336633] Epoch: [0][880/390]	Time  1.038 ( 1.307)	Data  0.007 ( 0.064)	Loss 4.6152e+00 (4.6099e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:06:25.275953] Finished iteration 880, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1036.540
[2022-12-01 20:06:26.295385] Finished iteration 881, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1019.460
[2022-12-01 20:06:27.331549] Finished iteration 882, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1036.088
[2022-12-01 20:06:28.355888] Finished iteration 883, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1024.289
[2022-12-01 20:06:29.371352] Finished iteration 884, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1015.427
[2022-12-01 20:06:30.432113] Finished iteration 885, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1060.733
[2022-12-01 20:06:31.460709] Finished iteration 886, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1028.568
[2022-12-01 20:06:32.519719] Finished iteration 887, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1059.017
[2022-12-01 20:06:33.590022] Finished iteration 888, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1070.216
[2022-12-01 20:06:34.712204] Finished iteration 889, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1122.224
[2022-12-01 20:04:50.336633] Epoch: [0][890/390]	Time  1.099 ( 1.263)	Data  0.005 ( 0.054)	Loss 4.6025e+00 (4.6090e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:06:35.811006] Finished iteration 890, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1098.689
[2022-12-01 20:06:36.810237] Finished iteration 891, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 999.216
[2022-12-01 20:06:37.835883] Finished iteration 892, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1025.586
[2022-12-01 20:06:38.847359] Finished iteration 893, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1011.409
[2022-12-01 20:06:39.841699] Finished iteration 894, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 994.313
[2022-12-01 20:06:40.896418] Finished iteration 895, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1054.714
[2022-12-01 20:06:41.968453] Finished iteration 896, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1071.980
[2022-12-01 20:06:42.984623] Finished iteration 897, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1016.214
[2022-12-01 20:06:44.015959] Finished iteration 898, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1031.315
[2022-12-01 20:06:45.115547] Finished iteration 899, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1099.437
[2022-12-01 20:04:50.336633] Epoch: [0][900/390]	Time  1.034 ( 1.229)	Data  0.005 ( 0.047)	Loss 4.6172e+00 (4.6098e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:06:46.149431] Finished iteration 900, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1033.917
[2022-12-01 20:06:47.167044] Finished iteration 901, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1017.530
[2022-12-01 20:06:48.211162] Finished iteration 902, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1044.072
[2022-12-01 20:06:49.261293] Finished iteration 903, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1050.162
[2022-12-01 20:06:50.348916] Finished iteration 904, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1087.544
[2022-12-01 20:06:51.409578] Finished iteration 905, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1060.595
[2022-12-01 20:06:52.429260] Finished iteration 906, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1019.681
[2022-12-01 20:06:53.459511] Finished iteration 907, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1030.201
[2022-12-01 20:06:54.489866] Finished iteration 908, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1030.316
[2022-12-01 20:06:55.513187] Finished iteration 909, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1023.297
[2022-12-01 20:04:50.336633] Epoch: [0][910/390]	Time  1.074 ( 1.204)	Data  0.006 ( 0.041)	Loss 4.6035e+00 (4.6095e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:06:56.586059] Finished iteration 910, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1072.824
[2022-12-01 20:06:57.655975] Finished iteration 911, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1069.886
[2022-12-01 20:06:58.747002] Finished iteration 912, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1090.990
[2022-12-01 20:06:59.825906] Finished iteration 913, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1078.849
[2022-12-01 20:07:00.906567] Finished iteration 914, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1080.646
[2022-12-01 20:07:01.897664] Finished iteration 915, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 991.036
[2022-12-01 20:07:02.930969] Finished iteration 916, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1033.258
[2022-12-01 20:07:03.957274] Finished iteration 917, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1026.317
[2022-12-01 20:07:04.978698] Finished iteration 918, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1021.350
[2022-12-01 20:07:06.006905] Finished iteration 919, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1028.163
[2022-12-01 20:04:50.336633] Epoch: [0][920/390]	Time  1.026 ( 1.186)	Data  0.005 ( 0.037)	Loss 4.6064e+00 (4.6097e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:07:07.033370] Finished iteration 920, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1026.414
[2022-12-01 20:07:08.082086] Finished iteration 921, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1048.707
[2022-12-01 20:07:09.131482] Finished iteration 922, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1049.351
[2022-12-01 20:07:10.209447] Finished iteration 923, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1077.920
[2022-12-01 20:07:11.354525] Finished iteration 924, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1145.046
[2022-12-01 20:07:12.406465] Finished iteration 925, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1051.899
[2022-12-01 20:07:13.451165] Finished iteration 926, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1044.667
[2022-12-01 20:07:14.639146] Finished iteration 927, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1187.976
[2022-12-01 20:07:16.094498] Finished iteration 928, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1455.276
[2022-12-01 20:07:17.195721] Finished iteration 929, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1101.180
[2022-12-01 20:04:50.336633] Epoch: [0][930/390]	Time  1.075 ( 1.180)	Data  0.005 ( 0.034)	Loss 4.6240e+00 (4.6103e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:07:18.271274] Finished iteration 930, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1075.514
[2022-12-01 20:07:19.313258] Finished iteration 931, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1041.989
[2022-12-01 20:07:20.370261] Finished iteration 932, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1056.942
[2022-12-01 20:07:21.453215] Finished iteration 933, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1082.943
[2022-12-01 20:07:22.543251] Finished iteration 934, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1089.973
[2022-12-01 20:07:23.634296] Finished iteration 935, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1091.040
[2022-12-01 20:07:24.671766] Finished iteration 936, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1037.400
[2022-12-01 20:07:25.694552] Finished iteration 937, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1022.756
[2022-12-01 20:07:26.746632] Finished iteration 938, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1052.030
[2022-12-01 20:07:27.796201] Finished iteration 939, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1049.535
[2022-12-01 20:04:50.336633] Epoch: [0][940/390]	Time  1.056 ( 1.168)	Data  0.005 ( 0.032)	Loss 4.6006e+00 (4.6100e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:07:28.853977] Finished iteration 940, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1057.729
[2022-12-01 20:07:29.859947] Finished iteration 941, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1005.951
[2022-12-01 20:07:30.909285] Finished iteration 942, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1049.327
[2022-12-01 20:07:31.948479] Finished iteration 943, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1039.135
[2022-12-01 20:07:33.001934] Finished iteration 944, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1053.450
[2022-12-01 20:07:34.032916] Finished iteration 945, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1030.907
[2022-12-01 20:07:35.062850] Finished iteration 946, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1029.898
[2022-12-01 20:07:36.053195] Finished iteration 947, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.330
[2022-12-01 20:07:37.103933] Finished iteration 948, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1050.690
[2022-12-01 20:07:38.094663] Finished iteration 949, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.707
[2022-12-01 20:04:50.336633] Epoch: [0][950/390]	Time  1.016 ( 1.156)	Data  0.005 ( 0.029)	Loss 4.5947e+00 (4.6099e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:07:39.110720] Finished iteration 950, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1015.982
[2022-12-01 20:07:40.109045] Finished iteration 951, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 998.299
[2022-12-01 20:07:41.154225] Finished iteration 952, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1045.171
[2022-12-01 20:07:42.261097] Finished iteration 953, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1106.809
[2022-12-01 20:07:43.404211] Finished iteration 954, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1143.086
[2022-12-01 20:07:44.488309] Finished iteration 955, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1084.030
[2022-12-01 20:07:45.519573] Finished iteration 956, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1031.224
[2022-12-01 20:07:46.599922] Finished iteration 957, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1080.429
[2022-12-01 20:07:47.625868] Finished iteration 958, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1025.789
[2022-12-01 20:07:48.664740] Finished iteration 959, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1038.852
[2022-12-01 20:04:50.336633] Epoch: [0][960/390]	Time  1.116 ( 1.149)	Data  0.005 ( 0.027)	Loss 4.6133e+00 (4.6098e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:07:49.780926] Finished iteration 960, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1116.118
[2022-12-01 20:07:50.858364] Finished iteration 961, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1077.458
[2022-12-01 20:07:51.972443] Finished iteration 962, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1114.000
[2022-12-01 20:07:53.016376] Finished iteration 963, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1043.892
[2022-12-01 20:07:54.022953] Finished iteration 964, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1006.540
[2022-12-01 20:07:55.045239] Finished iteration 965, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1022.273
[2022-12-01 20:07:56.088812] Finished iteration 966, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1043.515
[2022-12-01 20:07:57.163653] Finished iteration 967, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1074.803
[2022-12-01 20:07:58.228098] Finished iteration 968, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1064.481
[2022-12-01 20:07:59.245407] Finished iteration 969, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1017.198
[2022-12-01 20:04:50.336633] Epoch: [0][970/390]	Time  1.045 ( 1.142)	Data  0.006 ( 0.026)	Loss 4.6084e+00 (4.6096e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:08:00.289250] Finished iteration 970, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1043.829
[2022-12-01 20:08:01.297724] Finished iteration 971, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1008.425
[2022-12-01 20:08:02.357477] Finished iteration 972, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1059.711
[2022-12-01 20:08:03.388563] Finished iteration 973, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1031.044
[2022-12-01 20:08:04.404742] Finished iteration 974, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1016.225
[2022-12-01 20:08:05.507913] Finished iteration 975, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1103.049
[2022-12-01 20:08:06.577599] Finished iteration 976, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1069.645
[2022-12-01 20:08:07.664988] Finished iteration 977, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1087.391
[2022-12-01 20:08:08.720472] Finished iteration 978, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1055.410
[2022-12-01 20:08:09.740819] Finished iteration 979, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1020.348
[2022-12-01 20:04:50.336633] Epoch: [0][980/390]	Time  1.058 ( 1.136)	Data  0.005 ( 0.024)	Loss 4.6094e+00 (4.6096e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:08:10.801246] Finished iteration 980, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1060.421
[2022-12-01 20:08:11.870385] Finished iteration 981, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1069.073
[2022-12-01 20:08:12.925961] Finished iteration 982, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1055.525
[2022-12-01 20:08:13.967447] Finished iteration 983, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1041.445
[2022-12-01 20:08:15.021850] Finished iteration 984, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1054.363
[2022-12-01 20:08:16.043344] Finished iteration 985, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1021.458
[2022-12-01 20:08:17.063681] Finished iteration 986, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1020.277
[2022-12-01 20:08:18.085131] Finished iteration 987, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1021.498
[2022-12-01 20:08:19.112694] Finished iteration 988, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1027.436
[2022-12-01 20:08:20.130310] Finished iteration 989, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1017.581
[2022-12-01 20:04:50.336633] Epoch: [0][990/390]	Time  1.040 ( 1.129)	Data  0.005 ( 0.023)	Loss 4.6006e+00 (4.6097e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:08:21.170615] Finished iteration 990, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1040.261
[2022-12-01 20:08:22.218628] Finished iteration 991, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1047.985
[2022-12-01 20:08:23.297623] Finished iteration 992, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1078.994
[2022-12-01 20:08:24.342194] Finished iteration 993, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1044.522
[2022-12-01 20:08:25.468521] Finished iteration 994, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1126.264
[2022-12-01 20:08:26.519349] Finished iteration 995, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1050.895
[2022-12-01 20:08:27.536805] Finished iteration 996, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1017.332
[2022-12-01 20:08:28.572878] Finished iteration 997, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1036.016
[2022-12-01 20:08:29.698955] Finished iteration 998, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1126.041
[2022-12-01 20:08:31.095484] Finished iteration 999, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.496
[2022-12-01 20:04:50.336633] Epoch: [0][1000/390]	Time  1.133 ( 1.128)	Data  0.013 ( 0.022)	Loss 4.6113e+00 (4.6097e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:08:32.221737] Finished iteration 1000, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1126.205
[2022-12-01 20:08:33.340831] Finished iteration 1001, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1119.098
[2022-12-01 20:08:34.450044] Finished iteration 1002, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1109.211
[2022-12-01 20:08:35.457488] Finished iteration 1003, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1007.365
[2022-12-01 20:08:36.516440] Finished iteration 1004, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1058.886
[2022-12-01 20:08:37.575545] Finished iteration 1005, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1059.072
[2022-12-01 20:08:38.619858] Finished iteration 1006, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1044.275
[2022-12-01 20:08:39.641188] Finished iteration 1007, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1021.318
[2022-12-01 20:08:40.687281] Finished iteration 1008, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1046.033
[2022-12-01 20:08:41.762247] Finished iteration 1009, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1074.946
[2022-12-01 20:04:50.336633] Epoch: [0][1010/390]	Time  1.067 ( 1.124)	Data  0.005 ( 0.021)	Loss 4.6035e+00 (4.6094e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:08:42.828808] Finished iteration 1010, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1066.501
[2022-12-01 20:08:43.904379] Finished iteration 1011, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1075.549
[2022-12-01 20:08:44.931680] Finished iteration 1012, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1027.305
[2022-12-01 20:08:45.968833] Finished iteration 1013, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1037.092
[2022-12-01 20:08:47.060417] Finished iteration 1014, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1091.541
[2022-12-01 20:08:48.181596] Finished iteration 1015, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1121.149
[2022-12-01 20:08:49.254058] Finished iteration 1016, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1072.462
[2022-12-01 20:08:50.335498] Finished iteration 1017, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1081.349
[2022-12-01 20:08:51.402891] Finished iteration 1018, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1067.348
[2022-12-01 20:08:52.554300] Finished iteration 1019, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1151.444
[2022-12-01 20:04:50.336633] Epoch: [0][1020/390]	Time  1.202 ( 1.123)	Data  0.012 ( 0.021)	Loss 4.6123e+00 (4.6095e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:08:53.751790] Finished iteration 1020, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1197.373
[2022-12-01 20:08:54.958435] Finished iteration 1021, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1206.621
[2022-12-01 20:08:56.017379] Finished iteration 1022, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1058.922
[2022-12-01 20:08:57.094464] Finished iteration 1023, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1077.061
[2022-12-01 20:08:58.109610] Finished iteration 1024, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1015.109
[2022-12-01 20:08:59.142216] Finished iteration 1025, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1032.568
[2022-12-01 20:09:00.146533] Finished iteration 1026, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1004.263
[2022-12-01 20:09:01.174356] Finished iteration 1027, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1027.775
[2022-12-01 20:09:02.170837] Finished iteration 1028, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 996.445
[2022-12-01 20:09:03.194249] Finished iteration 1029, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1023.387
[2022-12-01 20:04:50.336633] Epoch: [0][1030/390]	Time  1.036 ( 1.119)	Data  0.005 ( 0.020)	Loss 4.5986e+00 (4.6094e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:09:04.230334] Finished iteration 1030, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1036.051
[2022-12-01 20:09:05.240710] Finished iteration 1031, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1010.377
[2022-12-01 20:09:06.261903] Finished iteration 1032, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1021.104
[2022-12-01 20:09:07.327232] Finished iteration 1033, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1065.289
[2022-12-01 20:09:08.384279] Finished iteration 1034, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1057.013
[2022-12-01 20:09:09.429589] Finished iteration 1035, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1045.274
[2022-12-01 20:09:10.461054] Finished iteration 1036, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1031.431
[2022-12-01 20:09:11.501753] Finished iteration 1037, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1040.661
[2022-12-01 20:09:12.560360] Finished iteration 1038, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1058.562
[2022-12-01 20:09:13.618446] Finished iteration 1039, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1058.132
[2022-12-01 20:04:50.336633] Epoch: [0][1040/390]	Time  1.067 ( 1.115)	Data  0.005 ( 0.019)	Loss 4.6084e+00 (4.6093e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:09:14.685042] Finished iteration 1040, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1066.521
[2022-12-01 20:09:15.728038] Finished iteration 1041, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1042.903
[2022-12-01 20:09:16.829741] Finished iteration 1042, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1101.695
[2022-12-01 20:09:18.129256] Finished iteration 1043, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1299.475
[2022-12-01 20:09:19.149792] Finished iteration 1044, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1020.469
[2022-12-01 20:09:20.185651] Finished iteration 1045, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1035.817
[2022-12-01 20:09:21.269443] Finished iteration 1046, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1083.750
[2022-12-01 20:09:22.366286] Finished iteration 1047, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1096.804
[2022-12-01 20:09:23.428710] Finished iteration 1048, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1062.392
[2022-12-01 20:09:24.486083] Finished iteration 1049, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1057.348
[2022-12-01 20:04:50.336633] Epoch: [0][1050/390]	Time  1.062 ( 1.114)	Data  0.005 ( 0.018)	Loss 4.6084e+00 (4.6092e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 20:09:25.548613] Finished iteration 1050, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1062.494
Opt ckpt time 1.1583364009857178
Process done with return code 0
Parent process ID: 132406 node: 172.31.22.165
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 1188930.0075556464 0
End of simulation:  Mini-batch time (usec) = 1529679
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 33754; min long bwd 78677, max long bwd 82859
Time taken by simulation: 41 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 5 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 1774283
Min send: 10000000, max send 0
Min long send: 541803, max long send 554555
Min fwd: 18455, max fwd 25575; min bwd 51079, max bwd 53581
Min long fwd: 8875, max long fwd 13712; min long bwd 25318, max long bwd 30607
Time taken by simulation: 110 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 7 0 7540.138721466064 929913.8118823369
End of simulation:  Mini-batch time (usec) = 4955939
Min send: 10000000, max send 0
Min long send: 930245, max long send 945608
Min fwd: 8775, max fwd 19684; min bwd 24478, max bwd 41849
Min long fwd: 2259, max long fwd 7334; min long bwd 12226, max long bwd 16590
Time taken by simulation: 235 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 10 0 3605.3318977355957 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7727483
Min send: 10000000, max send 0
Min long send: 930101, max long send 952379
Min fwd: 4418, max fwd 15893; min bwd 14410, max bwd 31066
Min long fwd: 532, max long fwd 8412; min long bwd 9236, max long bwd 15394
Time taken by simulation: 456 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 13 0 1801.1889457702637 541471.8854995001
End of simulation:  Mini-batch time (usec) = 7858281
Min send: 10000000, max send 0
Min long send: 541553, max long send 566176
Min fwd: 380, max fwd 12458; min bwd 8532, max bwd 24401
Min long fwd: 1017, max long fwd 4595; min long bwd 780, max long bwd 6417
Time taken by simulation: 909 microseconds

{1: 1.529679, 2: 1.774283, 3: 4.955939, 4: 7.727483, 6: 7.858281}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 1.774283
15 per stage
30 servers!
30 30 I am of no use!
