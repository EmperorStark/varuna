Parent process ID: 15204 node: 172.31.20.223
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 1019436.4886319825 0
End of simulation:  Mini-batch time (usec) = 1473410
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 47 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12826.751708984375 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009897
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 165 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 11 0 6699.138164520264 929913.8118823369
End of simulation:  Mini-batch time (usec) = 6713432
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 23111, max bwd 41107
Min long fwd: 1397, max long fwd 9139; min long bwd 11354, max long bwd 19649
Time taken by simulation: 354 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 717 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 22 0 1199.0070343017578 541471.8854995001
End of simulation:  Mini-batch time (usec) = 10143004
Min send: 10000000, max send 0
Min long send: 541608, max long send 568633
Min fwd: 100, max fwd 13449; min bwd 5055, max bwd 25194
Min long fwd: 204, max long fwd 4354; min long bwd 636, max long bwd 8174
Time taken by simulation: 1627 microseconds

{1: 1.47341, 2: 2.009897, 3: 6.713432, 4: 10.570352, 6: 10.143004}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009897
9 per stage
18 servers!
Config:
ranks: range(1, 2)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 9
stage to rank map: 0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17;
World size is 18
/opt/conda/envs/varuna/bin/python -u main.py --rank=1 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17; --batch-size=224 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19
=> creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8523294925689697
SHARED WEIGHTS ARE
None
this rank  1 is part of pipeline replica  0
7 chunks
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-30 13:58:40.215704] Finished iteration 1, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9490.719
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-11-30 13:58:42.608953] Finished iteration 2, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2392.979
[2022-11-30 13:58:45.074028] Finished iteration 3, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2465.035
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-11-30 13:58:47.462509] Finished iteration 4, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2388.468
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-11-30 13:58:48.808760] Finished iteration 5, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1346.129
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-11-30 13:58:50.157845] Finished iteration 6, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1349.073
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-11-30 13:58:51.510706] Finished iteration 7, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1352.814
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
[2022-11-30 13:58:52.998292] Finished iteration 8, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1487.530
[2022-11-30 13:58:54.434350] Finished iteration 9, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1436.038
[2022-11-30 13:58:30.711339] Epoch: [0][ 10/224]	Time  1.395 ( 2.510)	Data  0.005 ( 0.511)	Loss 6.8945e+00 (1.6003e+01)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-11-30 13:58:55.831741] Finished iteration 10, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1397.308
[2022-11-30 13:58:57.163782] Finished iteration 11, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1332.014
[2022-11-30 13:58:58.432296] Finished iteration 12, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1268.474
[2022-11-30 13:58:59.767032] Finished iteration 13, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1334.697
[2022-11-30 13:59:01.117314] Finished iteration 14, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1350.251
[2022-11-30 13:59:02.543602] Finished iteration 15, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1426.247
[2022-11-30 13:59:03.949876] Finished iteration 16, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1406.235
[2022-11-30 13:59:05.422040] Finished iteration 17, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1472.123
[2022-11-30 13:59:06.847030] Finished iteration 18, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1424.960
[2022-11-30 13:59:08.193237] Finished iteration 19, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1346.168
[2022-11-30 13:58:30.711339] Epoch: [0][ 20/224]	Time  1.397 ( 1.943)	Data  0.006 ( 0.259)	Loss 5.3828e+00 (1.1011e+01)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-11-30 13:59:09.590257] Finished iteration 20, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1396.974
[2022-11-30 13:59:11.001120] Finished iteration 21, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1410.840
[2022-11-30 13:59:12.469093] Finished iteration 22, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1467.929
[2022-11-30 13:59:13.854359] Finished iteration 23, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1385.274
[2022-11-30 13:59:15.300091] Finished iteration 24, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1445.657
[2022-11-30 13:59:16.704686] Finished iteration 25, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1404.563
[2022-11-30 13:59:18.189503] Finished iteration 26, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1484.781
[2022-11-30 13:59:19.562887] Finished iteration 27, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1373.336
[2022-11-30 13:59:21.048878] Finished iteration 28, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1486.008
[2022-11-30 13:59:22.885909] Finished iteration 29, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1836.933
[2022-11-30 13:58:30.711339] Epoch: [0][ 30/224]	Time  1.308 ( 1.782)	Data  0.005 ( 0.175)	Loss 4.6886e+00 (8.9528e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-11-30 13:59:24.193791] Finished iteration 30, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1307.842
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 1 signal handler called with signal 10
Opt ckpt time 2.6509015560150146
Process done with return code 0
Parent process ID: 15680 node: 172.31.20.223
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 980927.4647721202 0
End of simulation:  Mini-batch time (usec) = 1434901
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 45 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009207
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 164 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 13 0 5941.788673400879 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7626781
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 21579, max bwd 43006
Min long fwd: 1397, max long fwd 9139; min long bwd 11398, max long bwd 19649
Time taken by simulation: 418 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 712 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2340 microseconds

{1: 1.434901, 2: 2.009207, 3: 7.626781, 4: 10.570352, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009207
8 per stage
16 servers!
Config:
ranks: range(1, 2)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 8
stage to rank map: 0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u main.py --rank=1 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15; --batch-size=256 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 30
=> creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.9702339172363281
SHARED WEIGHTS ARE
None
this rank  1 is part of pipeline replica  0
8 chunks
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-30 14:01:02.438184] Finished iteration 31, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9751.006
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 1 signal handler called with signal 10
[2022-11-30 14:01:04.951411] Finished iteration 32, CKPT_AND_STOP: True, flag: tensor([1], dtype=torch.int32), speed: 2512.948
Opt ckpt time 4.240801095962524
Process done with return code 0
Parent process ID: 16399 node: 172.31.20.223
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 959937.744140625 0
End of simulation:  Mini-batch time (usec) = 1413911
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 32586, max long fwd 34870; min long bwd 78355, max long bwd 82859
Time taken by simulation: 45 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 12136.97624206543 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2009207
Min send: 10000000, max send 0
Min long send: 541803, max long send 557166
Min fwd: 17296, max fwd 25575; min bwd 48866, max bwd 52899
Min long fwd: 8632, max long fwd 14339; min long bwd 27298, max long bwd 31270
Time taken by simulation: 170 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 13 0 5941.788673400879 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7626781
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 21579, max bwd 43006
Min long fwd: 1397, max long fwd 9139; min long bwd 11398, max long bwd 19649
Time taken by simulation: 417 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 2442.7969455718994 929913.8118823369
End of simulation:  Mini-batch time (usec) = 10570352
Min send: 10000000, max send 0
Min long send: 929995, max long send 956013
Min fwd: 4298, max fwd 15893; min bwd 12064, max bwd 32201
Min long fwd: 434, max long fwd 5410; min long bwd 7050, max long bwd 15280
Time taken by simulation: 716 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2386 microseconds

{1: 1.413911, 2: 2.009207, 3: 7.626781, 4: 10.570352, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.009207
8 per stage
16 servers!
Config:
ranks: range(1, 2)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 8
stage to rank map: 0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15;
World size is 16
/opt/conda/envs/varuna/bin/python -u main.py --rank=1 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14;1,3,5,7,9,11,13,15; --batch-size=256 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 32
=> creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.8039274215698242
SHARED WEIGHTS ARE
None
this rank  1 is part of pipeline replica  0
8 chunks
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-30 14:02:39.025009] Finished iteration 33, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9856.159
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-11-30 14:02:41.469430] Finished iteration 34, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2444.168
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-11-30 14:02:44.047682] Finished iteration 35, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 2578.244
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 1 signal handler called with signal 10
Opt ckpt time 4.367691516876221
Process done with return code 0
Parent process ID: 17094 node: 172.31.20.223
12 cutpoints
Stages 1
Micro-bs 32 Max mem: 8350516326.4
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 469314.3005371094 0
End of simulation:  Mini-batch time (usec) = 1031482
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 31455, max long fwd 34870; min long bwd 76739, max long bwd 82859
Time taken by simulation: 48 microseconds

Stages 2
Micro-bs 32 Max mem: 5185528320.0
Predicted microbatch size for 2: 32
comm size 12845056
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 10 0 14465.604782104492 541471.8854995001
End of simulation:  Mini-batch time (usec) = 2417640
Min send: 10000000, max send 0
Min long send: 541659, max long send 557502
Min fwd: 17296, max fwd 25575; min bwd 47081, max bwd 56289
Min long fwd: 10095, max long fwd 15512; min long bwd 26495, max long bwd 30607
Time taken by simulation: 199 microseconds

Stages 3
Micro-bs 32 Max mem: 4313669017.6
Predicted microbatch size for 3: 32
comm size 25690112
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 13 0 5941.788673400879 929913.8118823369
End of simulation:  Mini-batch time (usec) = 7626781
Min send: 10000000, max send 0
Min long send: 930245, max long send 952379
Min fwd: 8603, max fwd 19440; min bwd 21579, max bwd 43006
Min long fwd: 1397, max long fwd 9139; min long bwd 11398, max long bwd 19649
Time taken by simulation: 417 microseconds

Stages 4
Micro-bs 32 Max mem: 3762429747.2
Predicted microbatch size for 4: 32
comm size 25690112
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 22 0 1736.614465713501 929913.8118823369
End of simulation:  Mini-batch time (usec) = 13349003
Min send: 10000000, max send 0
Min long send: 929995, max long send 952379
Min fwd: 3254, max fwd 16685; min bwd 13456, max bwd 30930
Min long fwd: 65, max long fwd 8369; min long bwd 8615, max long bwd 14208
Time taken by simulation: 994 microseconds

Stages 6
Micro-bs 32 Max mem: 3200148889.6
Predicted microbatch size for 6: 32
comm size 12845056
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 32 0 726.5806198120117 541471.8854995001
End of simulation:  Mini-batch time (usec) = 12814276
Min send: 10000000, max send 0
Min long send: 541471, max long send 569692
Min fwd: 100, max fwd 12458; min bwd 5055, max bwd 25528
Min long fwd: 242, max long fwd 4365; min long bwd 988, max long bwd 7376
Time taken by simulation: 2365 microseconds

{1: 1.031482, 2: 2.41764, 3: 7.626781, 4: 13.349003, 6: 12.814276}
{1: 32, 2: 32, 3: 32, 4: 32, 6: 32}
best config is: 2 32
expected time is 2.41764
7 per stage
14 servers!
Config:
ranks: range(1, 2)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 7
stage to rank map: 0,2,4,6,8,10,12;1,3,5,7,9,11,13;
World size is 14
/opt/conda/envs/varuna/bin/python -u main.py --rank=1 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12;1,3,5,7,9,11,13; --batch-size=288 data -a vgg19 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/vgg19 --resume_step 35
=> creating model 'vgg19'
[2, 4, 6, 8, 10, 12, 14, 16, 18, 21, 24]
Files already downloaded and verified
Num cutpoints is 11
dry run time 0.866579532623291
SHARED WEIGHTS ARE
None
this rank  1 is part of pipeline replica  0
9 chunks
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-30 14:04:17.279256] Finished iteration 36, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9019.758
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-11-30 14:04:19.781415] Finished iteration 37, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2501.976
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-11-30 14:04:22.339312] Finished iteration 38, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2557.863
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-11-30 14:04:24.841572] Finished iteration 39, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2502.223
1 Overflow !!
1 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-11-30 14:04:08.256327] Epoch: [0][ 40/174]	Time  2.492 ( 3.613)	Data  1.011 ( 0.959)	Loss 4.6957e+00 (4.7047e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-11-30 14:04:27.359485] Finished iteration 40, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2517.875
[2022-11-30 14:04:28.843688] Finished iteration 41, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1484.089
[2022-11-30 14:04:30.294357] Finished iteration 42, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1450.684
[2022-11-30 14:04:31.832001] Finished iteration 43, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1537.590
[2022-11-30 14:04:33.382286] Finished iteration 44, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1550.204
[2022-11-30 14:04:34.852872] Finished iteration 45, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1470.526
[2022-11-30 14:04:36.390034] Finished iteration 46, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1537.126
[2022-11-30 14:04:37.896175] Finished iteration 47, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1506.104
[2022-11-30 14:04:39.403428] Finished iteration 48, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1507.215
[2022-11-30 14:04:40.895999] Finished iteration 49, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1492.534
[2022-11-30 14:04:08.256327] Epoch: [0][ 50/174]	Time  1.511 ( 2.276)	Data  0.004 ( 0.392)	Loss 4.6484e+00 (4.6812e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-11-30 14:04:42.406179] Finished iteration 50, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1510.134
[2022-11-30 14:04:43.896655] Finished iteration 51, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1490.453
[2022-11-30 14:04:45.379259] Finished iteration 52, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1482.561
[2022-11-30 14:04:46.890391] Finished iteration 53, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1511.134
[2022-11-30 14:04:48.429615] Finished iteration 54, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1539.144
[2022-11-30 14:04:49.936997] Finished iteration 55, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1507.349
[2022-11-30 14:04:51.415033] Finished iteration 56, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1477.990
[2022-11-30 14:04:52.896865] Finished iteration 57, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1481.821
