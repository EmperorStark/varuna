Parent process ID: 53154 node: 172.31.28.108
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 1286522.0947265625 0
End of simulation:  Mini-batch time (usec) = 2905085
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 126283, max long fwd 129698; min long bwd 193190, max long bwd 199310
Time taken by simulation: 57 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 5 0 635506.6528320312 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3634860
Min send: 10000000, max send 0
Min long send: 542586, max long send 558986
Min fwd: 106816, max fwd 113936; min bwd 154625, max bwd 157669
Min long fwd: 134083, max long fwd 138081; min long bwd 169664, max long bwd 173713
Time taken by simulation: 112 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 5 0 443515.80810546875 663682.2411979454
End of simulation:  Mini-batch time (usec) = 4988556
Min send: 10000000, max send 0
Min long send: 664014, max long send 679713
Min fwd: 72258, max fwd 88035; min bwd 119079, max bwd 130804
Min long fwd: 107414, max long fwd 112703; min long bwd 150032, max long bwd 153679
Time taken by simulation: 194 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 8 0 326449.15771484375 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6677364
Min send: 10000000, max send 0
Min long send: 663870, max long send 686148
Min fwd: 51765, max fwd 66948; min bwd 85303, max bwd 98547
Min long fwd: 83336, max long fwd 91250; min long bwd 118529, max long bwd 127083
Time taken by simulation: 429 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 11 0 240705.6121826172 663682.2411979454
End of simulation:  Mini-batch time (usec) = 9735715
Min send: 10000000, max send 0
Min long send: 663764, max long send 689782
Min fwd: 32942, max fwd 48168; min bwd 55337, max bwd 68897
Min long fwd: 65982, max long fwd 73316; min long bwd 85277, max long bwd 90311
Time taken by simulation: 942 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 15 0 176039.7491455078 663682.2411979454
End of simulation:  Mini-batch time (usec) = 13724566
Min send: 10000000, max send 0
Min long send: 663736, max long send 690844
Min fwd: 22801, max fwd 38139; min bwd 36151, max bwd 55503
Min long fwd: 51106, max long fwd 59884; min long bwd 68124, max long bwd 75476
Time taken by simulation: 1655 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 22 0 97192.52014160156 663682.2411979454
End of simulation:  Mini-batch time (usec) = 21189724
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 10724, max fwd 28920; min bwd 23319, max bwd 41964
Min long fwd: 40826, max long fwd 50474; min long bwd 49192, max long bwd 58811
Time taken by simulation: 3528 microseconds

{1: 2.905085, 2: 3.63486, 3: 4.988556, 4: 6.677364, 6: 9.735715, 8: 13.724566, 12: 21.189724}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.63486
13 per stage
26 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 13
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24;1,3,5,7,9,11,13,15,17,19,21,23,25;
World size is 26
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24;1,3,5,7,9,11,13,15,17,19,21,23,25; --batch-size=78 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 13:52:55.733995 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=78, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=False, resume_step=-1, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20,22,24;1,3,5,7,9,11,13,15,17,19,21,23,25;', chunk_size=19, batch_size=78, rank=0, profiling=False, n_gpu=1)"] 
dry run time 0.1459035873413086
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
5 chunks
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
DLL 2022-11-24 13:53:05.476684 - PARAMETER SEED : 12439 
DLL 2022-11-24 13:53:05.476834 - PARAMETER train_start : True 
DLL 2022-11-24 13:53:05.476887 - PARAMETER batch_size_per_gpu : 78 
DLL 2022-11-24 13:53:05.476940 - PARAMETER learning_rate : 0.006 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-24 13:53:10.903666] Finished iteration 0, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5379.896
DLL 2022-11-24 13:53:10.915939 - Training Epoch: 0 Training Iteration: 1  average_loss : 11.293750762939453  step_loss : 11.293750762939453  learning_rate : 2.9986455118223097e-06 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-11-24 13:53:13.225645] Finished iteration 1, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2321.605
DLL 2022-11-24 13:53:13.230693 - Training Epoch: 0 Training Iteration: 2  average_loss : nan  step_loss : nan  learning_rate : 5.9972910236446195e-06 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-11-24 13:53:16.601730] Finished iteration 2, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3376.096
DLL 2022-11-24 13:53:16.607376 - Training Epoch: 0 Training Iteration: 3  average_loss : nan  step_loss : nan  learning_rate : 8.995936535466931e-06 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-11-24 13:53:18.980675] Finished iteration 3, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2378.891
DLL 2022-11-24 13:53:18.985523 - Training Epoch: 0 Training Iteration: 4  average_loss : nan  step_loss : nan  learning_rate : 1.1994582047289239e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-11-24 13:53:22.304070] Finished iteration 4, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3323.378
DLL 2022-11-24 13:53:22.309424 - Training Epoch: 0 Training Iteration: 5  average_loss : nan  step_loss : nan  learning_rate : 1.499322755911155e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-11-24 13:53:24.664778] Finished iteration 5, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2360.648
DLL 2022-11-24 13:53:24.669842 - Training Epoch: 0 Training Iteration: 6  average_loss : nan  step_loss : nan  learning_rate : 1.7991873070933862e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
[2022-11-24 13:53:26.924270] Finished iteration 6, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2259.479
DLL 2022-11-24 13:53:26.929407 - Training Epoch: 0 Training Iteration: 7  average_loss : nan  step_loss : nan  learning_rate : 2.099051858275617e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
[2022-11-24 13:53:29.273725] Finished iteration 7, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2349.427
DLL 2022-11-24 13:53:29.279452 - Training Epoch: 0 Training Iteration: 8  average_loss : nan  step_loss : nan  learning_rate : 2.3989164094578478e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
[2022-11-24 13:53:31.593321] Finished iteration 8, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2319.513
DLL 2022-11-24 13:53:31.598337 - Training Epoch: 0 Training Iteration: 9  average_loss : nan  step_loss : nan  learning_rate : 2.698780960640079e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
[2022-11-24 13:53:33.926769] Finished iteration 9, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2333.418
DLL 2022-11-24 13:53:33.931739 - Training Epoch: 0 Training Iteration: 10  average_loss : nan  step_loss : nan  learning_rate : 2.99864551182231e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
[2022-11-24 13:53:36.244944] Finished iteration 10, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2318.150
DLL 2022-11-24 13:53:36.250237 - Training Epoch: 0 Training Iteration: 11  average_loss : nan  step_loss : nan  learning_rate : 3.298510063004541e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
[2022-11-24 13:53:38.521454] Finished iteration 11, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2276.515
DLL 2022-11-24 13:53:38.526471 - Training Epoch: 0 Training Iteration: 12  average_loss : nan  step_loss : nan  learning_rate : 3.5983746141867724e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
[2022-11-24 13:53:40.860905] Finished iteration 12, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2339.389
DLL 2022-11-24 13:53:40.865941 - Training Epoch: 0 Training Iteration: 13  average_loss : nan  step_loss : nan  learning_rate : 3.898239165369003e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
[2022-11-24 13:53:43.160490] Finished iteration 13, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2299.547
DLL 2022-11-24 13:53:43.165773 - Training Epoch: 0 Training Iteration: 14  average_loss : nan  step_loss : nan  learning_rate : 4.198103716551234e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
[2022-11-24 13:53:45.442819] Finished iteration 14, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2282.293
DLL 2022-11-24 13:53:45.448014 - Training Epoch: 0 Training Iteration: 15  average_loss : nan  step_loss : nan  learning_rate : 4.497968267733465e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
[2022-11-24 13:53:47.775182] Finished iteration 15, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2332.338
DLL 2022-11-24 13:53:47.780150 - Training Epoch: 0 Training Iteration: 16  average_loss : nan  step_loss : nan  learning_rate : 4.7978328189156956e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
[2022-11-24 13:53:50.043940] Finished iteration 16, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2268.724
DLL 2022-11-24 13:53:50.049067 - Training Epoch: 0 Training Iteration: 17  average_loss : nan  step_loss : nan  learning_rate : 5.097697370097927e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
[2022-11-24 13:53:52.348398] Finished iteration 17, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2304.471
DLL 2022-11-24 13:53:52.353496 - Training Epoch: 0 Training Iteration: 18  average_loss : nan  step_loss : nan  learning_rate : 5.397561921280158e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
[2022-11-24 13:53:54.689201] Finished iteration 18, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2340.822
DLL 2022-11-24 13:53:54.697480 - Training Epoch: 0 Training Iteration: 19  average_loss : nan  step_loss : nan  learning_rate : 5.697426472462389e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:53:56.994448] Finished iteration 19, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2305.100
DLL 2022-11-24 13:53:56.999421 - Training Epoch: 0 Training Iteration: 20  average_loss : nan  step_loss : nan  learning_rate : 5.99729102364462e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:53:59.271231] Finished iteration 20, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2276.771
DLL 2022-11-24 13:53:59.313949 - Training Epoch: 0 Training Iteration: 21  average_loss : nan  step_loss : nan  learning_rate : 6.297155574826851e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:01.597654] Finished iteration 21, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2326.401
DLL 2022-11-24 13:54:01.602820 - Training Epoch: 0 Training Iteration: 22  average_loss : nan  step_loss : nan  learning_rate : 6.597020126009082e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:03.910066] Finished iteration 22, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2312.351
DLL 2022-11-24 13:54:03.914949 - Training Epoch: 0 Training Iteration: 23  average_loss : nan  step_loss : nan  learning_rate : 6.896884677191313e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:06.192173] Finished iteration 23, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2282.196
DLL 2022-11-24 13:54:06.197209 - Training Epoch: 0 Training Iteration: 24  average_loss : nan  step_loss : nan  learning_rate : 7.196749228373545e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:08.479887] Finished iteration 24, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2287.570
DLL 2022-11-24 13:54:08.484843 - Training Epoch: 0 Training Iteration: 25  average_loss : nan  step_loss : nan  learning_rate : 7.496613779555775e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:10.770932] Finished iteration 25, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2291.010
DLL 2022-11-24 13:54:10.775903 - Training Epoch: 0 Training Iteration: 26  average_loss : nan  step_loss : nan  learning_rate : 7.796478330738006e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:13.097086] Finished iteration 26, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2326.122
DLL 2022-11-24 13:54:13.102212 - Training Epoch: 0 Training Iteration: 27  average_loss : nan  step_loss : nan  learning_rate : 8.096342881920237e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:15.414581] Finished iteration 27, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2317.477
DLL 2022-11-24 13:54:15.419684 - Training Epoch: 0 Training Iteration: 28  average_loss : nan  step_loss : nan  learning_rate : 8.396207433102469e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:17.756322] Finished iteration 28, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2341.751
DLL 2022-11-24 13:54:17.761300 - Training Epoch: 0 Training Iteration: 29  average_loss : nan  step_loss : nan  learning_rate : 8.696071984284699e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:20.933868] Finished iteration 29, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3177.456
DLL 2022-11-24 13:54:20.938722 - Training Epoch: 0 Training Iteration: 30  average_loss : nan  step_loss : nan  learning_rate : 8.99593653546693e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:23.191797] Finished iteration 30, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2257.919
DLL 2022-11-24 13:54:23.196947 - Training Epoch: 0 Training Iteration: 31  average_loss : nan  step_loss : nan  learning_rate : 9.29580108664916e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:25.534648] Finished iteration 31, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2342.831
DLL 2022-11-24 13:54:25.540143 - Training Epoch: 0 Training Iteration: 32  average_loss : nan  step_loss : nan  learning_rate : 9.595665637831391e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:27.805924] Finished iteration 32, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2271.235
DLL 2022-11-24 13:54:27.810912 - Training Epoch: 0 Training Iteration: 33  average_loss : nan  step_loss : nan  learning_rate : 9.895530189013622e-05 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:30.119402] Finished iteration 33, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2313.444
DLL 2022-11-24 13:54:30.124880 - Training Epoch: 0 Training Iteration: 34  average_loss : nan  step_loss : nan  learning_rate : 0.00010195394740195854 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:32.457693] Finished iteration 34, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2338.295
DLL 2022-11-24 13:54:32.464753 - Training Epoch: 0 Training Iteration: 35  average_loss : nan  step_loss : nan  learning_rate : 0.00010495259291378085 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:34.753137] Finished iteration 35, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2295.371
DLL 2022-11-24 13:54:34.758370 - Training Epoch: 0 Training Iteration: 36  average_loss : nan  step_loss : nan  learning_rate : 0.00010795123842560316 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:37.085502] Finished iteration 36, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2332.343
DLL 2022-11-24 13:54:37.090330 - Training Epoch: 0 Training Iteration: 37  average_loss : nan  step_loss : nan  learning_rate : 0.00011094988393742548 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:39.413580] Finished iteration 37, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2328.061
DLL 2022-11-24 13:54:39.418698 - Training Epoch: 0 Training Iteration: 38  average_loss : nan  step_loss : nan  learning_rate : 0.00011394852944924778 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:41.741622] Finished iteration 38, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2327.996
DLL 2022-11-24 13:54:41.747008 - Training Epoch: 0 Training Iteration: 39  average_loss : nan  step_loss : nan  learning_rate : 0.00011694717496107008 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:44.088301] Finished iteration 39, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2346.677
DLL 2022-11-24 13:54:44.093699 - Training Epoch: 0 Training Iteration: 40  average_loss : nan  step_loss : nan  learning_rate : 0.0001199458204728924 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:46.425198] Finished iteration 40, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2336.839
DLL 2022-11-24 13:54:46.430490 - Training Epoch: 0 Training Iteration: 41  average_loss : nan  step_loss : nan  learning_rate : 0.0001229444659847147 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:48.708026] Finished iteration 41, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2282.855
DLL 2022-11-24 13:54:48.713423 - Training Epoch: 0 Training Iteration: 42  average_loss : nan  step_loss : nan  learning_rate : 0.00012594311149653702 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:51.034356] Finished iteration 42, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2326.241
DLL 2022-11-24 13:54:51.039579 - Training Epoch: 0 Training Iteration: 43  average_loss : nan  step_loss : nan  learning_rate : 0.00012894175700835933 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:53.399821] Finished iteration 43, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2365.454
DLL 2022-11-24 13:54:53.405009 - Training Epoch: 0 Training Iteration: 44  average_loss : nan  step_loss : nan  learning_rate : 0.00013194040252018164 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:55.734007] Finished iteration 44, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2334.119
DLL 2022-11-24 13:54:55.738976 - Training Epoch: 0 Training Iteration: 45  average_loss : nan  step_loss : nan  learning_rate : 0.00013493904803200396 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:54:58.076551] Finished iteration 45, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2342.530
DLL 2022-11-24 13:54:58.081519 - Training Epoch: 0 Training Iteration: 46  average_loss : nan  step_loss : nan  learning_rate : 0.00013793769354382627 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:00.404250] Finished iteration 46, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2327.710
DLL 2022-11-24 13:55:00.409388 - Training Epoch: 0 Training Iteration: 47  average_loss : nan  step_loss : nan  learning_rate : 0.00014093633905564855 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:02.714012] Finished iteration 47, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2309.688
DLL 2022-11-24 13:55:02.718895 - Training Epoch: 0 Training Iteration: 48  average_loss : nan  step_loss : nan  learning_rate : 0.0001439349845674709 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:04.978832] Finished iteration 48, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2264.810
DLL 2022-11-24 13:55:04.983969 - Training Epoch: 0 Training Iteration: 49  average_loss : nan  step_loss : nan  learning_rate : 0.00014693363007929318 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:07.343740] Finished iteration 49, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2364.881
DLL 2022-11-24 13:55:07.348713 - Training Epoch: 0 Training Iteration: 50  average_loss : nan  step_loss : nan  learning_rate : 0.0001499322755911155 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:09.647571] Finished iteration 50, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2303.860
DLL 2022-11-24 13:55:09.652793 - Training Epoch: 0 Training Iteration: 51  average_loss : nan  step_loss : nan  learning_rate : 0.0001529309211029378 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:11.988567] Finished iteration 51, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2340.924
DLL 2022-11-24 13:55:11.993620 - Training Epoch: 0 Training Iteration: 52  average_loss : nan  step_loss : nan  learning_rate : 0.00015592956661476012 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:14.278973] Finished iteration 52, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2290.432
DLL 2022-11-24 13:55:14.286423 - Training Epoch: 0 Training Iteration: 53  average_loss : nan  step_loss : nan  learning_rate : 0.0001589282121265824 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:16.597598] Finished iteration 53, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2318.490
DLL 2022-11-24 13:55:16.602604 - Training Epoch: 0 Training Iteration: 54  average_loss : nan  step_loss : nan  learning_rate : 0.00016192685763840475 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:18.897718] Finished iteration 54, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2300.107
DLL 2022-11-24 13:55:18.902687 - Training Epoch: 0 Training Iteration: 55  average_loss : nan  step_loss : nan  learning_rate : 0.00016492550315022706 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:21.187091] Finished iteration 55, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2289.324
DLL 2022-11-24 13:55:21.192192 - Training Epoch: 0 Training Iteration: 56  average_loss : nan  step_loss : nan  learning_rate : 0.00016792414866204937 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:23.502285] Finished iteration 56, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2315.239
DLL 2022-11-24 13:55:23.507650 - Training Epoch: 0 Training Iteration: 57  average_loss : nan  step_loss : nan  learning_rate : 0.00017092279417387166 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:25.827529] Finished iteration 57, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2325.137
DLL 2022-11-24 13:55:25.832664 - Training Epoch: 0 Training Iteration: 58  average_loss : nan  step_loss : nan  learning_rate : 0.00017392143968569397 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:28.186014] Finished iteration 58, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2358.458
DLL 2022-11-24 13:55:28.191065 - Training Epoch: 0 Training Iteration: 59  average_loss : nan  step_loss : nan  learning_rate : 0.0001769200851975163 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:30.531888] Finished iteration 59, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2345.833
DLL 2022-11-24 13:55:30.536942 - Training Epoch: 0 Training Iteration: 60  average_loss : nan  step_loss : nan  learning_rate : 0.0001799187307093386 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:32.829643] Finished iteration 60, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2297.820
DLL 2022-11-24 13:55:32.834823 - Training Epoch: 0 Training Iteration: 61  average_loss : nan  step_loss : nan  learning_rate : 0.00018291737622116094 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:35.139331] Finished iteration 61, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2309.609
DLL 2022-11-24 13:55:35.144488 - Training Epoch: 0 Training Iteration: 62  average_loss : nan  step_loss : nan  learning_rate : 0.0001859160217329832 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:37.439925] Finished iteration 62, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2300.558
DLL 2022-11-24 13:55:37.445394 - Training Epoch: 0 Training Iteration: 63  average_loss : nan  step_loss : nan  learning_rate : 0.00018891466724480554 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:39.787457] Finished iteration 63, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2347.475
DLL 2022-11-24 13:55:39.792525 - Training Epoch: 0 Training Iteration: 64  average_loss : nan  step_loss : nan  learning_rate : 0.00019191331275662782 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:42.119957] Finished iteration 64, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2332.466
DLL 2022-11-24 13:55:42.125038 - Training Epoch: 0 Training Iteration: 65  average_loss : nan  step_loss : nan  learning_rate : 0.00019491195826845016 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:44.418122] Finished iteration 65, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2298.179
DLL 2022-11-24 13:55:44.423517 - Training Epoch: 0 Training Iteration: 66  average_loss : nan  step_loss : nan  learning_rate : 0.00019791060378027245 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:46.770696] Finished iteration 66, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2352.506
DLL 2022-11-24 13:55:46.775751 - Training Epoch: 0 Training Iteration: 67  average_loss : nan  step_loss : nan  learning_rate : 0.00020090924929209476 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:49.190949] Finished iteration 67, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2420.213
DLL 2022-11-24 13:55:49.196127 - Training Epoch: 0 Training Iteration: 68  average_loss : nan  step_loss : nan  learning_rate : 0.00020390789480391708 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:51.490676] Finished iteration 68, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2299.703
DLL 2022-11-24 13:55:51.495910 - Training Epoch: 0 Training Iteration: 69  average_loss : nan  step_loss : nan  learning_rate : 0.0002069065403157394 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:53.849748] Finished iteration 69, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2359.026
DLL 2022-11-24 13:55:53.854679 - Training Epoch: 0 Training Iteration: 70  average_loss : nan  step_loss : nan  learning_rate : 0.0002099051858275617 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:56.180944] Finished iteration 70, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2331.178
DLL 2022-11-24 13:55:56.186107 - Training Epoch: 0 Training Iteration: 71  average_loss : nan  step_loss : nan  learning_rate : 0.00021290383133938402 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:55:58.514680] Finished iteration 71, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2333.706
DLL 2022-11-24 13:55:58.520115 - Training Epoch: 0 Training Iteration: 72  average_loss : nan  step_loss : nan  learning_rate : 0.00021590247685120633 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:00.835568] Finished iteration 72, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2320.868
DLL 2022-11-24 13:56:00.840750 - Training Epoch: 0 Training Iteration: 73  average_loss : nan  step_loss : nan  learning_rate : 0.00021890112236302861 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:03.146801] Finished iteration 73, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2311.179
DLL 2022-11-24 13:56:03.151855 - Training Epoch: 0 Training Iteration: 74  average_loss : nan  step_loss : nan  learning_rate : 0.00022189976787485096 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:05.453793] Finished iteration 74, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2306.955
DLL 2022-11-24 13:56:05.458685 - Training Epoch: 0 Training Iteration: 75  average_loss : nan  step_loss : nan  learning_rate : 0.00022489841338667327 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:07.713252] Finished iteration 75, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2259.434
DLL 2022-11-24 13:56:07.718188 - Training Epoch: 0 Training Iteration: 76  average_loss : nan  step_loss : nan  learning_rate : 0.00022789705889849555 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:10.014230] Finished iteration 76, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2300.950
DLL 2022-11-24 13:56:10.019570 - Training Epoch: 0 Training Iteration: 77  average_loss : nan  step_loss : nan  learning_rate : 0.00023089570441031787 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:12.350170] Finished iteration 77, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2335.916
DLL 2022-11-24 13:56:12.355189 - Training Epoch: 0 Training Iteration: 78  average_loss : nan  step_loss : nan  learning_rate : 0.00023389434992214015 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:14.715802] Finished iteration 78, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2365.625
DLL 2022-11-24 13:56:14.721073 - Training Epoch: 0 Training Iteration: 79  average_loss : nan  step_loss : nan  learning_rate : 0.00023689299543396247 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:17.015055] Finished iteration 79, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2299.174
DLL 2022-11-24 13:56:17.020075 - Training Epoch: 0 Training Iteration: 80  average_loss : nan  step_loss : nan  learning_rate : 0.0002398916409457848 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:19.353944] Finished iteration 80, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2338.884
DLL 2022-11-24 13:56:19.359410 - Training Epoch: 0 Training Iteration: 81  average_loss : nan  step_loss : nan  learning_rate : 0.00024289028645760712 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:21.654454] Finished iteration 81, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2300.512
DLL 2022-11-24 13:56:21.661307 - Training Epoch: 0 Training Iteration: 82  average_loss : nan  step_loss : nan  learning_rate : 0.0002458889319694294 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:23.922718] Finished iteration 82, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2268.191
DLL 2022-11-24 13:56:23.927832 - Training Epoch: 0 Training Iteration: 83  average_loss : nan  step_loss : nan  learning_rate : 0.0002488875774812517 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:26.185282] Finished iteration 83, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2262.538
DLL 2022-11-24 13:56:26.190472 - Training Epoch: 0 Training Iteration: 84  average_loss : nan  step_loss : nan  learning_rate : 0.00025188622299307403 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:28.490565] Finished iteration 84, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2305.273
DLL 2022-11-24 13:56:28.495707 - Training Epoch: 0 Training Iteration: 85  average_loss : nan  step_loss : nan  learning_rate : 0.00025488486850489635 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:30.774219] Finished iteration 85, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2283.604
DLL 2022-11-24 13:56:30.779295 - Training Epoch: 0 Training Iteration: 86  average_loss : nan  step_loss : nan  learning_rate : 0.00025788351401671866 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:33.082214] Finished iteration 86, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2308.022
DLL 2022-11-24 13:56:33.087512 - Training Epoch: 0 Training Iteration: 87  average_loss : nan  step_loss : nan  learning_rate : 0.00026088215952854097 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:35.317278] Finished iteration 87, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2234.974
DLL 2022-11-24 13:56:35.322548 - Training Epoch: 0 Training Iteration: 88  average_loss : nan  step_loss : nan  learning_rate : 0.0002638808050403633 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:37.613920] Finished iteration 88, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2296.698
DLL 2022-11-24 13:56:37.619397 - Training Epoch: 0 Training Iteration: 89  average_loss : nan  step_loss : nan  learning_rate : 0.0002668794505521856 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:40.012394] Finished iteration 89, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2398.602
DLL 2022-11-24 13:56:40.017779 - Training Epoch: 0 Training Iteration: 90  average_loss : nan  step_loss : nan  learning_rate : 0.0002698780960640079 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:42.286210] Finished iteration 90, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2273.552
DLL 2022-11-24 13:56:42.291199 - Training Epoch: 0 Training Iteration: 91  average_loss : nan  step_loss : nan  learning_rate : 0.00027287674157583017 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:44.563349] Finished iteration 91, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2277.088
DLL 2022-11-24 13:56:44.568397 - Training Epoch: 0 Training Iteration: 92  average_loss : nan  step_loss : nan  learning_rate : 0.00027587538708765254 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:46.892884] Finished iteration 92, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2329.506
DLL 2022-11-24 13:56:46.897756 - Training Epoch: 0 Training Iteration: 93  average_loss : nan  step_loss : nan  learning_rate : 0.00027887403259947485 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:49.209580] Finished iteration 93, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2316.667
DLL 2022-11-24 13:56:49.214323 - Training Epoch: 0 Training Iteration: 94  average_loss : nan  step_loss : nan  learning_rate : 0.0002818726781112971 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:51.537142] Finished iteration 94, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2327.523
DLL 2022-11-24 13:56:51.541985 - Training Epoch: 0 Training Iteration: 95  average_loss : nan  step_loss : nan  learning_rate : 0.0002848713236231194 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:53.828880] Finished iteration 95, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2291.724
DLL 2022-11-24 13:56:53.834282 - Training Epoch: 0 Training Iteration: 96  average_loss : nan  step_loss : nan  learning_rate : 0.0002878699691349418 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:56.156524] Finished iteration 96, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2327.602
DLL 2022-11-24 13:56:56.161396 - Training Epoch: 0 Training Iteration: 97  average_loss : nan  step_loss : nan  learning_rate : 0.00029086861464676405 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:56:58.424855] Finished iteration 97, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2268.310
DLL 2022-11-24 13:56:58.430330 - Training Epoch: 0 Training Iteration: 98  average_loss : nan  step_loss : nan  learning_rate : 0.00029386726015858636 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:00.731657] Finished iteration 98, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2306.818
DLL 2022-11-24 13:57:00.737004 - Training Epoch: 0 Training Iteration: 99  average_loss : nan  step_loss : nan  learning_rate : 0.0002968659056704087 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:03.058226] Finished iteration 99, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2326.477
DLL 2022-11-24 13:57:03.063120 - Training Epoch: 0 Training Iteration: 100  average_loss : nan  step_loss : nan  learning_rate : 0.000299864551182231 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:05.416840] Finished iteration 100, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2358.604
DLL 2022-11-24 13:57:05.422266 - Training Epoch: 0 Training Iteration: 101  average_loss : nan  step_loss : nan  learning_rate : 0.0003028631966940533 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:07.734166] Finished iteration 101, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2317.293
DLL 2022-11-24 13:57:07.739570 - Training Epoch: 0 Training Iteration: 102  average_loss : nan  step_loss : nan  learning_rate : 0.0003058618422058756 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:10.038991] Finished iteration 102, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2304.819
DLL 2022-11-24 13:57:10.044417 - Training Epoch: 0 Training Iteration: 103  average_loss : nan  step_loss : nan  learning_rate : 0.000308860487717698 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:12.336330] Finished iteration 103, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2297.305
DLL 2022-11-24 13:57:12.341453 - Training Epoch: 0 Training Iteration: 104  average_loss : nan  step_loss : nan  learning_rate : 0.00031185913322952024 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:14.651861] Finished iteration 104, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2315.465
DLL 2022-11-24 13:57:14.656980 - Training Epoch: 0 Training Iteration: 105  average_loss : nan  step_loss : nan  learning_rate : 0.0003148577787413425 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:16.986105] Finished iteration 105, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2334.223
DLL 2022-11-24 13:57:16.990975 - Training Epoch: 0 Training Iteration: 106  average_loss : nan  step_loss : nan  learning_rate : 0.0003178564242531648 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:19.273951] Finished iteration 106, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2287.815
DLL 2022-11-24 13:57:19.278991 - Training Epoch: 0 Training Iteration: 107  average_loss : nan  step_loss : nan  learning_rate : 0.0003208550697649872 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:21.529790] Finished iteration 107, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2255.816
DLL 2022-11-24 13:57:21.535245 - Training Epoch: 0 Training Iteration: 108  average_loss : nan  step_loss : nan  learning_rate : 0.0003238537152768095 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:23.814443] Finished iteration 108, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2284.642
DLL 2022-11-24 13:57:23.819527 - Training Epoch: 0 Training Iteration: 109  average_loss : nan  step_loss : nan  learning_rate : 0.0003268523607886318 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:26.106710] Finished iteration 109, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2292.292
DLL 2022-11-24 13:57:26.111753 - Training Epoch: 0 Training Iteration: 110  average_loss : nan  step_loss : nan  learning_rate : 0.0003298510063004541 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:28.392054] Finished iteration 110, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2285.238
DLL 2022-11-24 13:57:28.397345 - Training Epoch: 0 Training Iteration: 111  average_loss : nan  step_loss : nan  learning_rate : 0.00033284965181227643 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:30.654480] Finished iteration 111, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2262.447
DLL 2022-11-24 13:57:30.661718 - Training Epoch: 0 Training Iteration: 112  average_loss : nan  step_loss : nan  learning_rate : 0.00033584829732409875 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:32.997945] Finished iteration 112, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2343.361
DLL 2022-11-24 13:57:33.003078 - Training Epoch: 0 Training Iteration: 113  average_loss : nan  step_loss : nan  learning_rate : 0.000338846942835921 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:35.345063] Finished iteration 113, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2347.099
DLL 2022-11-24 13:57:35.350157 - Training Epoch: 0 Training Iteration: 114  average_loss : nan  step_loss : nan  learning_rate : 0.0003418455883477433 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:37.637078] Finished iteration 114, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2292.001
DLL 2022-11-24 13:57:37.642100 - Training Epoch: 0 Training Iteration: 115  average_loss : nan  step_loss : nan  learning_rate : 0.0003448442338595657 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:39.981450] Finished iteration 115, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2344.337
DLL 2022-11-24 13:57:39.986778 - Training Epoch: 0 Training Iteration: 116  average_loss : nan  step_loss : nan  learning_rate : 0.00034784287937138794 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:42.295393] Finished iteration 116, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2313.891
DLL 2022-11-24 13:57:42.300820 - Training Epoch: 0 Training Iteration: 117  average_loss : nan  step_loss : nan  learning_rate : 0.00035084152488321026 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:44.582355] Finished iteration 117, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2286.973
DLL 2022-11-24 13:57:44.587385 - Training Epoch: 0 Training Iteration: 118  average_loss : nan  step_loss : nan  learning_rate : 0.0003538401703950326 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:46.895545] Finished iteration 118, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2313.218
DLL 2022-11-24 13:57:46.900568 - Training Epoch: 0 Training Iteration: 119  average_loss : nan  step_loss : nan  learning_rate : 0.0003568388159068549 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:49.147213] Finished iteration 119, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2251.640
DLL 2022-11-24 13:57:49.152504 - Training Epoch: 0 Training Iteration: 120  average_loss : nan  step_loss : nan  learning_rate : 0.0003598374614186772 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:51.373357] Finished iteration 120, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2226.034
DLL 2022-11-24 13:57:51.378454 - Training Epoch: 0 Training Iteration: 121  average_loss : nan  step_loss : nan  learning_rate : 0.00036283610693049946 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:53.646525] Finished iteration 121, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2273.124
DLL 2022-11-24 13:57:53.651444 - Training Epoch: 0 Training Iteration: 122  average_loss : nan  step_loss : nan  learning_rate : 0.0003658347524423219 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:55.966507] Finished iteration 122, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2319.959
DLL 2022-11-24 13:57:55.971426 - Training Epoch: 0 Training Iteration: 123  average_loss : nan  step_loss : nan  learning_rate : 0.00036883339795414414 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:57:58.359964] Finished iteration 123, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2393.430
DLL 2022-11-24 13:57:58.365285 - Training Epoch: 0 Training Iteration: 124  average_loss : nan  step_loss : nan  learning_rate : 0.0003718320434659664 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:00.674493] Finished iteration 124, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2314.519
DLL 2022-11-24 13:58:00.679578 - Training Epoch: 0 Training Iteration: 125  average_loss : nan  step_loss : nan  learning_rate : 0.00037483068897778876 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:02.967581] Finished iteration 125, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2293.046
DLL 2022-11-24 13:58:02.974283 - Training Epoch: 0 Training Iteration: 126  average_loss : nan  step_loss : nan  learning_rate : 0.0003778293344896111 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:05.278452] Finished iteration 126, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2310.826
DLL 2022-11-24 13:58:05.283603 - Training Epoch: 0 Training Iteration: 127  average_loss : nan  step_loss : nan  learning_rate : 0.0003808279800014334 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:07.637308] Finished iteration 127, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2358.836
DLL 2022-11-24 13:58:07.642606 - Training Epoch: 0 Training Iteration: 128  average_loss : nan  step_loss : nan  learning_rate : 0.00038382662551325565 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:10.022103] Finished iteration 128, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2384.767
DLL 2022-11-24 13:58:10.027442 - Training Epoch: 0 Training Iteration: 129  average_loss : nan  step_loss : nan  learning_rate : 0.00038682527102507796 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:12.364059] Finished iteration 129, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2341.941
DLL 2022-11-24 13:58:12.369376 - Training Epoch: 0 Training Iteration: 130  average_loss : nan  step_loss : nan  learning_rate : 0.00038982391653690033 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:14.748257] Finished iteration 130, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2384.161
DLL 2022-11-24 13:58:14.753386 - Training Epoch: 0 Training Iteration: 131  average_loss : nan  step_loss : nan  learning_rate : 0.0003928225620487226 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:17.063953] Finished iteration 131, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2315.616
DLL 2022-11-24 13:58:17.069074 - Training Epoch: 0 Training Iteration: 132  average_loss : nan  step_loss : nan  learning_rate : 0.0003958212075605449 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:19.365542] Finished iteration 132, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2301.579
DLL 2022-11-24 13:58:19.372967 - Training Epoch: 0 Training Iteration: 133  average_loss : nan  step_loss : nan  learning_rate : 0.00039881985307236727 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:21.680645] Finished iteration 133, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2315.125
DLL 2022-11-24 13:58:21.686021 - Training Epoch: 0 Training Iteration: 134  average_loss : nan  step_loss : nan  learning_rate : 0.0004018184985841895 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:24.035503] Finished iteration 134, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2354.741
DLL 2022-11-24 13:58:24.040390 - Training Epoch: 0 Training Iteration: 135  average_loss : nan  step_loss : nan  learning_rate : 0.00040481714409601184 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:26.391335] Finished iteration 135, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2355.826
DLL 2022-11-24 13:58:26.396617 - Training Epoch: 0 Training Iteration: 136  average_loss : nan  step_loss : nan  learning_rate : 0.00040781578960783415 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:28.675073] Finished iteration 136, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2283.691
DLL 2022-11-24 13:58:28.680177 - Training Epoch: 0 Training Iteration: 137  average_loss : nan  step_loss : nan  learning_rate : 0.0004108144351196565 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:31.003247] Finished iteration 137, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2328.141
DLL 2022-11-24 13:58:31.008160 - Training Epoch: 0 Training Iteration: 138  average_loss : nan  step_loss : nan  learning_rate : 0.0004138130806314788 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:33.311283] Finished iteration 138, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2308.006
DLL 2022-11-24 13:58:33.316486 - Training Epoch: 0 Training Iteration: 139  average_loss : nan  step_loss : nan  learning_rate : 0.00041681172614330104 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:35.584668] Finished iteration 139, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2273.351
DLL 2022-11-24 13:58:35.591093 - Training Epoch: 0 Training Iteration: 140  average_loss : nan  step_loss : nan  learning_rate : 0.0004198103716551234 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:37.882832] Finished iteration 140, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2298.145
DLL 2022-11-24 13:58:37.888251 - Training Epoch: 0 Training Iteration: 141  average_loss : nan  step_loss : nan  learning_rate : 0.0004228090171669457 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:40.182560] Finished iteration 141, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2299.691
DLL 2022-11-24 13:58:40.191515 - Training Epoch: 0 Training Iteration: 142  average_loss : nan  step_loss : nan  learning_rate : 0.00042580766267876803 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:42.518553] Finished iteration 142, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2336.031
DLL 2022-11-24 13:58:42.523774 - Training Epoch: 0 Training Iteration: 143  average_loss : nan  step_loss : nan  learning_rate : 0.0004288063081905903 
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 0 signal handler called with signal 10
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 13:58:44.825061] Finished iteration 143, CKPT_AND_STOP: True, flag: tensor([1], dtype=torch.int32), speed: 2306.410
DLL 2022-11-24 13:58:44.831834 - Training Epoch: 0 Training Iteration: 144  average_loss : nan  step_loss : nan  learning_rate : 0.00043180495370241266 
2022-11-24 13:58:44.831999 Begin to save checkpont to s3://spot-checkpoints/bert and exit
DLL 2022-11-24 13:58:44.832027 - PARAMETER checkpoint_step : 144 
Opt ckpt time 9.068228244781494
Process done with return code 0
Parent process ID: 55335 node: 172.31.28.108
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 1286522.0947265625 0
End of simulation:  Mini-batch time (usec) = 2905085
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 126283, max long fwd 129698; min long bwd 193190, max long bwd 199310
Time taken by simulation: 48 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 645340.8203125 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3338780
Min send: 10000000, max send 0
Min long send: 542586, max long send 555338
Min fwd: 107744, max fwd 113936; min bwd 155753, max bwd 158782
Min long fwd: 131842, max long fwd 138676; min long bwd 169332, max long bwd 173300
Time taken by simulation: 103 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 5 0 443515.80810546875 663682.2411979454
End of simulation:  Mini-batch time (usec) = 4988556
Min send: 10000000, max send 0
Min long send: 664014, max long send 679713
Min fwd: 72258, max fwd 88035; min bwd 119079, max bwd 130804
Min long fwd: 107414, max long fwd 112703; min long bwd 150032, max long bwd 153679
Time taken by simulation: 192 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 7 0 358221.00830078125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6464795
Min send: 10000000, max send 0
Min long send: 663870, max long send 683729
Min fwd: 53924, max fwd 67812; min bwd 83975, max bwd 97299
Min long fwd: 86081, max long fwd 91318; min long bwd 118237, max long bwd 121834
Time taken by simulation: 320 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 11 0 240705.6121826172 663682.2411979454
End of simulation:  Mini-batch time (usec) = 9735715
Min send: 10000000, max send 0
Min long send: 663764, max long send 689782
Min fwd: 32942, max fwd 48168; min bwd 55337, max bwd 68897
Min long fwd: 65982, max long fwd 73316; min long bwd 85277, max long bwd 90311
Time taken by simulation: 764 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 15 0 176039.7491455078 663682.2411979454
End of simulation:  Mini-batch time (usec) = 13724566
Min send: 10000000, max send 0
Min long send: 663736, max long send 690844
Min fwd: 22801, max fwd 38139; min bwd 36151, max bwd 55503
Min long fwd: 51106, max long fwd 59884; min long bwd 68124, max long bwd 75476
Time taken by simulation: 1693 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 22 0 97192.52014160156 663682.2411979454
End of simulation:  Mini-batch time (usec) = 21189724
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 10724, max fwd 28920; min bwd 23319, max bwd 41964
Min long fwd: 40826, max long fwd 50474; min long bwd 49192, max long bwd 58811
Time taken by simulation: 3427 microseconds

{1: 2.905085, 2: 3.33878, 3: 4.988556, 4: 6.464795, 6: 9.735715, 8: 13.724566, 12: 21.189724}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.33878
14 per stage
28 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 14
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26;1,3,5,7,9,11,13,15,17,19,21,23,25,27;
World size is 28
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26;1,3,5,7,9,11,13,15,17,19,21,23,25,27; --batch-size=73 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 144
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 13:59:12.328590 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=73, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=True, resume_step=144, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20,22,24,26;1,3,5,7,9,11,13,15,17,19,21,23,25,27;', chunk_size=19, batch_size=73, rank=0, profiling=False, n_gpu=1)"] 
dry run time 0.005926609039306641
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
4 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_144.pt
2022-11-24 13:59:22.868792 resume step from  144
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 0 signal handler called with signal 10
2022-11-24 14:00:17.987285 - Finished loading checkpoint, takes 55.074 secs
DLL 2022-11-24 14:00:17.988369 - PARAMETER SEED : 12439 
DLL 2022-11-24 14:00:17.988524 - PARAMETER train_start : True 
DLL 2022-11-24 14:00:17.988609 - PARAMETER batch_size_per_gpu : 73 
DLL 2022-11-24 14:00:17.988694 - PARAMETER learning_rate : 0.006 
2022-11-24 14:00:31.372727 Begin to exit
Process done with return code 0
Parent process ID: 56951 node: 172.31.28.108
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 3150942.3828125 0
End of simulation:  Mini-batch time (usec) = 4450032
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 127414, max long fwd 129698; min long bwd 194806, max long bwd 199310
Time taken by simulation: 46 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 673273.3154296875 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3366713
Min send: 10000000, max send 0
Min long send: 542586, max long send 555338
Min fwd: 107744, max fwd 113936; min bwd 155753, max bwd 158782
Min long fwd: 131842, max long fwd 138676; min long bwd 169332, max long bwd 173300
Time taken by simulation: 95 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 5 0 448996.58203125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 4994037
Min send: 10000000, max send 0
Min long send: 664014, max long send 679713
Min fwd: 72258, max fwd 88035; min bwd 119079, max bwd 130804
Min long fwd: 107414, max long fwd 112703; min long bwd 150032, max long bwd 153679
Time taken by simulation: 172 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 6 0 375752.13623046875 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6314108
Min send: 10000000, max send 0
Min long send: 663764, max long send 688387
Min fwd: 53924, max fwd 66948; min bwd 83975, max bwd 98046
Min long fwd: 84759, max long fwd 91250; min long bwd 120659, max long bwd 125455
Time taken by simulation: 273 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 9 0 241996.6583251953 663682.2411979454
End of simulation:  Mini-batch time (usec) = 9164548
Min send: 10000000, max send 0
Min long send: 663736, max long send 687371
Min fwd: 33746, max fwd 47347; min bwd 54554, max bwd 72477
Min long fwd: 65864, max long fwd 73316; min long bwd 84274, max long bwd 89413
Time taken by simulation: 624 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 11 0 214379.08935546875 663682.2411979454
End of simulation:  Mini-batch time (usec) = 12421079
Min send: 10000000, max send 0
Min long send: 663682, max long send 689782
Min fwd: 22992, max fwd 37161; min bwd 37517, max bwd 55449
Min long fwd: 51419, max long fwd 57045; min long bwd 68935, max long bwd 77274
Time taken by simulation: 1110 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 22 0 97192.52014160156 663682.2411979454
End of simulation:  Mini-batch time (usec) = 21189724
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 10724, max fwd 28920; min bwd 23319, max bwd 41964
Min long fwd: 40826, max long fwd 50474; min long bwd 49192, max long bwd 58811
Time taken by simulation: 3827 microseconds

{1: 4.450032, 2: 3.366713, 3: 4.994037, 4: 6.314108, 6: 9.164548, 8: 12.421079, 12: 21.189724}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.366713
16 per stage
32 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 16
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31;
World size is 32
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31; --batch-size=64 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 144
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 14:00:42.317567 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=64, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=True, resume_step=144, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31;', chunk_size=19, batch_size=64, rank=0, profiling=False, n_gpu=1)"] 
dry run time 0.15545010566711426
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
4 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_144.pt
2022-11-24 14:00:52.836674 resume step from  144
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
2022-11-24 14:01:47.169564 - Finished loading checkpoint, takes 54.179 secs
DLL 2022-11-24 14:01:47.170487 - PARAMETER SEED : 12439 
DLL 2022-11-24 14:01:47.170616 - PARAMETER train_start : True 
DLL 2022-11-24 14:01:47.170679 - PARAMETER batch_size_per_gpu : 64 
DLL 2022-11-24 14:01:47.170717 - PARAMETER learning_rate : 0.006 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-24 14:02:26.488050] Finished iteration 144, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5711.776
DLL 2022-11-24 14:02:26.494775 - Training Epoch: 0 Training Iteration: 145  average_loss : nan  step_loss : nan  learning_rate : 0.00043480359921423497 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-11-24 14:02:29.715086] Finished iteration 145, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3226.719
DLL 2022-11-24 14:02:29.724513 - Training Epoch: 0 Training Iteration: 146  average_loss : nan  step_loss : nan  learning_rate : 0.00043780224472605723 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-11-24 14:02:32.847942] Finished iteration 146, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3132.802
DLL 2022-11-24 14:02:32.853303 - Training Epoch: 0 Training Iteration: 147  average_loss : nan  step_loss : nan  learning_rate : 0.0004408008902378796 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-11-24 14:02:35.990515] Finished iteration 147, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3142.562
DLL 2022-11-24 14:02:35.996010 - Training Epoch: 0 Training Iteration: 148  average_loss : nan  step_loss : nan  learning_rate : 0.0004437995357497019 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-11-24 14:02:39.100203] Finished iteration 148, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3109.701
DLL 2022-11-24 14:02:39.105702 - Training Epoch: 0 Training Iteration: 149  average_loss : nan  step_loss : nan  learning_rate : 0.0004467981812615243 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-11-24 14:02:41.199630] Finished iteration 149, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.309
DLL 2022-11-24 14:02:41.205409 - Training Epoch: 0 Training Iteration: 150  average_loss : nan  step_loss : nan  learning_rate : 0.00044979682677334654 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
[2022-11-24 14:02:43.335101] Finished iteration 150, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2135.459
DLL 2022-11-24 14:02:43.340611 - Training Epoch: 0 Training Iteration: 151  average_loss : nan  step_loss : nan  learning_rate : 0.0004527954722851688 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
[2022-11-24 14:02:45.388014] Finished iteration 151, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2052.868
DLL 2022-11-24 14:02:45.393230 - Training Epoch: 0 Training Iteration: 152  average_loss : nan  step_loss : nan  learning_rate : 0.0004557941177969911 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
[2022-11-24 14:02:47.489510] Finished iteration 152, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2101.459
DLL 2022-11-24 14:02:47.494573 - Training Epoch: 0 Training Iteration: 153  average_loss : nan  step_loss : nan  learning_rate : 0.00045879276330881337 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
[2022-11-24 14:02:49.607221] Finished iteration 153, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2117.682
DLL 2022-11-24 14:02:49.612895 - Training Epoch: 0 Training Iteration: 154  average_loss : nan  step_loss : nan  learning_rate : 0.00046179140882063573 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
[2022-11-24 14:02:51.707134] Finished iteration 154, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.947
DLL 2022-11-24 14:02:51.712683 - Training Epoch: 0 Training Iteration: 155  average_loss : nan  step_loss : nan  learning_rate : 0.00046479005433245805 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
[2022-11-24 14:02:53.785166] Finished iteration 155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2077.970
DLL 2022-11-24 14:02:53.790370 - Training Epoch: 0 Training Iteration: 156  average_loss : nan  step_loss : nan  learning_rate : 0.0004677886998442803 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
[2022-11-24 14:02:55.937801] Finished iteration 156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2152.581
DLL 2022-11-24 14:02:55.943478 - Training Epoch: 0 Training Iteration: 157  average_loss : nan  step_loss : nan  learning_rate : 0.0004707873453561027 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
[2022-11-24 14:02:58.042892] Finished iteration 157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2105.083
DLL 2022-11-24 14:02:58.048260 - Training Epoch: 0 Training Iteration: 158  average_loss : nan  step_loss : nan  learning_rate : 0.00047378599086792493 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
[2022-11-24 14:03:00.147040] Finished iteration 158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2104.105
DLL 2022-11-24 14:03:00.152962 - Training Epoch: 0 Training Iteration: 159  average_loss : nan  step_loss : nan  learning_rate : 0.0004767846363797473 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
[2022-11-24 14:03:02.261387] Finished iteration 159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.294
DLL 2022-11-24 14:03:02.267065 - Training Epoch: 0 Training Iteration: 160  average_loss : nan  step_loss : nan  learning_rate : 0.0004797832818915696 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
[2022-11-24 14:03:04.353587] Finished iteration 160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2092.179
DLL 2022-11-24 14:03:04.359243 - Training Epoch: 0 Training Iteration: 161  average_loss : nan  step_loss : nan  learning_rate : 0.00048278192740339187 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
[2022-11-24 14:03:06.506824] Finished iteration 161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2153.233
DLL 2022-11-24 14:03:06.512540 - Training Epoch: 0 Training Iteration: 162  average_loss : nan  step_loss : nan  learning_rate : 0.00048578057291521424 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
[2022-11-24 14:03:08.600879] Finished iteration 162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2094.066
DLL 2022-11-24 14:03:08.608684 - Training Epoch: 0 Training Iteration: 163  average_loss : nan  step_loss : nan  learning_rate : 0.0004887792184270365 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:11.887003] Finished iteration 163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3285.997
DLL 2022-11-24 14:03:11.892321 - Training Epoch: 0 Training Iteration: 164  average_loss : nan  step_loss : nan  learning_rate : 0.0004917778639388588 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:14.005183] Finished iteration 164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2118.240
DLL 2022-11-24 14:03:14.010769 - Training Epoch: 0 Training Iteration: 165  average_loss : nan  step_loss : nan  learning_rate : 0.0004947765094506812 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:16.133224] Finished iteration 165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2128.055
DLL 2022-11-24 14:03:16.139283 - Training Epoch: 0 Training Iteration: 166  average_loss : nan  step_loss : nan  learning_rate : 0.0004977751549625034 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:18.233883] Finished iteration 166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2100.501
DLL 2022-11-24 14:03:18.239562 - Training Epoch: 0 Training Iteration: 167  average_loss : nan  step_loss : nan  learning_rate : 0.0005007738004743258 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:20.375437] Finished iteration 167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2141.525
DLL 2022-11-24 14:03:20.381293 - Training Epoch: 0 Training Iteration: 168  average_loss : nan  step_loss : nan  learning_rate : 0.0005037724459861481 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:22.443024] Finished iteration 168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2067.586
DLL 2022-11-24 14:03:22.448196 - Training Epoch: 0 Training Iteration: 169  average_loss : nan  step_loss : nan  learning_rate : 0.0005067710914979704 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:24.589120] Finished iteration 169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2146.001
DLL 2022-11-24 14:03:24.594537 - Training Epoch: 0 Training Iteration: 170  average_loss : nan  step_loss : nan  learning_rate : 0.0005097697370097927 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:26.735430] Finished iteration 170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2146.281
DLL 2022-11-24 14:03:26.741170 - Training Epoch: 0 Training Iteration: 171  average_loss : nan  step_loss : nan  learning_rate : 0.0005127683825216149 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:28.897040] Finished iteration 171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2161.614
DLL 2022-11-24 14:03:28.902560 - Training Epoch: 0 Training Iteration: 172  average_loss : nan  step_loss : nan  learning_rate : 0.0005157670280334373 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:31.039723] Finished iteration 172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2142.638
DLL 2022-11-24 14:03:31.045214 - Training Epoch: 0 Training Iteration: 173  average_loss : nan  step_loss : nan  learning_rate : 0.0005187656735452596 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:33.200403] Finished iteration 173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2160.705
DLL 2022-11-24 14:03:33.206227 - Training Epoch: 0 Training Iteration: 174  average_loss : nan  step_loss : nan  learning_rate : 0.0005217643190570819 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:35.285023] Finished iteration 174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2084.578
DLL 2022-11-24 14:03:35.293345 - Training Epoch: 0 Training Iteration: 175  average_loss : nan  step_loss : nan  learning_rate : 0.0005247629645689043 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:37.400277] Finished iteration 175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2115.193
DLL 2022-11-24 14:03:37.406012 - Training Epoch: 0 Training Iteration: 176  average_loss : nan  step_loss : nan  learning_rate : 0.0005277616100807266 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:39.477234] Finished iteration 176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2076.935
DLL 2022-11-24 14:03:39.482847 - Training Epoch: 0 Training Iteration: 177  average_loss : nan  step_loss : nan  learning_rate : 0.0005307602555925489 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:41.591253] Finished iteration 177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2113.935
DLL 2022-11-24 14:03:41.596342 - Training Epoch: 0 Training Iteration: 178  average_loss : nan  step_loss : nan  learning_rate : 0.0005337589011043712 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:43.753348] Finished iteration 178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2162.080
DLL 2022-11-24 14:03:43.759265 - Training Epoch: 0 Training Iteration: 179  average_loss : nan  step_loss : nan  learning_rate : 0.0005367575466161935 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:45.953191] Finished iteration 179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2199.782
DLL 2022-11-24 14:03:45.958609 - Training Epoch: 0 Training Iteration: 180  average_loss : nan  step_loss : nan  learning_rate : 0.0005397561921280158 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:48.048690] Finished iteration 180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2095.474
DLL 2022-11-24 14:03:48.054536 - Training Epoch: 0 Training Iteration: 181  average_loss : nan  step_loss : nan  learning_rate : 0.0005427548376398381 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:50.178858] Finished iteration 181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2130.142
DLL 2022-11-24 14:03:50.184144 - Training Epoch: 0 Training Iteration: 182  average_loss : nan  step_loss : nan  learning_rate : 0.0005457534831516603 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:52.293437] Finished iteration 182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.591
DLL 2022-11-24 14:03:52.299096 - Training Epoch: 0 Training Iteration: 183  average_loss : nan  step_loss : nan  learning_rate : 0.0005487521286634827 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:54.409429] Finished iteration 183, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2115.919
DLL 2022-11-24 14:03:54.414523 - Training Epoch: 0 Training Iteration: 184  average_loss : nan  step_loss : nan  learning_rate : 0.0005517507741753051 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:56.555012] Finished iteration 184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2145.531
DLL 2022-11-24 14:03:56.560119 - Training Epoch: 0 Training Iteration: 185  average_loss : nan  step_loss : nan  learning_rate : 0.0005547494196871273 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:03:58.641962] Finished iteration 185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2086.993
DLL 2022-11-24 14:03:58.647271 - Training Epoch: 0 Training Iteration: 186  average_loss : nan  step_loss : nan  learning_rate : 0.0005577480651989497 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:00.754011] Finished iteration 186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2111.971
DLL 2022-11-24 14:04:00.759502 - Training Epoch: 0 Training Iteration: 187  average_loss : nan  step_loss : nan  learning_rate : 0.000560746710710772 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:02.902302] Finished iteration 187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2148.263
DLL 2022-11-24 14:04:02.907631 - Training Epoch: 0 Training Iteration: 188  average_loss : nan  step_loss : nan  learning_rate : 0.0005637453562225942 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:04.987047] Finished iteration 188, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2084.707
DLL 2022-11-24 14:04:04.992523 - Training Epoch: 0 Training Iteration: 189  average_loss : nan  step_loss : nan  learning_rate : 0.0005667440017344166 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:07.122128] Finished iteration 189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2135.056
DLL 2022-11-24 14:04:07.127797 - Training Epoch: 0 Training Iteration: 190  average_loss : nan  step_loss : nan  learning_rate : 0.0005697426472462388 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:09.249771] Finished iteration 190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2127.602
DLL 2022-11-24 14:04:09.255037 - Training Epoch: 0 Training Iteration: 191  average_loss : nan  step_loss : nan  learning_rate : 0.0005727412927580613 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:11.352029] Finished iteration 191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2102.304
DLL 2022-11-24 14:04:11.360516 - Training Epoch: 0 Training Iteration: 192  average_loss : nan  step_loss : nan  learning_rate : 0.0005757399382698836 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:13.485608] Finished iteration 192, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2133.459
DLL 2022-11-24 14:04:13.491276 - Training Epoch: 0 Training Iteration: 193  average_loss : nan  step_loss : nan  learning_rate : 0.0005787385837817058 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:15.596255] Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2110.657
DLL 2022-11-24 14:04:15.602051 - Training Epoch: 0 Training Iteration: 194  average_loss : nan  step_loss : nan  learning_rate : 0.0005817372292935281 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:17.696893] Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2100.649
DLL 2022-11-24 14:04:17.703435 - Training Epoch: 0 Training Iteration: 195  average_loss : nan  step_loss : nan  learning_rate : 0.0005847358748053504 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:19.826123] Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2129.117
DLL 2022-11-24 14:04:19.832068 - Training Epoch: 0 Training Iteration: 196  average_loss : nan  step_loss : nan  learning_rate : 0.0005877345203171727 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:21.954645] Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2128.472
DLL 2022-11-24 14:04:21.960068 - Training Epoch: 0 Training Iteration: 197  average_loss : nan  step_loss : nan  learning_rate : 0.000590733165828995 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:24.111526] Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2156.867
DLL 2022-11-24 14:04:24.117000 - Training Epoch: 0 Training Iteration: 198  average_loss : nan  step_loss : nan  learning_rate : 0.0005937318113408173 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:26.179810] Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2068.234
DLL 2022-11-24 14:04:26.185313 - Training Epoch: 0 Training Iteration: 199  average_loss : nan  step_loss : nan  learning_rate : 0.0005967304568526397 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:28.229833] Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2050.003
DLL 2022-11-24 14:04:28.235181 - Training Epoch: 0 Training Iteration: 200  average_loss : nan  step_loss : nan  learning_rate : 0.000599729102364462 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:30.355321] Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2125.559
DLL 2022-11-24 14:04:30.360976 - Training Epoch: 0 Training Iteration: 201  average_loss : nan  step_loss : nan  learning_rate : 0.0006027277478762843 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:32.470368] Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2115.012
DLL 2022-11-24 14:04:32.476181 - Training Epoch: 0 Training Iteration: 202  average_loss : nan  step_loss : nan  learning_rate : 0.0006057263933881066 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:34.590278] Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2119.885
DLL 2022-11-24 14:04:34.596075 - Training Epoch: 0 Training Iteration: 203  average_loss : nan  step_loss : nan  learning_rate : 0.0006087250388999289 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:36.704361] Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.057
DLL 2022-11-24 14:04:36.712268 - Training Epoch: 0 Training Iteration: 204  average_loss : nan  step_loss : nan  learning_rate : 0.0006117236844117512 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:38.816544] Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2112.042
DLL 2022-11-24 14:04:38.821990 - Training Epoch: 0 Training Iteration: 205  average_loss : nan  step_loss : nan  learning_rate : 0.0006147223299235735 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:41.274386] Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2457.829
DLL 2022-11-24 14:04:41.279396 - Training Epoch: 0 Training Iteration: 206  average_loss : nan  step_loss : nan  learning_rate : 0.000617720975435396 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:43.727135] Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2452.766
DLL 2022-11-24 14:04:43.732557 - Training Epoch: 0 Training Iteration: 207  average_loss : nan  step_loss : nan  learning_rate : 0.0006207196209472182 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:45.867355] Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2140.216
DLL 2022-11-24 14:04:45.875769 - Training Epoch: 0 Training Iteration: 208  average_loss : nan  step_loss : nan  learning_rate : 0.0006237182664590405 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:49.105107] Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3237.603
DLL 2022-11-24 14:04:49.110346 - Training Epoch: 0 Training Iteration: 209  average_loss : nan  step_loss : nan  learning_rate : 0.0006267169119708628 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:51.565735] Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2460.588
DLL 2022-11-24 14:04:51.571060 - Training Epoch: 0 Training Iteration: 210  average_loss : nan  step_loss : nan  learning_rate : 0.000629715557482685 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:53.751197] Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2185.434
DLL 2022-11-24 14:04:53.756628 - Training Epoch: 0 Training Iteration: 211  average_loss : nan  step_loss : nan  learning_rate : 0.0006327142029945074 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:55.854094] Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2102.936
DLL 2022-11-24 14:04:55.859408 - Training Epoch: 0 Training Iteration: 212  average_loss : nan  step_loss : nan  learning_rate : 0.0006357128485063296 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:04:57.913492] Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2059.308
DLL 2022-11-24 14:04:57.918613 - Training Epoch: 0 Training Iteration: 213  average_loss : nan  step_loss : nan  learning_rate : 0.000638711494018152 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:00.057465] Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2143.937
DLL 2022-11-24 14:05:00.062593 - Training Epoch: 0 Training Iteration: 214  average_loss : nan  step_loss : nan  learning_rate : 0.0006417101395299744 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:02.197404] Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2139.906
DLL 2022-11-24 14:05:02.203025 - Training Epoch: 0 Training Iteration: 215  average_loss : nan  step_loss : nan  learning_rate : 0.0006447087850417966 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:04.274922] Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2077.493
DLL 2022-11-24 14:05:04.280120 - Training Epoch: 0 Training Iteration: 216  average_loss : nan  step_loss : nan  learning_rate : 0.000647707430553619 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:06.409370] Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2134.419
DLL 2022-11-24 14:05:06.414577 - Training Epoch: 0 Training Iteration: 217  average_loss : nan  step_loss : nan  learning_rate : 0.0006507060760654413 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:08.541805] Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2132.498
DLL 2022-11-24 14:05:08.547228 - Training Epoch: 0 Training Iteration: 218  average_loss : nan  step_loss : nan  learning_rate : 0.0006537047215772636 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:10.631083] Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2089.157
DLL 2022-11-24 14:05:10.636268 - Training Epoch: 0 Training Iteration: 219  average_loss : nan  step_loss : nan  learning_rate : 0.0006567033670890859 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:12.759379] Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2128.253
DLL 2022-11-24 14:05:12.764701 - Training Epoch: 0 Training Iteration: 220  average_loss : nan  step_loss : nan  learning_rate : 0.0006597020126009082 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:14.887983] Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2128.588
DLL 2022-11-24 14:05:14.893901 - Training Epoch: 0 Training Iteration: 221  average_loss : nan  step_loss : nan  learning_rate : 0.0006627006581127306 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:16.964990] Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2076.967
DLL 2022-11-24 14:05:16.970365 - Training Epoch: 0 Training Iteration: 222  average_loss : nan  step_loss : nan  learning_rate : 0.0006656993036245529 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:19.082378] Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2117.359
DLL 2022-11-24 14:05:19.088189 - Training Epoch: 0 Training Iteration: 223  average_loss : nan  step_loss : nan  learning_rate : 0.0006686979491363751 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:21.197117] Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.706
DLL 2022-11-24 14:05:21.202354 - Training Epoch: 0 Training Iteration: 224  average_loss : nan  step_loss : nan  learning_rate : 0.0006716965946481975 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:23.320476] Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2123.317
DLL 2022-11-24 14:05:23.326246 - Training Epoch: 0 Training Iteration: 225  average_loss : nan  step_loss : nan  learning_rate : 0.0006746952401600198 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:25.453944] Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2133.439
DLL 2022-11-24 14:05:25.459091 - Training Epoch: 0 Training Iteration: 226  average_loss : nan  step_loss : nan  learning_rate : 0.000677693885671842 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:27.574078] Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2120.117
DLL 2022-11-24 14:05:27.579825 - Training Epoch: 0 Training Iteration: 227  average_loss : nan  step_loss : nan  learning_rate : 0.0006806925311836643 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:29.672027] Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2097.910
DLL 2022-11-24 14:05:29.678220 - Training Epoch: 0 Training Iteration: 228  average_loss : nan  step_loss : nan  learning_rate : 0.0006836911766954866 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:31.830554] Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2158.492
DLL 2022-11-24 14:05:31.835886 - Training Epoch: 0 Training Iteration: 229  average_loss : nan  step_loss : nan  learning_rate : 0.0006866898222073091 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:33.995524] Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2164.926
DLL 2022-11-24 14:05:34.001091 - Training Epoch: 0 Training Iteration: 230  average_loss : nan  step_loss : nan  learning_rate : 0.0006896884677191314 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:36.149771] Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2154.237
DLL 2022-11-24 14:05:36.155522 - Training Epoch: 0 Training Iteration: 231  average_loss : nan  step_loss : nan  learning_rate : 0.0006926871132309536 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:38.252041] Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2102.223
DLL 2022-11-24 14:05:38.257263 - Training Epoch: 0 Training Iteration: 232  average_loss : nan  step_loss : nan  learning_rate : 0.0006956857587427759 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:40.367992] Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2115.926
DLL 2022-11-24 14:05:40.373465 - Training Epoch: 0 Training Iteration: 233  average_loss : nan  step_loss : nan  learning_rate : 0.0006986844042545982 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:42.482889] Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.885
DLL 2022-11-24 14:05:42.488133 - Training Epoch: 0 Training Iteration: 234  average_loss : nan  step_loss : nan  learning_rate : 0.0007016830497664205 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:44.595247] Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2112.388
DLL 2022-11-24 14:05:44.600551 - Training Epoch: 0 Training Iteration: 235  average_loss : nan  step_loss : nan  learning_rate : 0.0007046816952782429 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:46.745113] Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2149.821
DLL 2022-11-24 14:05:46.752748 - Training Epoch: 0 Training Iteration: 236  average_loss : nan  step_loss : nan  learning_rate : 0.0007076803407900652 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:48.839259] Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2094.127
DLL 2022-11-24 14:05:48.844615 - Training Epoch: 0 Training Iteration: 237  average_loss : nan  step_loss : nan  learning_rate : 0.0007106789863018875 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:50.951539] Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2112.175
DLL 2022-11-24 14:05:50.957119 - Training Epoch: 0 Training Iteration: 238  average_loss : nan  step_loss : nan  learning_rate : 0.0007136776318137098 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:53.031097] Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2079.516
DLL 2022-11-24 14:05:53.036709 - Training Epoch: 0 Training Iteration: 239  average_loss : nan  step_loss : nan  learning_rate : 0.0007166762773255321 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:55.130164] Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.024
DLL 2022-11-24 14:05:55.135629 - Training Epoch: 0 Training Iteration: 240  average_loss : nan  step_loss : nan  learning_rate : 0.0007196749228373544 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:05:57.222856] Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2092.681
DLL 2022-11-24 14:05:57.227912 - Training Epoch: 0 Training Iteration: 241  average_loss : nan  step_loss : nan  learning_rate : 0.0007226735683491767 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:00.132558] Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2909.672
DLL 2022-11-24 14:06:00.137926 - Training Epoch: 0 Training Iteration: 242  average_loss : nan  step_loss : nan  learning_rate : 0.0007256722138609989 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:02.245829] Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2113.245
DLL 2022-11-24 14:06:02.251394 - Training Epoch: 0 Training Iteration: 243  average_loss : nan  step_loss : nan  learning_rate : 0.0007286708593728212 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:04.371360] Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2125.508
DLL 2022-11-24 14:06:04.376624 - Training Epoch: 0 Training Iteration: 244  average_loss : nan  step_loss : nan  learning_rate : 0.0007316695048846438 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:06.467378] Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2095.976
DLL 2022-11-24 14:06:06.472905 - Training Epoch: 0 Training Iteration: 245  average_loss : nan  step_loss : nan  learning_rate : 0.000734668150396466 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:08.568867] Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2101.456
DLL 2022-11-24 14:06:08.574031 - Training Epoch: 0 Training Iteration: 246  average_loss : nan  step_loss : nan  learning_rate : 0.0007376667959082883 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:10.728911] Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2160.023
DLL 2022-11-24 14:06:10.734671 - Training Epoch: 0 Training Iteration: 247  average_loss : nan  step_loss : nan  learning_rate : 0.0007406654414201106 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:12.784946] Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2055.996
DLL 2022-11-24 14:06:12.790764 - Training Epoch: 0 Training Iteration: 248  average_loss : nan  step_loss : nan  learning_rate : 0.0007436640869319328 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:14.888549] Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2103.633
DLL 2022-11-24 14:06:14.893958 - Training Epoch: 0 Training Iteration: 249  average_loss : nan  step_loss : nan  learning_rate : 0.0007466627324437552 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:17.010669] Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2122.023
DLL 2022-11-24 14:06:17.015817 - Training Epoch: 0 Training Iteration: 250  average_loss : nan  step_loss : nan  learning_rate : 0.0007496613779555775 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:19.116946] Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2106.253
DLL 2022-11-24 14:06:19.122120 - Training Epoch: 0 Training Iteration: 251  average_loss : nan  step_loss : nan  learning_rate : 0.0007526600234673998 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:21.216747] Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.759
DLL 2022-11-24 14:06:21.222458 - Training Epoch: 0 Training Iteration: 252  average_loss : nan  step_loss : nan  learning_rate : 0.0007556586689792222 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:23.338035] Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2121.262
DLL 2022-11-24 14:06:23.343245 - Training Epoch: 0 Training Iteration: 253  average_loss : nan  step_loss : nan  learning_rate : 0.0007586573144910444 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:25.426497] Finished iteration 253, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2088.427
DLL 2022-11-24 14:06:25.431703 - Training Epoch: 0 Training Iteration: 254  average_loss : nan  step_loss : nan  learning_rate : 0.0007616559600028668 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:27.532906] Finished iteration 254, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2106.404
DLL 2022-11-24 14:06:27.538092 - Training Epoch: 0 Training Iteration: 255  average_loss : nan  step_loss : nan  learning_rate : 0.0007646546055146891 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:29.638106] Finished iteration 255, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2105.153
DLL 2022-11-24 14:06:29.643451 - Training Epoch: 0 Training Iteration: 256  average_loss : nan  step_loss : nan  learning_rate : 0.0007676532510265113 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:31.758914] Finished iteration 256, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2120.779
DLL 2022-11-24 14:06:31.764235 - Training Epoch: 0 Training Iteration: 257  average_loss : nan  step_loss : nan  learning_rate : 0.0007706518965383336 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:33.948696] Finished iteration 257, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2189.767
DLL 2022-11-24 14:06:33.954206 - Training Epoch: 0 Training Iteration: 258  average_loss : nan  step_loss : nan  learning_rate : 0.0007736505420501559 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:36.045264] Finished iteration 258, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2096.514
DLL 2022-11-24 14:06:36.050598 - Training Epoch: 0 Training Iteration: 259  average_loss : nan  step_loss : nan  learning_rate : 0.0007766491875619783 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:38.097682] Finished iteration 259, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2052.467
DLL 2022-11-24 14:06:38.103174 - Training Epoch: 0 Training Iteration: 260  average_loss : nan  step_loss : nan  learning_rate : 0.0007796478330738007 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:40.171099] Finished iteration 260, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2073.301
DLL 2022-11-24 14:06:40.176223 - Training Epoch: 0 Training Iteration: 261  average_loss : nan  step_loss : nan  learning_rate : 0.0007826464785856229 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:42.336970] Finished iteration 261, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2165.873
DLL 2022-11-24 14:06:42.342916 - Training Epoch: 0 Training Iteration: 262  average_loss : nan  step_loss : nan  learning_rate : 0.0007856451240974452 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:44.434159] Finished iteration 262, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2097.209
DLL 2022-11-24 14:06:44.442457 - Training Epoch: 0 Training Iteration: 263  average_loss : nan  step_loss : nan  learning_rate : 0.0007886437696092675 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:46.527902] Finished iteration 263, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2093.620
DLL 2022-11-24 14:06:46.533152 - Training Epoch: 0 Training Iteration: 264  average_loss : nan  step_loss : nan  learning_rate : 0.0007916424151210898 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:48.622210] Finished iteration 264, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2094.260
DLL 2022-11-24 14:06:48.627586 - Training Epoch: 0 Training Iteration: 265  average_loss : nan  step_loss : nan  learning_rate : 0.0007946410606329121 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:50.763461] Finished iteration 265, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2141.236
DLL 2022-11-24 14:06:50.768715 - Training Epoch: 0 Training Iteration: 266  average_loss : nan  step_loss : nan  learning_rate : 0.0007976397061447345 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:52.905245] Finished iteration 266, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2141.771
DLL 2022-11-24 14:06:52.910617 - Training Epoch: 0 Training Iteration: 267  average_loss : nan  step_loss : nan  learning_rate : 0.0008006383516565567 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:54.999450] Finished iteration 267, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2094.164
DLL 2022-11-24 14:06:55.005076 - Training Epoch: 0 Training Iteration: 268  average_loss : nan  step_loss : nan  learning_rate : 0.000803636997168379 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:57.067993] Finished iteration 268, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2068.509
DLL 2022-11-24 14:06:57.073625 - Training Epoch: 0 Training Iteration: 269  average_loss : nan  step_loss : nan  learning_rate : 0.0008066356426802014 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:06:59.207863] Finished iteration 269, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2139.823
DLL 2022-11-24 14:06:59.213436 - Training Epoch: 0 Training Iteration: 270  average_loss : nan  step_loss : nan  learning_rate : 0.0008096342881920237 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:01.333891] Finished iteration 270, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2126.015
DLL 2022-11-24 14:07:01.339386 - Training Epoch: 0 Training Iteration: 271  average_loss : nan  step_loss : nan  learning_rate : 0.000812632933703846 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:03.423004] Finished iteration 271, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2089.075
DLL 2022-11-24 14:07:03.428429 - Training Epoch: 0 Training Iteration: 272  average_loss : nan  step_loss : nan  learning_rate : 0.0008156315792156683 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:05.551739] Finished iteration 272, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2128.750
DLL 2022-11-24 14:07:05.557276 - Training Epoch: 0 Training Iteration: 273  average_loss : nan  step_loss : nan  learning_rate : 0.0008186302247274905 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:07.618122] Finished iteration 273, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2066.306
DLL 2022-11-24 14:07:07.623785 - Training Epoch: 0 Training Iteration: 274  average_loss : nan  step_loss : nan  learning_rate : 0.000821628870239313 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:09.659688] Finished iteration 274, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2041.532
DLL 2022-11-24 14:07:09.664924 - Training Epoch: 0 Training Iteration: 275  average_loss : nan  step_loss : nan  learning_rate : 0.0008246275157511352 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:11.774873] Finished iteration 275, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2115.175
DLL 2022-11-24 14:07:11.780369 - Training Epoch: 0 Training Iteration: 276  average_loss : nan  step_loss : nan  learning_rate : 0.0008276261612629576 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:13.950221] Finished iteration 276, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2175.375
DLL 2022-11-24 14:07:13.957698 - Training Epoch: 0 Training Iteration: 277  average_loss : nan  step_loss : nan  learning_rate : 0.0008306248067747799 
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 0 signal handler called with signal 10
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:07:16.756779] Finished iteration 277, CKPT_AND_STOP: True, flag: tensor([2], dtype=torch.int32), speed: 2806.485
DLL 2022-11-24 14:07:16.762078 - Training Epoch: 0 Training Iteration: 278  average_loss : nan  step_loss : nan  learning_rate : 0.0008336234522866021 
2022-11-24 14:07:16.762216 Begin to save checkpont to s3://spot-checkpoints/bert and exit
DLL 2022-11-24 14:07:16.762251 - PARAMETER checkpoint_step : 278 
Opt ckpt time 8.543494701385498
Process done with return code 0
Parent process ID: 59941 node: 172.31.28.108
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 1286522.0947265625 0
End of simulation:  Mini-batch time (usec) = 2905085
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 126283, max long fwd 129698; min long bwd 193190, max long bwd 199310
Time taken by simulation: 48 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 638222.2290039062 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3331662
Min send: 10000000, max send 0
Min long send: 542586, max long send 555338
Min fwd: 107744, max fwd 113936; min bwd 155753, max bwd 158782
Min long fwd: 131842, max long fwd 138676; min long bwd 169332, max long bwd 173300
Time taken by simulation: 100 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 5 0 448996.58203125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 4994037
Min send: 10000000, max send 0
Min long send: 664014, max long send 679713
Min fwd: 72258, max fwd 88035; min bwd 119079, max bwd 130804
Min long fwd: 107414, max long fwd 112703; min long bwd 150032, max long bwd 153679
Time taken by simulation: 168 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 7 0 358221.00830078125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6464795
Min send: 10000000, max send 0
Min long send: 663870, max long send 683729
Min fwd: 53924, max fwd 67812; min bwd 83975, max bwd 97299
Min long fwd: 86081, max long fwd 91318; min long bwd 118237, max long bwd 121834
Time taken by simulation: 369 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 9 0 241996.6583251953 663682.2411979454
End of simulation:  Mini-batch time (usec) = 9164548
Min send: 10000000, max send 0
Min long send: 663736, max long send 687371
Min fwd: 33746, max fwd 47347; min bwd 54554, max bwd 72477
Min long fwd: 65864, max long fwd 73316; min long bwd 84274, max long bwd 89413
Time taken by simulation: 656 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 15 0 176039.7491455078 663682.2411979454
End of simulation:  Mini-batch time (usec) = 13724566
Min send: 10000000, max send 0
Min long send: 663736, max long send 690844
Min fwd: 22801, max fwd 38139; min bwd 36151, max bwd 55503
Min long fwd: 51106, max long fwd 59884; min long bwd 68124, max long bwd 75476
Time taken by simulation: 1835 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 22 0 97192.52014160156 663682.2411979454
End of simulation:  Mini-batch time (usec) = 21189724
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 10724, max fwd 28920; min bwd 23319, max bwd 41964
Min long fwd: 40826, max long fwd 50474; min long bwd 49192, max long bwd 58811
Time taken by simulation: 3845 microseconds

{1: 2.905085, 2: 3.331662, 3: 4.994037, 4: 6.464795, 6: 9.164548, 8: 13.724566, 12: 21.189724}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.331662
15 per stage
30 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 15
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29;
World size is 30
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29; --batch-size=68 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 278
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 14:08:16.803747 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=68, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=True, resume_step=278, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29;', chunk_size=19, batch_size=68, rank=0, profiling=False, n_gpu=1)"] 
dry run time 0.12286496162414551
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
4 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_278.pt
2022-11-24 14:08:27.184775 resume step from  278
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 0 signal handler called with signal 10
2022-11-24 14:09:29.807010 - Finished loading checkpoint, takes 62.436 secs
DLL 2022-11-24 14:09:29.807972 - PARAMETER SEED : 12439 
DLL 2022-11-24 14:09:29.808093 - PARAMETER train_start : True 
DLL 2022-11-24 14:09:29.808155 - PARAMETER batch_size_per_gpu : 68 
DLL 2022-11-24 14:09:29.808192 - PARAMETER learning_rate : 0.006 
Process done with return code 1
Parent process ID: 61837 node: 172.31.28.108
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 1286522.0947265625 0
End of simulation:  Mini-batch time (usec) = 2905085
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 126283, max long fwd 129698; min long bwd 193190, max long bwd 199310
Time taken by simulation: 46 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 638222.2290039062 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3331662
Min send: 10000000, max send 0
Min long send: 542586, max long send 555338
Min fwd: 107744, max fwd 113936; min bwd 155753, max bwd 158782
Min long fwd: 131842, max long fwd 138676; min long bwd 169332, max long bwd 173300
Time taken by simulation: 95 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 5 0 448996.58203125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 4994037
Min send: 10000000, max send 0
Min long send: 664014, max long send 679713
Min fwd: 72258, max fwd 88035; min bwd 119079, max bwd 130804
Min long fwd: 107414, max long fwd 112703; min long bwd 150032, max long bwd 153679
Time taken by simulation: 169 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 7 0 358221.00830078125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6464795
Min send: 10000000, max send 0
Min long send: 663870, max long send 683729
Min fwd: 53924, max fwd 67812; min bwd 83975, max bwd 97299
Min long fwd: 86081, max long fwd 91318; min long bwd 118237, max long bwd 121834
Time taken by simulation: 356 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 9 0 241996.6583251953 663682.2411979454
End of simulation:  Mini-batch time (usec) = 9164548
Min send: 10000000, max send 0
Min long send: 663736, max long send 687371
Min fwd: 33746, max fwd 47347; min bwd 54554, max bwd 72477
Min long fwd: 65864, max long fwd 73316; min long bwd 84274, max long bwd 89413
Time taken by simulation: 687 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 15 0 176039.7491455078 663682.2411979454
End of simulation:  Mini-batch time (usec) = 13724566
Min send: 10000000, max send 0
Min long send: 663736, max long send 690844
Min fwd: 22801, max fwd 38139; min bwd 36151, max bwd 55503
Min long fwd: 51106, max long fwd 59884; min long bwd 68124, max long bwd 75476
Time taken by simulation: 1509 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 22 0 97192.52014160156 663682.2411979454
End of simulation:  Mini-batch time (usec) = 21189724
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 10724, max fwd 28920; min bwd 23319, max bwd 41964
Min long fwd: 40826, max long fwd 50474; min long bwd 49192, max long bwd 58811
Time taken by simulation: 3346 microseconds

{1: 2.905085, 2: 3.331662, 3: 4.994037, 4: 6.464795, 6: 9.164548, 8: 13.724566, 12: 21.189724}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.331662
15 per stage
30 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 15
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29;
World size is 30
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29; --batch-size=68 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 278
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 14:10:27.429312 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=68, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=True, resume_step=278, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29;', chunk_size=19, batch_size=68, rank=0, profiling=False, n_gpu=1)"] 
dry run time 0.18203139305114746
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
4 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_278.pt
2022-11-24 14:10:37.926749 resume step from  278
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
2022-11-24 14:11:37.327445 - Finished loading checkpoint, takes 59.261 secs
DLL 2022-11-24 14:11:37.328361 - PARAMETER SEED : 12439 
DLL 2022-11-24 14:11:37.328523 - PARAMETER train_start : True 
DLL 2022-11-24 14:11:37.328591 - PARAMETER batch_size_per_gpu : 68 
DLL 2022-11-24 14:11:37.328636 - PARAMETER learning_rate : 0.006 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-24 14:12:03.153613] Finished iteration 278, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 4744.424
DLL 2022-11-24 14:12:03.160191 - Training Epoch: 0 Training Iteration: 279  average_loss : nan  step_loss : nan  learning_rate : 0.0008366220977984245 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-11-24 14:12:06.358339] Finished iteration 279, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3204.487
DLL 2022-11-24 14:12:06.364016 - Training Epoch: 0 Training Iteration: 280  average_loss : nan  step_loss : nan  learning_rate : 0.0008396207433102468 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-11-24 14:12:09.535765] Finished iteration 280, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3177.338
DLL 2022-11-24 14:12:09.541481 - Training Epoch: 0 Training Iteration: 281  average_loss : nan  step_loss : nan  learning_rate : 0.000842619388822069 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-11-24 14:12:12.676720] Finished iteration 281, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3140.991
DLL 2022-11-24 14:12:12.683373 - Training Epoch: 0 Training Iteration: 282  average_loss : nan  step_loss : nan  learning_rate : 0.0008456180343338914 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-11-24 14:12:16.115227] Finished iteration 282, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3438.479
DLL 2022-11-24 14:12:16.120777 - Training Epoch: 0 Training Iteration: 283  average_loss : nan  step_loss : nan  learning_rate : 0.0008486166798457137 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-11-24 14:12:18.254688] Finished iteration 283, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2139.368
DLL 2022-11-24 14:12:18.259855 - Training Epoch: 0 Training Iteration: 284  average_loss : nan  step_loss : nan  learning_rate : 0.0008516153253575361 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
[2022-11-24 14:12:20.397818] Finished iteration 284, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2143.131
DLL 2022-11-24 14:12:20.403385 - Training Epoch: 0 Training Iteration: 285  average_loss : nan  step_loss : nan  learning_rate : 0.0008546139708693584 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
[2022-11-24 14:12:22.521037] Finished iteration 285, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2123.160
DLL 2022-11-24 14:12:22.526390 - Training Epoch: 0 Training Iteration: 286  average_loss : nan  step_loss : nan  learning_rate : 0.0008576126163811806 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
[2022-11-24 14:12:24.631483] Finished iteration 286, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2110.401
DLL 2022-11-24 14:12:24.637091 - Training Epoch: 0 Training Iteration: 287  average_loss : nan  step_loss : nan  learning_rate : 0.000860611261893003 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
[2022-11-24 14:12:26.720653] Finished iteration 287, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2089.126
DLL 2022-11-24 14:12:26.727134 - Training Epoch: 0 Training Iteration: 288  average_loss : nan  step_loss : nan  learning_rate : 0.0008636099074048253 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
[2022-11-24 14:12:28.846631] Finished iteration 288, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2125.965
DLL 2022-11-24 14:12:28.852107 - Training Epoch: 0 Training Iteration: 289  average_loss : nan  step_loss : nan  learning_rate : 0.0008666085529166475 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
[2022-11-24 14:12:30.955261] Finished iteration 289, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2108.596
DLL 2022-11-24 14:12:30.960568 - Training Epoch: 0 Training Iteration: 290  average_loss : nan  step_loss : nan  learning_rate : 0.0008696071984284699 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
[2022-11-24 14:12:33.120966] Finished iteration 290, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2165.662
DLL 2022-11-24 14:12:33.126108 - Training Epoch: 0 Training Iteration: 291  average_loss : nan  step_loss : nan  learning_rate : 0.0008726058439402921 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
[2022-11-24 14:12:35.258273] Finished iteration 291, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2137.267
DLL 2022-11-24 14:12:35.263397 - Training Epoch: 0 Training Iteration: 292  average_loss : nan  step_loss : nan  learning_rate : 0.0008756044894521145 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
[2022-11-24 14:12:37.397204] Finished iteration 292, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2138.895
DLL 2022-11-24 14:12:37.402248 - Training Epoch: 0 Training Iteration: 293  average_loss : nan  step_loss : nan  learning_rate : 0.0008786031349639369 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
[2022-11-24 14:12:39.491705] Finished iteration 293, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2094.476
DLL 2022-11-24 14:12:39.496918 - Training Epoch: 0 Training Iteration: 294  average_loss : nan  step_loss : nan  learning_rate : 0.0008816017804757592 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
[2022-11-24 14:12:41.579712] Finished iteration 294, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2087.963
DLL 2022-11-24 14:12:41.584925 - Training Epoch: 0 Training Iteration: 295  average_loss : nan  step_loss : nan  learning_rate : 0.0008846004259875814 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
[2022-11-24 14:12:43.732384] Finished iteration 295, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2152.683
DLL 2022-11-24 14:12:43.737883 - Training Epoch: 0 Training Iteration: 296  average_loss : nan  step_loss : nan  learning_rate : 0.0008875990714994038 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
[2022-11-24 14:12:45.875272] Finished iteration 296, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2142.856
DLL 2022-11-24 14:12:45.880519 - Training Epoch: 0 Training Iteration: 297  average_loss : nan  step_loss : nan  learning_rate : 0.0008905977170112259 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:12:47.974778] Finished iteration 297, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.462
DLL 2022-11-24 14:12:47.980338 - Training Epoch: 0 Training Iteration: 298  average_loss : nan  step_loss : nan  learning_rate : 0.0008935963625230486 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:12:50.111491] Finished iteration 298, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2136.693
DLL 2022-11-24 14:12:50.117177 - Training Epoch: 0 Training Iteration: 299  average_loss : nan  step_loss : nan  learning_rate : 0.0008965950080348708 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:12:52.260318] Finished iteration 299, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2148.823
DLL 2022-11-24 14:12:52.265712 - Training Epoch: 0 Training Iteration: 300  average_loss : nan  step_loss : nan  learning_rate : 0.0008995936535466931 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:12:54.431602] Finished iteration 300, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2171.267
DLL 2022-11-24 14:12:54.437303 - Training Epoch: 0 Training Iteration: 301  average_loss : nan  step_loss : nan  learning_rate : 0.0009025922990585153 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:12:56.558484] Finished iteration 301, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2126.831
DLL 2022-11-24 14:12:56.563842 - Training Epoch: 0 Training Iteration: 302  average_loss : nan  step_loss : nan  learning_rate : 0.0009055909445703376 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:12:58.731416] Finished iteration 302, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2172.853
DLL 2022-11-24 14:12:58.736862 - Training Epoch: 0 Training Iteration: 303  average_loss : nan  step_loss : nan  learning_rate : 0.00090858959008216 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:00.848025] Finished iteration 303, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2116.624
DLL 2022-11-24 14:13:00.853292 - Training Epoch: 0 Training Iteration: 304  average_loss : nan  step_loss : nan  learning_rate : 0.0009115882355939822 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:03.001815] Finished iteration 304, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2153.767
DLL 2022-11-24 14:13:03.007302 - Training Epoch: 0 Training Iteration: 305  average_loss : nan  step_loss : nan  learning_rate : 0.0009145868811058045 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:05.143161] Finished iteration 305, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2141.257
DLL 2022-11-24 14:13:05.148719 - Training Epoch: 0 Training Iteration: 306  average_loss : nan  step_loss : nan  learning_rate : 0.0009175855266176267 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:07.617191] Finished iteration 306, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2474.026
DLL 2022-11-24 14:13:07.622373 - Training Epoch: 0 Training Iteration: 307  average_loss : nan  step_loss : nan  learning_rate : 0.0009205841721294492 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:10.006371] Finished iteration 307, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2389.123
DLL 2022-11-24 14:13:10.012065 - Training Epoch: 0 Training Iteration: 308  average_loss : nan  step_loss : nan  learning_rate : 0.0009235828176412715 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:12.156674] Finished iteration 308, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2150.259
DLL 2022-11-24 14:13:12.161884 - Training Epoch: 0 Training Iteration: 309  average_loss : nan  step_loss : nan  learning_rate : 0.0009265814631530939 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:14.271406] Finished iteration 309, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.714
DLL 2022-11-24 14:13:14.276498 - Training Epoch: 0 Training Iteration: 310  average_loss : nan  step_loss : nan  learning_rate : 0.0009295801086649161 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:16.431163] Finished iteration 310, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2159.745
DLL 2022-11-24 14:13:16.436695 - Training Epoch: 0 Training Iteration: 311  average_loss : nan  step_loss : nan  learning_rate : 0.0009325787541767384 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:18.551615] Finished iteration 311, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2120.413
DLL 2022-11-24 14:13:18.557085 - Training Epoch: 0 Training Iteration: 312  average_loss : nan  step_loss : nan  learning_rate : 0.0009355773996885606 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:20.682120] Finished iteration 312, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2130.476
DLL 2022-11-24 14:13:20.687265 - Training Epoch: 0 Training Iteration: 313  average_loss : nan  step_loss : nan  learning_rate : 0.0009385760452003831 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:22.795286] Finished iteration 313, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2113.113
DLL 2022-11-24 14:13:22.800350 - Training Epoch: 0 Training Iteration: 314  average_loss : nan  step_loss : nan  learning_rate : 0.0009415746907122053 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:24.955971] Finished iteration 314, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2160.647
DLL 2022-11-24 14:13:24.961613 - Training Epoch: 0 Training Iteration: 315  average_loss : nan  step_loss : nan  learning_rate : 0.0009445733362240278 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:27.093505] Finished iteration 315, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2137.508
DLL 2022-11-24 14:13:27.099126 - Training Epoch: 0 Training Iteration: 316  average_loss : nan  step_loss : nan  learning_rate : 0.0009475719817358499 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:29.283641] Finished iteration 316, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2190.108
DLL 2022-11-24 14:13:29.288892 - Training Epoch: 0 Training Iteration: 317  average_loss : nan  step_loss : nan  learning_rate : 0.0009505706272476723 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:31.381786] Finished iteration 317, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2098.149
DLL 2022-11-24 14:13:31.386951 - Training Epoch: 0 Training Iteration: 318  average_loss : nan  step_loss : nan  learning_rate : 0.0009535692727594946 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:33.513541] Finished iteration 318, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2131.685
DLL 2022-11-24 14:13:33.518866 - Training Epoch: 0 Training Iteration: 319  average_loss : nan  step_loss : nan  learning_rate : 0.0009565679182713168 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:35.774217] Finished iteration 319, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2260.720
DLL 2022-11-24 14:13:35.779573 - Training Epoch: 0 Training Iteration: 320  average_loss : nan  step_loss : nan  learning_rate : 0.0009595665637831392 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:37.927494] Finished iteration 320, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2153.211
DLL 2022-11-24 14:13:37.932779 - Training Epoch: 0 Training Iteration: 321  average_loss : nan  step_loss : nan  learning_rate : 0.0009625652092949614 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:40.072646] Finished iteration 321, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2145.143
DLL 2022-11-24 14:13:40.077927 - Training Epoch: 0 Training Iteration: 322  average_loss : nan  step_loss : nan  learning_rate : 0.0009655638548067837 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:42.228831] Finished iteration 322, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2156.142
DLL 2022-11-24 14:13:42.234531 - Training Epoch: 0 Training Iteration: 323  average_loss : nan  step_loss : nan  learning_rate : 0.0009685625003186062 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:44.365871] Finished iteration 323, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2136.977
DLL 2022-11-24 14:13:44.371208 - Training Epoch: 0 Training Iteration: 324  average_loss : nan  step_loss : nan  learning_rate : 0.0009715611458304285 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:46.491234] Finished iteration 324, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2125.351
DLL 2022-11-24 14:13:46.580417 - Training Epoch: 0 Training Iteration: 325  average_loss : nan  step_loss : nan  learning_rate : 0.0009745597913422507 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:48.746227] Finished iteration 325, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2254.998
DLL 2022-11-24 14:13:48.751868 - Training Epoch: 0 Training Iteration: 326  average_loss : nan  step_loss : nan  learning_rate : 0.000977558436854073 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:50.868993] Finished iteration 326, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2122.757
DLL 2022-11-24 14:13:50.874517 - Training Epoch: 0 Training Iteration: 327  average_loss : nan  step_loss : nan  learning_rate : 0.0009805570823658953 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:53.717067] Finished iteration 327, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2847.993
DLL 2022-11-24 14:13:53.722987 - Training Epoch: 0 Training Iteration: 328  average_loss : nan  step_loss : nan  learning_rate : 0.0009835557278777176 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:55.849484] Finished iteration 328, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2132.382
DLL 2022-11-24 14:13:55.854961 - Training Epoch: 0 Training Iteration: 329  average_loss : nan  step_loss : nan  learning_rate : 0.00098655437338954 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:13:58.033728] Finished iteration 329, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2184.165
DLL 2022-11-24 14:13:58.039567 - Training Epoch: 0 Training Iteration: 330  average_loss : nan  step_loss : nan  learning_rate : 0.0009895530189013625 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:00.142288] Finished iteration 330, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2108.551
DLL 2022-11-24 14:14:00.147624 - Training Epoch: 0 Training Iteration: 331  average_loss : nan  step_loss : nan  learning_rate : 0.0009925516644131846 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:02.237603] Finished iteration 331, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2095.265
DLL 2022-11-24 14:14:02.242965 - Training Epoch: 0 Training Iteration: 332  average_loss : nan  step_loss : nan  learning_rate : 0.0009955503099250069 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:04.393883] Finished iteration 332, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2156.254
DLL 2022-11-24 14:14:04.399494 - Training Epoch: 0 Training Iteration: 333  average_loss : nan  step_loss : nan  learning_rate : 0.0009985489554368292 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:06.514873] Finished iteration 333, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2120.994
DLL 2022-11-24 14:14:06.520299 - Training Epoch: 0 Training Iteration: 334  average_loss : nan  step_loss : nan  learning_rate : 0.0010015476009486515 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:08.635946] Finished iteration 334, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2121.057
DLL 2022-11-24 14:14:08.642517 - Training Epoch: 0 Training Iteration: 335  average_loss : nan  step_loss : nan  learning_rate : 0.0010045462464604738 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:10.766930] Finished iteration 335, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2130.934
DLL 2022-11-24 14:14:10.772112 - Training Epoch: 0 Training Iteration: 336  average_loss : nan  step_loss : nan  learning_rate : 0.0010075448919722961 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:12.887820] Finished iteration 336, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2120.837
DLL 2022-11-24 14:14:12.894991 - Training Epoch: 0 Training Iteration: 337  average_loss : nan  step_loss : nan  learning_rate : 0.0010105435374841184 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:15.024568] Finished iteration 337, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2136.703
DLL 2022-11-24 14:14:15.030078 - Training Epoch: 0 Training Iteration: 338  average_loss : nan  step_loss : nan  learning_rate : 0.0010135421829959408 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:17.188312] Finished iteration 338, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2163.759
DLL 2022-11-24 14:14:17.193686 - Training Epoch: 0 Training Iteration: 339  average_loss : nan  step_loss : nan  learning_rate : 0.001016540828507763 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:19.317302] Finished iteration 339, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2128.991
DLL 2022-11-24 14:14:19.322569 - Training Epoch: 0 Training Iteration: 340  average_loss : nan  step_loss : nan  learning_rate : 0.0010195394740195854 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:21.432201] Finished iteration 340, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.839
DLL 2022-11-24 14:14:21.437426 - Training Epoch: 0 Training Iteration: 341  average_loss : nan  step_loss : nan  learning_rate : 0.0010225381195314077 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:23.594807] Finished iteration 341, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2162.558
DLL 2022-11-24 14:14:23.600065 - Training Epoch: 0 Training Iteration: 342  average_loss : nan  step_loss : nan  learning_rate : 0.0010255367650432298 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:25.752027] Finished iteration 342, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2157.233
DLL 2022-11-24 14:14:25.759987 - Training Epoch: 0 Training Iteration: 343  average_loss : nan  step_loss : nan  learning_rate : 0.0010285354105550523 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:27.889941] Finished iteration 343, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2137.800
DLL 2022-11-24 14:14:27.895500 - Training Epoch: 0 Training Iteration: 344  average_loss : nan  step_loss : nan  learning_rate : 0.0010315340560668746 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:30.032856] Finished iteration 344, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2142.876
DLL 2022-11-24 14:14:30.038062 - Training Epoch: 0 Training Iteration: 345  average_loss : nan  step_loss : nan  learning_rate : 0.001034532701578697 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:32.181073] Finished iteration 345, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2148.204
DLL 2022-11-24 14:14:32.186670 - Training Epoch: 0 Training Iteration: 346  average_loss : nan  step_loss : nan  learning_rate : 0.0010375313470905193 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:34.317986] Finished iteration 346, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2136.868
DLL 2022-11-24 14:14:34.323238 - Training Epoch: 0 Training Iteration: 347  average_loss : nan  step_loss : nan  learning_rate : 0.0010405299926023416 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:36.415962] Finished iteration 347, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2098.040
DLL 2022-11-24 14:14:36.421341 - Training Epoch: 0 Training Iteration: 348  average_loss : nan  step_loss : nan  learning_rate : 0.0010435286381141639 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:38.595804] Finished iteration 348, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2179.716
DLL 2022-11-24 14:14:38.601460 - Training Epoch: 0 Training Iteration: 349  average_loss : nan  step_loss : nan  learning_rate : 0.0010465272836259862 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:40.705055] Finished iteration 349, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2109.210
DLL 2022-11-24 14:14:40.710134 - Training Epoch: 0 Training Iteration: 350  average_loss : nan  step_loss : nan  learning_rate : 0.0010495259291378085 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:42.900409] Finished iteration 350, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2195.372
DLL 2022-11-24 14:14:42.905910 - Training Epoch: 0 Training Iteration: 351  average_loss : nan  step_loss : nan  learning_rate : 0.0010525245746496306 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:45.032993] Finished iteration 351, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2132.518
DLL 2022-11-24 14:14:45.038430 - Training Epoch: 0 Training Iteration: 352  average_loss : nan  step_loss : nan  learning_rate : 0.0010555232201614531 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:47.163108] Finished iteration 352, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2130.121
DLL 2022-11-24 14:14:47.168492 - Training Epoch: 0 Training Iteration: 353  average_loss : nan  step_loss : nan  learning_rate : 0.0010585218656732755 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:49.263302] Finished iteration 353, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2100.120
DLL 2022-11-24 14:14:49.268370 - Training Epoch: 0 Training Iteration: 354  average_loss : nan  step_loss : nan  learning_rate : 0.0010615205111850978 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:51.411409] Finished iteration 354, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2148.072
DLL 2022-11-24 14:14:51.417732 - Training Epoch: 0 Training Iteration: 355  average_loss : nan  step_loss : nan  learning_rate : 0.00106451915669692 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:53.605434] Finished iteration 355, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2194.007
DLL 2022-11-24 14:14:53.610633 - Training Epoch: 0 Training Iteration: 356  average_loss : nan  step_loss : nan  learning_rate : 0.0010675178022087424 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:55.726809] Finished iteration 356, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2121.380
DLL 2022-11-24 14:14:55.732207 - Training Epoch: 0 Training Iteration: 357  average_loss : nan  step_loss : nan  learning_rate : 0.0010705164477205647 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:57.843096] Finished iteration 357, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2116.260
DLL 2022-11-24 14:14:57.848737 - Training Epoch: 0 Training Iteration: 358  average_loss : nan  step_loss : nan  learning_rate : 0.001073515093232387 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:14:59.951008] Finished iteration 358, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2107.870
DLL 2022-11-24 14:14:59.956437 - Training Epoch: 0 Training Iteration: 359  average_loss : nan  step_loss : nan  learning_rate : 0.0010765137387442093 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:02.083010] Finished iteration 359, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2131.939
DLL 2022-11-24 14:15:02.088237 - Training Epoch: 0 Training Iteration: 360  average_loss : nan  step_loss : nan  learning_rate : 0.0010795123842560316 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:04.205058] Finished iteration 360, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2122.061
DLL 2022-11-24 14:15:04.210807 - Training Epoch: 0 Training Iteration: 361  average_loss : nan  step_loss : nan  learning_rate : 0.0010825110297678537 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:06.370042] Finished iteration 361, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2164.945
DLL 2022-11-24 14:15:06.375672 - Training Epoch: 0 Training Iteration: 362  average_loss : nan  step_loss : nan  learning_rate : 0.0010855096752796763 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:08.532180] Finished iteration 362, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2162.107
DLL 2022-11-24 14:15:08.537382 - Training Epoch: 0 Training Iteration: 363  average_loss : nan  step_loss : nan  learning_rate : 0.0010885083207914986 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:10.687480] Finished iteration 363, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2155.222
DLL 2022-11-24 14:15:10.692714 - Training Epoch: 0 Training Iteration: 364  average_loss : nan  step_loss : nan  learning_rate : 0.0010915069663033207 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:12.883432] Finished iteration 364, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2195.894
DLL 2022-11-24 14:15:12.888918 - Training Epoch: 0 Training Iteration: 365  average_loss : nan  step_loss : nan  learning_rate : 0.0010945056118151432 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:14.999176] Finished iteration 365, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2115.741
DLL 2022-11-24 14:15:15.005115 - Training Epoch: 0 Training Iteration: 366  average_loss : nan  step_loss : nan  learning_rate : 0.0010975042573269653 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:17.105911] Finished iteration 366, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2106.718
DLL 2022-11-24 14:15:17.111448 - Training Epoch: 0 Training Iteration: 367  average_loss : nan  step_loss : nan  learning_rate : 0.0011005029028387878 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:19.273324] Finished iteration 367, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2167.386
DLL 2022-11-24 14:15:19.278805 - Training Epoch: 0 Training Iteration: 368  average_loss : nan  step_loss : nan  learning_rate : 0.0011035015483506101 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:21.392017] Finished iteration 368, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2118.637
DLL 2022-11-24 14:15:21.397131 - Training Epoch: 0 Training Iteration: 369  average_loss : nan  step_loss : nan  learning_rate : 0.0011065001938624325 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:23.544527] Finished iteration 369, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2152.451
DLL 2022-11-24 14:15:23.549931 - Training Epoch: 0 Training Iteration: 370  average_loss : nan  step_loss : nan  learning_rate : 0.0011094988393742546 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:25.704064] Finished iteration 370, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2159.515
DLL 2022-11-24 14:15:25.709287 - Training Epoch: 0 Training Iteration: 371  average_loss : nan  step_loss : nan  learning_rate : 0.001112497484886077 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:27.854922] Finished iteration 371, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2150.843
DLL 2022-11-24 14:15:27.860191 - Training Epoch: 0 Training Iteration: 372  average_loss : nan  step_loss : nan  learning_rate : 0.0011154961303978994 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:29.967054] Finished iteration 372, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2112.120
DLL 2022-11-24 14:15:29.972268 - Training Epoch: 0 Training Iteration: 373  average_loss : nan  step_loss : nan  learning_rate : 0.0011184947759097215 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:32.105359] Finished iteration 373, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2138.237
DLL 2022-11-24 14:15:32.110745 - Training Epoch: 0 Training Iteration: 374  average_loss : nan  step_loss : nan  learning_rate : 0.001121493421421544 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:34.267474] Finished iteration 374, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2162.158
DLL 2022-11-24 14:15:34.273151 - Training Epoch: 0 Training Iteration: 375  average_loss : nan  step_loss : nan  learning_rate : 0.0011244920669333661 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:36.392166] Finished iteration 375, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2124.582
DLL 2022-11-24 14:15:36.397917 - Training Epoch: 0 Training Iteration: 376  average_loss : nan  step_loss : nan  learning_rate : 0.0011274907124451884 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:38.514854] Finished iteration 376, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2122.666
DLL 2022-11-24 14:15:38.520102 - Training Epoch: 0 Training Iteration: 377  average_loss : nan  step_loss : nan  learning_rate : 0.0011304893579570108 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:40.697041] Finished iteration 377, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2182.224
DLL 2022-11-24 14:15:40.702305 - Training Epoch: 0 Training Iteration: 378  average_loss : nan  step_loss : nan  learning_rate : 0.0011334880034688333 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:42.815130] Finished iteration 378, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2118.057
DLL 2022-11-24 14:15:42.820568 - Training Epoch: 0 Training Iteration: 379  average_loss : nan  step_loss : nan  learning_rate : 0.0011364866489806554 
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 0 signal handler called with signal 10
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:15:44.956224] Finished iteration 379, CKPT_AND_STOP: True, flag: tensor([1], dtype=torch.int32), speed: 2141.036
DLL 2022-11-24 14:15:44.961640 - Training Epoch: 0 Training Iteration: 380  average_loss : nan  step_loss : nan  learning_rate : 0.0011394852944924777 
2022-11-24 14:15:44.961759 Begin to save checkpont to s3://spot-checkpoints/bert and exit
DLL 2022-11-24 14:15:44.961776 - PARAMETER checkpoint_step : 380 
Opt ckpt time 7.290168285369873
Process done with return code 0
Parent process ID: 64391 node: 172.31.28.108
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 5 0 1286522.0947265625 0
End of simulation:  Mini-batch time (usec) = 2905085
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 126283, max long fwd 129698; min long bwd 193190, max long bwd 199310
Time taken by simulation: 48 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 638222.2290039062 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3331662
Min send: 10000000, max send 0
Min long send: 542586, max long send 555338
Min fwd: 107744, max fwd 113936; min bwd 155753, max bwd 158782
Min long fwd: 131842, max long fwd 138676; min long bwd 169332, max long bwd 173300
Time taken by simulation: 102 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 5 0 448996.58203125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 4994037
Min send: 10000000, max send 0
Min long send: 664014, max long send 679713
Min fwd: 72258, max fwd 88035; min bwd 119079, max bwd 130804
Min long fwd: 107414, max long fwd 112703; min long bwd 150032, max long bwd 153679
Time taken by simulation: 174 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 7 0 358221.00830078125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6464795
Min send: 10000000, max send 0
Min long send: 663870, max long send 683729
Min fwd: 53924, max fwd 67812; min bwd 83975, max bwd 97299
Min long fwd: 86081, max long fwd 91318; min long bwd 118237, max long bwd 121834
Time taken by simulation: 318 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 9 0 241996.6583251953 663682.2411979454
End of simulation:  Mini-batch time (usec) = 9164548
Min send: 10000000, max send 0
Min long send: 663736, max long send 687371
Min fwd: 33746, max fwd 47347; min bwd 54554, max bwd 72477
Min long fwd: 65864, max long fwd 73316; min long bwd 84274, max long bwd 89413
Time taken by simulation: 622 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 15 0 176039.7491455078 663682.2411979454
End of simulation:  Mini-batch time (usec) = 13724566
Min send: 10000000, max send 0
Min long send: 663736, max long send 690844
Min fwd: 22801, max fwd 38139; min bwd 36151, max bwd 55503
Min long fwd: 51106, max long fwd 59884; min long bwd 68124, max long bwd 75476
Time taken by simulation: 1555 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 22 0 97192.52014160156 663682.2411979454
End of simulation:  Mini-batch time (usec) = 21189724
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 10724, max fwd 28920; min bwd 23319, max bwd 41964
Min long fwd: 40826, max long fwd 50474; min long bwd 49192, max long bwd 58811
Time taken by simulation: 3586 microseconds

{1: 2.905085, 2: 3.331662, 3: 4.994037, 4: 6.464795, 6: 9.164548, 8: 13.724566, 12: 21.189724}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.331662
15 per stage
30 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 15
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29;
World size is 30
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29; --batch-size=68 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 380
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 14:16:15.434742 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=68, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=True, resume_step=380, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20,22,24,26,28;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29;', chunk_size=19, batch_size=68, rank=0, profiling=False, n_gpu=1)"] 
dry run time 1.2831273078918457
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
4 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_380.pt
2022-11-24 14:16:27.035113 resume step from  380
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 0 signal handler called with signal 10
2022-11-24 14:17:30.947354 - Finished loading checkpoint, takes 58.912 secs
DLL 2022-11-24 14:17:30.948345 - PARAMETER SEED : 12439 
DLL 2022-11-24 14:17:30.948505 - PARAMETER train_start : True 
DLL 2022-11-24 14:17:30.948597 - PARAMETER batch_size_per_gpu : 68 
DLL 2022-11-24 14:17:30.948671 - PARAMETER learning_rate : 0.006 
2022-11-24 14:17:54.288226 Begin to exit
Process done with return code 0
Parent process ID: 66060 node: 172.31.28.108
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 3150942.3828125 0
End of simulation:  Mini-batch time (usec) = 4450032
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 127414, max long fwd 129698; min long bwd 194806, max long bwd 199310
Time taken by simulation: 44 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 4 0 673273.3154296875 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3366713
Min send: 10000000, max send 0
Min long send: 542586, max long send 555338
Min fwd: 107744, max fwd 113936; min bwd 155753, max bwd 158782
Min long fwd: 131842, max long fwd 138676; min long bwd 169332, max long bwd 173300
Time taken by simulation: 123 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 5 0 448996.58203125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 4994037
Min send: 10000000, max send 0
Min long send: 664014, max long send 679713
Min fwd: 72258, max fwd 88035; min bwd 119079, max bwd 130804
Min long fwd: 107414, max long fwd 112703; min long bwd 150032, max long bwd 153679
Time taken by simulation: 172 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 6 0 375752.13623046875 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6314108
Min send: 10000000, max send 0
Min long send: 663764, max long send 688387
Min fwd: 53924, max fwd 66948; min bwd 83975, max bwd 98046
Min long fwd: 84759, max long fwd 91250; min long bwd 120659, max long bwd 125455
Time taken by simulation: 292 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 9 0 241996.6583251953 663682.2411979454
End of simulation:  Mini-batch time (usec) = 9164548
Min send: 10000000, max send 0
Min long send: 663736, max long send 687371
Min fwd: 33746, max fwd 47347; min bwd 54554, max bwd 72477
Min long fwd: 65864, max long fwd 73316; min long bwd 84274, max long bwd 89413
Time taken by simulation: 631 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 11 0 214379.08935546875 663682.2411979454
End of simulation:  Mini-batch time (usec) = 12421079
Min send: 10000000, max send 0
Min long send: 663682, max long send 689782
Min fwd: 22992, max fwd 37161; min bwd 37517, max bwd 55449
Min long fwd: 51419, max long fwd 57045; min long bwd 68935, max long bwd 77274
Time taken by simulation: 1179 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 22 0 97192.52014160156 663682.2411979454
End of simulation:  Mini-batch time (usec) = 21189724
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 10724, max fwd 28920; min bwd 23319, max bwd 41964
Min long fwd: 40826, max long fwd 50474; min long bwd 49192, max long bwd 58811
Time taken by simulation: 3435 microseconds

{1: 4.450032, 2: 3.366713, 3: 4.994037, 4: 6.314108, 6: 9.164548, 8: 12.421079, 12: 21.189724}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.366713
16 per stage
32 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 16
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31;
World size is 32
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31; --batch-size=64 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 380
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 14:18:05.264126 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=64, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=True, resume_step=380, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30;1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31;', chunk_size=19, batch_size=64, rank=0, profiling=False, n_gpu=1)"] 
dry run time 0.1537940502166748
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
4 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_380.pt
2022-11-24 14:18:15.739661 resume step from  380
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
2022-11-24 14:19:17.977990 - Finished loading checkpoint, takes 57.179 secs
DLL 2022-11-24 14:19:17.978974 - PARAMETER SEED : 12439 
DLL 2022-11-24 14:19:17.979100 - PARAMETER train_start : True 
DLL 2022-11-24 14:19:17.979182 - PARAMETER batch_size_per_gpu : 64 
DLL 2022-11-24 14:19:17.979263 - PARAMETER learning_rate : 0.006 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-11-24 14:19:34.546456] Finished iteration 380, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 5720.849
DLL 2022-11-24 14:19:34.552485 - Training Epoch: 0 Training Iteration: 381  average_loss : nan  step_loss : nan  learning_rate : 0.0011424839400043 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-11-24 14:19:37.740201] Finished iteration 381, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3193.485
DLL 2022-11-24 14:19:37.745925 - Training Epoch: 0 Training Iteration: 382  average_loss : nan  step_loss : nan  learning_rate : 0.0011454825855161225 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-11-24 14:19:40.908712] Finished iteration 382, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3168.449
DLL 2022-11-24 14:19:40.914526 - Training Epoch: 0 Training Iteration: 383  average_loss : nan  step_loss : nan  learning_rate : 0.0011484812310279446 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-11-24 14:19:44.057757] Finished iteration 383, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3149.015
DLL 2022-11-24 14:19:44.064086 - Training Epoch: 0 Training Iteration: 384  average_loss : nan  step_loss : nan  learning_rate : 0.0011514798765397672 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-11-24 14:19:47.211752] Finished iteration 384, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3153.930
DLL 2022-11-24 14:19:47.217166 - Training Epoch: 0 Training Iteration: 385  average_loss : nan  step_loss : nan  learning_rate : 0.0011544785220515893 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-11-24 14:19:49.553113] Finished iteration 385, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2341.282
DLL 2022-11-24 14:19:49.558217 - Training Epoch: 0 Training Iteration: 386  average_loss : nan  step_loss : nan  learning_rate : 0.0011574771675634116 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
[2022-11-24 14:19:51.662475] Finished iteration 386, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2109.345
DLL 2022-11-24 14:19:51.671421 - Training Epoch: 0 Training Iteration: 387  average_loss : nan  step_loss : nan  learning_rate : 0.001160475813075234 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
[2022-11-24 14:19:53.811432] Finished iteration 387, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2148.901
DLL 2022-11-24 14:19:53.817064 - Training Epoch: 0 Training Iteration: 388  average_loss : nan  step_loss : nan  learning_rate : 0.0011634744585870562 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
[2022-11-24 14:19:55.879576] Finished iteration 388, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2068.132
DLL 2022-11-24 14:19:55.884933 - Training Epoch: 0 Training Iteration: 389  average_loss : nan  step_loss : nan  learning_rate : 0.0011664731040988785 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
[2022-11-24 14:19:57.959126] Finished iteration 389, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2079.524
DLL 2022-11-24 14:19:57.964259 - Training Epoch: 0 Training Iteration: 390  average_loss : nan  step_loss : nan  learning_rate : 0.0011694717496107008 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  512.0
[2022-11-24 14:20:00.058681] Finished iteration 390, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.499
DLL 2022-11-24 14:20:00.064069 - Training Epoch: 0 Training Iteration: 391  average_loss : nan  step_loss : nan  learning_rate : 0.0011724703951225231 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  256.0
[2022-11-24 14:20:02.200798] Finished iteration 391, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2142.131
DLL 2022-11-24 14:20:02.206249 - Training Epoch: 0 Training Iteration: 392  average_loss : nan  step_loss : nan  learning_rate : 0.0011754690406343454 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  128.0
[2022-11-24 14:20:05.145559] Finished iteration 392, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2944.685
DLL 2022-11-24 14:20:05.150896 - Training Epoch: 0 Training Iteration: 393  average_loss : nan  step_loss : nan  learning_rate : 0.001178467686146168 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  64.0
[2022-11-24 14:20:07.255047] Finished iteration 393, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2109.465
DLL 2022-11-24 14:20:07.260834 - Training Epoch: 0 Training Iteration: 394  average_loss : nan  step_loss : nan  learning_rate : 0.00118146633165799 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  32.0
[2022-11-24 14:20:09.349439] Finished iteration 394, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2094.417
DLL 2022-11-24 14:20:09.355010 - Training Epoch: 0 Training Iteration: 395  average_loss : nan  step_loss : nan  learning_rate : 0.0011844649771698124 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  16.0
[2022-11-24 14:20:12.385194] Finished iteration 395, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 3035.693
DLL 2022-11-24 14:20:12.391049 - Training Epoch: 0 Training Iteration: 396  average_loss : nan  step_loss : nan  learning_rate : 0.0011874636226816347 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  8.0
[2022-11-24 14:20:14.476238] Finished iteration 396, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2091.022
DLL 2022-11-24 14:20:14.481789 - Training Epoch: 0 Training Iteration: 397  average_loss : nan  step_loss : nan  learning_rate : 0.0011904622681934572 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  4.0
[2022-11-24 14:20:16.548519] Finished iteration 397, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2072.225
DLL 2022-11-24 14:20:16.554215 - Training Epoch: 0 Training Iteration: 398  average_loss : nan  step_loss : nan  learning_rate : 0.0011934609137052793 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  2.0
[2022-11-24 14:20:18.633487] Finished iteration 398, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2084.917
DLL 2022-11-24 14:20:18.638794 - Training Epoch: 0 Training Iteration: 399  average_loss : nan  step_loss : nan  learning_rate : 0.0011964595592171016 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:20.684320] Finished iteration 399, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2050.832
DLL 2022-11-24 14:20:20.689741 - Training Epoch: 0 Training Iteration: 400  average_loss : nan  step_loss : nan  learning_rate : 0.001199458204728924 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:22.759430] Finished iteration 400, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2075.108
DLL 2022-11-24 14:20:22.764878 - Training Epoch: 0 Training Iteration: 401  average_loss : nan  step_loss : nan  learning_rate : 0.0012024568502407463 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:24.874874] Finished iteration 401, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2115.359
DLL 2022-11-24 14:20:24.880264 - Training Epoch: 0 Training Iteration: 402  average_loss : nan  step_loss : nan  learning_rate : 0.0012054554957525686 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:26.988248] Finished iteration 402, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2113.443
DLL 2022-11-24 14:20:26.993823 - Training Epoch: 0 Training Iteration: 403  average_loss : nan  step_loss : nan  learning_rate : 0.001208454141264391 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:29.630898] Finished iteration 403, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2642.609
DLL 2022-11-24 14:20:29.636943 - Training Epoch: 0 Training Iteration: 404  average_loss : nan  step_loss : nan  learning_rate : 0.0012114527867762132 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:31.799842] Finished iteration 404, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2168.835
DLL 2022-11-24 14:20:31.805715 - Training Epoch: 0 Training Iteration: 405  average_loss : nan  step_loss : nan  learning_rate : 0.0012144514322880353 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:33.877361] Finished iteration 405, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2077.520
DLL 2022-11-24 14:20:33.883046 - Training Epoch: 0 Training Iteration: 406  average_loss : nan  step_loss : nan  learning_rate : 0.0012174500777998578 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:35.996763] Finished iteration 406, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2119.336
DLL 2022-11-24 14:20:36.002533 - Training Epoch: 0 Training Iteration: 407  average_loss : nan  step_loss : nan  learning_rate : 0.0012204487233116801 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:38.093126] Finished iteration 407, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2096.327
DLL 2022-11-24 14:20:38.099057 - Training Epoch: 0 Training Iteration: 408  average_loss : nan  step_loss : nan  learning_rate : 0.0012234473688235025 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:40.228360] Finished iteration 408, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2135.259
DLL 2022-11-24 14:20:40.233772 - Training Epoch: 0 Training Iteration: 409  average_loss : nan  step_loss : nan  learning_rate : 0.0012264460143353248 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:42.293507] Finished iteration 409, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2065.166
DLL 2022-11-24 14:20:42.299221 - Training Epoch: 0 Training Iteration: 410  average_loss : nan  step_loss : nan  learning_rate : 0.001229444659847147 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:44.368133] Finished iteration 410, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2074.525
DLL 2022-11-24 14:20:44.373304 - Training Epoch: 0 Training Iteration: 411  average_loss : nan  step_loss : nan  learning_rate : 0.0012324433053589694 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:46.483175] Finished iteration 411, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2114.978
DLL 2022-11-24 14:20:46.488928 - Training Epoch: 0 Training Iteration: 412  average_loss : nan  step_loss : nan  learning_rate : 0.001235441950870792 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:48.568337] Finished iteration 412, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2085.202
DLL 2022-11-24 14:20:48.574300 - Training Epoch: 0 Training Iteration: 413  average_loss : nan  step_loss : nan  learning_rate : 0.001238440596382614 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:50.664428] Finished iteration 413, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2096.040
DLL 2022-11-24 14:20:50.669914 - Training Epoch: 0 Training Iteration: 414  average_loss : nan  step_loss : nan  learning_rate : 0.0012414392418944363 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:52.756724] Finished iteration 414, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2092.200
DLL 2022-11-24 14:20:52.762424 - Training Epoch: 0 Training Iteration: 415  average_loss : nan  step_loss : nan  learning_rate : 0.0012444378874062586 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:54.899999] Finished iteration 415, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2143.254
DLL 2022-11-24 14:20:54.905738 - Training Epoch: 0 Training Iteration: 416  average_loss : nan  step_loss : nan  learning_rate : 0.001247436532918081 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:56.951023] Finished iteration 416, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2050.987
DLL 2022-11-24 14:20:56.956419 - Training Epoch: 0 Training Iteration: 417  average_loss : nan  step_loss : nan  learning_rate : 0.0012504351784299033 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:20:59.107882] Finished iteration 417, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2156.830
DLL 2022-11-24 14:20:59.113596 - Training Epoch: 0 Training Iteration: 418  average_loss : nan  step_loss : nan  learning_rate : 0.0012534338239417256 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:01.189513] Finished iteration 418, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2081.604
DLL 2022-11-24 14:21:01.194991 - Training Epoch: 0 Training Iteration: 419  average_loss : nan  step_loss : nan  learning_rate : 0.001256432469453548 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:03.268123] Finished iteration 419, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2078.576
DLL 2022-11-24 14:21:03.273795 - Training Epoch: 0 Training Iteration: 420  average_loss : nan  step_loss : nan  learning_rate : 0.00125943111496537 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:05.376380] Finished iteration 420, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2108.270
DLL 2022-11-24 14:21:05.382081 - Training Epoch: 0 Training Iteration: 421  average_loss : nan  step_loss : nan  learning_rate : 0.0012624297604771925 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:07.449334] Finished iteration 421, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2072.890
DLL 2022-11-24 14:21:07.454908 - Training Epoch: 0 Training Iteration: 422  average_loss : nan  step_loss : nan  learning_rate : 0.0012654284059890148 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:09.587192] Finished iteration 422, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2137.846
DLL 2022-11-24 14:21:09.593052 - Training Epoch: 0 Training Iteration: 423  average_loss : nan  step_loss : nan  learning_rate : 0.0012684270515008372 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:11.677654] Finished iteration 423, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2090.472
DLL 2022-11-24 14:21:11.682871 - Training Epoch: 0 Training Iteration: 424  average_loss : nan  step_loss : nan  learning_rate : 0.0012714256970126593 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:13.803109] Finished iteration 424, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2125.346
DLL 2022-11-24 14:21:13.808606 - Training Epoch: 0 Training Iteration: 425  average_loss : nan  step_loss : nan  learning_rate : 0.0012744243425244818 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:15.913533] Finished iteration 425, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2110.399
DLL 2022-11-24 14:21:15.919005 - Training Epoch: 0 Training Iteration: 426  average_loss : nan  step_loss : nan  learning_rate : 0.001277422988036304 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:18.012561] Finished iteration 426, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2098.996
DLL 2022-11-24 14:21:18.018267 - Training Epoch: 0 Training Iteration: 427  average_loss : nan  step_loss : nan  learning_rate : 0.0012804216335481264 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:20.074511] Finished iteration 427, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2061.976
DLL 2022-11-24 14:21:20.079909 - Training Epoch: 0 Training Iteration: 428  average_loss : nan  step_loss : nan  learning_rate : 0.0012834202790599487 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:22.178233] Finished iteration 428, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2103.669
DLL 2022-11-24 14:21:22.183569 - Training Epoch: 0 Training Iteration: 429  average_loss : nan  step_loss : nan  learning_rate : 0.001286418924571771 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:24.227577] Finished iteration 429, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2049.289
DLL 2022-11-24 14:21:24.232796 - Training Epoch: 0 Training Iteration: 430  average_loss : nan  step_loss : nan  learning_rate : 0.0012894175700835931 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:26.326683] Finished iteration 430, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.101
DLL 2022-11-24 14:21:26.331789 - Training Epoch: 0 Training Iteration: 431  average_loss : nan  step_loss : nan  learning_rate : 0.0012924162155954157 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:28.392216] Finished iteration 431, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2065.536
DLL 2022-11-24 14:21:28.397626 - Training Epoch: 0 Training Iteration: 432  average_loss : nan  step_loss : nan  learning_rate : 0.001295414861107238 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:30.480249] Finished iteration 432, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2087.986
DLL 2022-11-24 14:21:30.485732 - Training Epoch: 0 Training Iteration: 433  average_loss : nan  step_loss : nan  learning_rate : 0.00129841350661906 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:32.556664] Finished iteration 433, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2076.346
DLL 2022-11-24 14:21:32.562067 - Training Epoch: 0 Training Iteration: 434  average_loss : nan  step_loss : nan  learning_rate : 0.0013014121521308826 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:34.697902] Finished iteration 434, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2141.264
DLL 2022-11-24 14:21:34.703372 - Training Epoch: 0 Training Iteration: 435  average_loss : nan  step_loss : nan  learning_rate : 0.0013044107976427047 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:36.857201] Finished iteration 435, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2159.237
DLL 2022-11-24 14:21:36.862597 - Training Epoch: 0 Training Iteration: 436  average_loss : nan  step_loss : nan  learning_rate : 0.0013074094431545272 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:39.028766] Finished iteration 436, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2171.502
DLL 2022-11-24 14:21:39.034387 - Training Epoch: 0 Training Iteration: 437  average_loss : nan  step_loss : nan  learning_rate : 0.0013104080886663495 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:41.154000] Finished iteration 437, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2125.197
DLL 2022-11-24 14:21:41.159740 - Training Epoch: 0 Training Iteration: 438  average_loss : nan  step_loss : nan  learning_rate : 0.0013134067341781719 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:43.342229] Finished iteration 438, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2188.200
DLL 2022-11-24 14:21:43.347528 - Training Epoch: 0 Training Iteration: 439  average_loss : nan  step_loss : nan  learning_rate : 0.001316405379689994 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:45.440876] Finished iteration 439, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2098.607
DLL 2022-11-24 14:21:45.446382 - Training Epoch: 0 Training Iteration: 440  average_loss : nan  step_loss : nan  learning_rate : 0.0013194040252018165 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:47.578209] Finished iteration 440, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2137.310
DLL 2022-11-24 14:21:47.583591 - Training Epoch: 0 Training Iteration: 441  average_loss : nan  step_loss : nan  learning_rate : 0.0013224026707136386 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:49.674759] Finished iteration 441, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2096.553
DLL 2022-11-24 14:21:49.680246 - Training Epoch: 0 Training Iteration: 442  average_loss : nan  step_loss : nan  learning_rate : 0.001325401316225461 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:51.804600] Finished iteration 442, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2129.807
DLL 2022-11-24 14:21:51.810101 - Training Epoch: 0 Training Iteration: 443  average_loss : nan  step_loss : nan  learning_rate : 0.0013283999617372834 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:53.886900] Finished iteration 443, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2082.268
DLL 2022-11-24 14:21:53.892092 - Training Epoch: 0 Training Iteration: 444  average_loss : nan  step_loss : nan  learning_rate : 0.0013313986072491057 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:56.013265] Finished iteration 444, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2126.295
DLL 2022-11-24 14:21:56.018647 - Training Epoch: 0 Training Iteration: 445  average_loss : nan  step_loss : nan  learning_rate : 0.001334397252760928 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:21:58.108813] Finished iteration 445, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2095.562
DLL 2022-11-24 14:21:58.114274 - Training Epoch: 0 Training Iteration: 446  average_loss : nan  step_loss : nan  learning_rate : 0.0013373958982727501 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:00.202987] Finished iteration 446, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2094.110
DLL 2022-11-24 14:22:00.208333 - Training Epoch: 0 Training Iteration: 447  average_loss : nan  step_loss : nan  learning_rate : 0.0013403945437845727 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:02.251215] Finished iteration 447, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2048.180
DLL 2022-11-24 14:22:02.256679 - Training Epoch: 0 Training Iteration: 448  average_loss : nan  step_loss : nan  learning_rate : 0.001343393189296395 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:04.358002] Finished iteration 448, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2106.765
DLL 2022-11-24 14:22:04.363479 - Training Epoch: 0 Training Iteration: 449  average_loss : nan  step_loss : nan  learning_rate : 0.001346391834808217 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:06.470121] Finished iteration 449, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2112.072
DLL 2022-11-24 14:22:06.475965 - Training Epoch: 0 Training Iteration: 450  average_loss : nan  step_loss : nan  learning_rate : 0.0013493904803200396 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:08.544496] Finished iteration 450, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2074.372
DLL 2022-11-24 14:22:08.549937 - Training Epoch: 0 Training Iteration: 451  average_loss : nan  step_loss : nan  learning_rate : 0.0013523891258318617 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:10.651919] Finished iteration 451, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2107.400
DLL 2022-11-24 14:22:10.657592 - Training Epoch: 0 Training Iteration: 452  average_loss : nan  step_loss : nan  learning_rate : 0.001355387771343684 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:12.831231] Finished iteration 452, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2179.252
DLL 2022-11-24 14:22:12.836320 - Training Epoch: 0 Training Iteration: 453  average_loss : nan  step_loss : nan  learning_rate : 0.0013583864168555065 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:14.930527] Finished iteration 453, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.271
DLL 2022-11-24 14:22:14.935926 - Training Epoch: 0 Training Iteration: 454  average_loss : nan  step_loss : nan  learning_rate : 0.0013613850623673286 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:17.056987] Finished iteration 454, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2126.416
DLL 2022-11-24 14:22:17.062400 - Training Epoch: 0 Training Iteration: 455  average_loss : nan  step_loss : nan  learning_rate : 0.0013643837078791512 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:19.115204] Finished iteration 455, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2058.192
DLL 2022-11-24 14:22:19.120414 - Training Epoch: 0 Training Iteration: 456  average_loss : nan  step_loss : nan  learning_rate : 0.0013673823533909733 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:21.191483] Finished iteration 456, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2076.257
DLL 2022-11-24 14:22:21.196895 - Training Epoch: 0 Training Iteration: 457  average_loss : nan  step_loss : nan  learning_rate : 0.0013703809989027958 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:24.178056] Finished iteration 457, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2986.540
DLL 2022-11-24 14:22:24.183837 - Training Epoch: 0 Training Iteration: 458  average_loss : nan  step_loss : nan  learning_rate : 0.0013733796444146181 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:26.271235] Finished iteration 458, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2093.141
DLL 2022-11-24 14:22:26.276702 - Training Epoch: 0 Training Iteration: 459  average_loss : nan  step_loss : nan  learning_rate : 0.0013763782899264402 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:28.307633] Finished iteration 459, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2036.370
DLL 2022-11-24 14:22:28.313393 - Training Epoch: 0 Training Iteration: 460  average_loss : nan  step_loss : nan  learning_rate : 0.0013793769354382627 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:30.382344] Finished iteration 460, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2074.678
DLL 2022-11-24 14:22:30.387682 - Training Epoch: 0 Training Iteration: 461  average_loss : nan  step_loss : nan  learning_rate : 0.0013823755809500848 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:32.481400] Finished iteration 461, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2099.033
DLL 2022-11-24 14:22:32.486767 - Training Epoch: 0 Training Iteration: 462  average_loss : nan  step_loss : nan  learning_rate : 0.0013853742264619071 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:34.584627] Finished iteration 462, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2103.185
DLL 2022-11-24 14:22:34.589922 - Training Epoch: 0 Training Iteration: 463  average_loss : nan  step_loss : nan  learning_rate : 0.0013883728719737297 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:36.650409] Finished iteration 463, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2065.760
DLL 2022-11-24 14:22:36.656187 - Training Epoch: 0 Training Iteration: 464  average_loss : nan  step_loss : nan  learning_rate : 0.0013913715174855518 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:38.781324] Finished iteration 464, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2130.870
DLL 2022-11-24 14:22:38.786384 - Training Epoch: 0 Training Iteration: 465  average_loss : nan  step_loss : nan  learning_rate : 0.001394370162997374 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:40.819576] Finished iteration 465, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2038.232
DLL 2022-11-24 14:22:40.824783 - Training Epoch: 0 Training Iteration: 466  average_loss : nan  step_loss : nan  learning_rate : 0.0013973688085091964 
0 Overflow !!
0 : update_scale(): _has_overflow, dynamic. _loss_scale =  1.0
[2022-11-24 14:22:42.939759] Finished iteration 466, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2120.151
DLL 2022-11-24 14:22:42.944858 - Training Epoch: 0 Training Iteration: 467  average_loss : nan  step_loss : nan  learning_rate : 0.0014003674540210187 
0 Overflow !!
Parent process ID: 69668 node: 172.31.28.108
Killing process on gpu with nvidia-smi | grep 'python' | awk '{ print $5 }' | xargs -n1 kill -9
24 cutpoints
Stages 1
13 20868437708.800007
7 13915698585.599995
10 17153729331.199993
8 14622140211.200005
9 15846820659.199995
Predicted microbatch size for 1: 8
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 6 0 1334585.0830078125 0
End of simulation:  Mini-batch time (usec) = 3270291
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 126112, max long fwd 129698; min long bwd 191031, max long bwd 199310
Time taken by simulation: 48 microseconds

Stages 2
13 10987980083.2
19 14996390399.999996
22 16963644723.199997
20 15631126630.400002
Predicted microbatch size for 2: 19
comm size 9961472
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 5 0 608509.5825195312 542254.6839368516
End of simulation:  Mini-batch time (usec) = 3607863
Min send: 10000000, max send 0
Min long send: 542586, max long send 558986
Min fwd: 106816, max fwd 113936; min bwd 154625, max bwd 157669
Min long fwd: 134083, max long fwd 138081; min long bwd 169664, max long bwd 173713
Time taken by simulation: 157 microseconds

Stages 3
13 7832942284.800001
19 10697074380.8
22 12097432473.599998
23 12575272243.2
24 13035207577.6
Predicted microbatch size for 3: 24
comm size 12582912
WARNING: no send time found, 3 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 3 7 0 441679.38232421875 663682.2411979454
End of simulation:  Mini-batch time (usec) = 5526356
Min send: 10000000, max send 0
Min long send: 664014, max long send 688387
Min fwd: 70473, max fwd 86449; min bwd 116125, max bwd 131549
Min long fwd: 107949, max long fwd 111566; min long bwd 147972, max long bwd 154852
Time taken by simulation: 267 microseconds

Stages 4
13 6255423385.6
19 8547416371.2
22 9664326348.8
23 10045446451.2
24 10412856422.4
Predicted microbatch size for 4: 24
comm size 12582912
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 9 0 322485.90087890625 663682.2411979454
End of simulation:  Mini-batch time (usec) = 6859347
Min send: 10000000, max send 0
Min long send: 663764, max long send 686148
Min fwd: 51765, max fwd 67812; min bwd 84974, max bwd 98885
Min long fwd: 83336, max long fwd 90554; min long bwd 118409, max long bwd 124254
Time taken by simulation: 536 microseconds

Stages 6
13 4698582732.8
19 6397758361.599999
22 7231220224.0
23 7515620659.2
24 7790505267.2
Predicted microbatch size for 6: 24
comm size 12582912
WARNING: no send time found, 6 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 6 15 0 205807.43408203125 663682.2411979454
End of simulation:  Mini-batch time (usec) = 11152793
Min send: 10000000, max send 0
Min long send: 663736, max long send 688387
Min fwd: 32603, max fwd 47172; min bwd 54003, max bwd 69793
Min long fwd: 66617, max long fwd 70492; min long bwd 81618, max long bwd 89601
Time taken by simulation: 1281 microseconds

Stages 8
13 3930501529.6000004
19 5322929356.799999
22 6014667161.6
23 6250707763.2
24 6479329689.6
Predicted microbatch size for 8: 24
comm size 12582912
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 22 0 120660.06469726562 663682.2411979454
End of simulation:  Mini-batch time (usec) = 15792286
Min send: 10000000, max send 0
Min long send: 663682, max long send 690844
Min fwd: 23237, max fwd 38139; min bwd 35712, max bwd 56890
Min long fwd: 51613, max long fwd 57677; min long bwd 69478, max long bwd 76496
Time taken by simulation: 2384 microseconds

Stages 12
13 3141742080.0
19 4248100352.0
22 4798114099.200001
23 4985794867.2
24 5168154112.0
Predicted microbatch size for 12: 24
comm size 12582912
WARNING: no send time found, 12 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 12 43 0 0 663682.2411979454
End of simulation:  Mini-batch time (usec) = 28245316
Min send: 10000000, max send 0
Min long send: 663682, max long send 693511
Min fwd: 10606, max fwd 31119; min bwd 22396, max bwd 41317
Min long fwd: 40838, max long fwd 49874; min long bwd 47936, max long bwd 55473
Time taken by simulation: 6961 microseconds

{1: 3.270291, 2: 3.607863, 3: 5.526356, 4: 6.859347, 6: 11.152793, 8: 15.792286, 12: 28.245316}
{1: 8, 2: 19, 3: 24, 4: 24, 6: 24, 8: 24, 12: 24}
best config is: 2 19
expected time is 3.607863
11 per stage
22 servers!
Config:
ranks: range(0, 1)
train batch size: 1024
partitions: 2
chunk_size: 19
data depth: 11
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;
World size is 22
/opt/conda/envs/varuna/bin/python -u /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/run_pretraining.py --rank=0 --chunk_size=19 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21; --batch-size=93 --input_dir=/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/ --output_dir=s3://spot-checkpoints/bert --config_file=bert_config.json --bert_model=bert-large-uncased --train_batch_size=1024 --max_seq_length=128 --max_predictions_per_seq=20 --max_steps=7038 --warmup_proportion=0.2843 --num_steps_per_checkpoint=200 --learning_rate=6e-3 --seed=12439 --fp16 --gradient_accumulation_steps=128 --allreduce_post_accumulation --allreduce_post_accumulation_fp16 --do_train --json-summary /home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json --varuna --resume_step 380
device: cuda:0 n_gpu: 1, distributed training: True, 16-bits training: True
DLL 2022-11-24 14:31:56.730326 - PARAMETER Config : ["Namespace(input_dir='/hdf5_lower_case_1_seq_len_128_max_pred_20_masked_lm_prob_0.15_random_seed_12345_dupe_factor_5/wikicorpus_en/', config_file='bert_config.json', bert_model='bert-large-uncased', output_dir='s3://spot-checkpoints/bert', init_checkpoint=None, max_seq_length=128, max_predictions_per_seq=20, train_batch_size=93, learning_rate=0.006, num_train_epochs=3.0, max_steps=7038.0, warmup_proportion=0.2843, local_rank=0, seed=12439, gradient_accumulation_steps=1, fp16=True, amp=False, loss_scale=0.0, log_freq=1.0, checkpoint_activations=False, resume_from_checkpoint=True, resume_step=380, num_steps_per_checkpoint=200, skip_checkpoint=False, phase2=False, allreduce_post_accumulation=False, allreduce_post_accumulation_fp16=False, phase1_end_step=7038, init_loss_scale=1048576, do_train=True, json_summary='/home/ubuntu/varuna_examples/DeepLearningExamples/PyTorch/LanguageModeling/BERT/results/dllogger.json', use_env=False, disable_progress_bar=False, steps_this_run=7038.0, varuna=True, stage_to_rank_map='0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;', chunk_size=19, batch_size=93, rank=0, profiling=False, n_gpu=1)"] 
dry run time 0.14489030838012695
SHARED WEIGHTS ARE
[(0, 1)]
this rank  0 is part of pipeline replica  0
5 chunks
Begin to load checkpint from s3://spot-checkpoints/bert/ckpt_380.pt
2022-11-24 14:32:07.073451 resume step from  380
Selected optimization level O2:  FP16 training with FP32 batchnorm and FP32 master weights.

Defaults for this optimization level are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
Processing user overrides (additional kwargs that are not None)...
After processing overrides, optimization options are:
enabled                : True
opt_level              : O2
cast_model_type        : torch.float16
patch_torch_functions  : False
keep_batchnorm_fp32    : True
master_weights         : True
loss_scale             : dynamic
