Parent process ID: 64065 node: 172.31.21.254
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 212259.09423828125 0
End of simulation:  Mini-batch time (usec) = 1767241
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 203682; min long bwd 184795, max long bwd 189299
Time taken by simulation: 48 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 42864.17007446289 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2926179
Min send: 10000000, max send 0
Min long send: 340325, max long send 360040
Min fwd: 54106, max fwd 61226; min bwd 79729, max bwd 84071
Min long fwd: 142875, max long fwd 147087; min long bwd 100210, max long bwd 105674
Time taken by simulation: 155 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 5012.969017028809 632152.0801385244
End of simulation:  Mini-batch time (usec) = 8186112
Min send: 10000000, max send 0
Min long send: 632289, max long send 656857
Min fwd: 22997, max fwd 85414; min bwd 32345, max bwd 55249
Min long fwd: 59874, max long fwd 66218; min long bwd 45265, max long bwd 54005
Time taken by simulation: 720 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 32 0 1084.3276977539062 632152.0801385244
End of simulation:  Mini-batch time (usec) = 17887923
Min send: 10000000, max send 0
Min long send: 632168, max long send 660373
Min fwd: 5425, max fwd 48670; min bwd 12684, max bwd 35373
Min long fwd: 26803, max long fwd 34176; min long bwd 16127, max long bwd 25418
Time taken by simulation: 3250 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14241 microseconds

{1: 1.767241, 2: 2.926179, 4: 8.186112, 8: 17.887923, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.926179
9 per stage
18 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 9
stage to rank map: 0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17;
World size is 18
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17; --batch-size=224 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet
[2022-12-01 12:43:20.984072] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 2.081373929977417
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
7 chunks
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 12:43:35.569438] Finished iteration 1, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8421.836
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 12:43:36.503725] Finished iteration 2, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 933.911
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 12:43:37.487189] Finished iteration 3, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 983.437
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-12-01 12:43:38.545878] Finished iteration 4, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1058.666
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-12-01 12:43:40.548269] Finished iteration 5, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2002.416
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-12-01 12:43:41.497851] Finished iteration 6, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 949.476
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  8192.0
[2022-12-01 12:43:42.504420] Finished iteration 7, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1006.586
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  4096.0
[2022-12-01 12:43:43.556401] Finished iteration 8, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1051.917
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  2048.0
[2022-12-01 12:43:44.492127] Finished iteration 9, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 935.788
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  1024.0
[2022-12-01 12:43:27.135404] Epoch: [0][ 10/223]	Time  1.018 ( 1.836)	Data  0.005 ( 0.209)	Loss 7.0647e+00 (7.0838e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:43:45.511784] Finished iteration 10, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1019.593
[2022-12-01 12:43:46.532582] Finished iteration 11, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1020.816
[2022-12-01 12:43:47.497905] Finished iteration 12, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 965.174
[2022-12-01 12:43:48.440973] Finished iteration 13, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 943.051
[2022-12-01 12:43:49.393469] Finished iteration 14, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 952.437
[2022-12-01 12:43:50.332015] Finished iteration 15, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 938.499
[2022-12-01 12:43:51.378462] Finished iteration 16, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1046.400
[2022-12-01 12:43:52.292171] Finished iteration 17, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 913.684
[2022-12-01 12:43:53.249341] Finished iteration 18, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 957.116
[2022-12-01 12:43:54.237282] Finished iteration 19, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 987.902
[2022-12-01 12:43:27.135404] Epoch: [0][ 20/223]	Time  0.946 ( 1.401)	Data  0.005 ( 0.107)	Loss 4.7801e+00 (6.0995e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:43:55.182587] Finished iteration 20, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 945.274
[2022-12-01 12:43:56.987307] Finished iteration 21, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1804.682
[2022-12-01 12:43:58.066434] Finished iteration 22, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1079.089
[2022-12-01 12:43:59.004807] Finished iteration 23, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 938.431
[2022-12-01 12:44:00.005578] Finished iteration 24, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1000.635
[2022-12-01 12:44:01.042597] Finished iteration 25, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1036.977
[2022-12-01 12:44:02.026926] Finished iteration 26, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 984.289
[2022-12-01 12:44:02.963521] Finished iteration 27, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 936.564
[2022-12-01 12:44:03.890010] Finished iteration 28, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 926.444
[2022-12-01 12:44:04.878868] Finished iteration 29, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 988.834
[2022-12-01 12:43:27.135404] Epoch: [0][ 30/223]	Time  0.905 ( 1.288)	Data  0.003 ( 0.073)	Loss 4.7076e+00 (5.6445e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:44:05.783623] Finished iteration 30, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 904.682
[2022-12-01 12:44:06.802702] Finished iteration 31, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1019.072
[2022-12-01 12:44:07.733616] Finished iteration 32, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 930.887
[2022-12-01 12:44:08.702632] Finished iteration 33, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 968.967
[2022-12-01 12:44:09.685208] Finished iteration 34, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 982.533
[2022-12-01 12:44:10.643214] Finished iteration 35, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 957.968
[2022-12-01 12:44:11.614304] Finished iteration 36, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 971.052
[2022-12-01 12:44:12.611245] Finished iteration 37, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 996.913
[2022-12-01 12:44:13.650799] Finished iteration 38, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1039.515
[2022-12-01 12:44:14.700928] Finished iteration 39, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1050.151
[2022-12-01 12:43:27.135404] Epoch: [0][ 40/223]	Time  1.031 ( 1.214)	Data  0.006 ( 0.056)	Loss 4.6652e+00 (5.4023e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:44:15.730900] Finished iteration 40, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1029.867
[2022-12-01 12:44:16.709578] Finished iteration 41, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 978.648
[2022-12-01 12:44:17.695905] Finished iteration 42, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 986.405
[2022-12-01 12:44:18.676442] Finished iteration 43, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 980.379
[2022-12-01 12:44:19.635815] Finished iteration 44, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 959.423
[2022-12-01 12:44:20.667864] Finished iteration 45, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1031.951
[2022-12-01 12:44:21.634686] Finished iteration 46, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 966.832
[2022-12-01 12:44:22.647754] Finished iteration 47, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1012.961
[2022-12-01 12:44:23.590041] Finished iteration 48, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 942.246
[2022-12-01 12:44:24.638548] Finished iteration 49, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1048.467
[2022-12-01 12:43:27.135404] Epoch: [0][ 50/223]	Time  0.958 ( 1.169)	Data  0.004 ( 0.046)	Loss 4.6440e+00 (5.2506e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:44:25.599153] Finished iteration 50, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.562
[2022-12-01 12:44:26.601602] Finished iteration 51, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1002.419
[2022-12-01 12:44:27.551680] Finished iteration 52, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 950.046
[2022-12-01 12:44:28.474881] Finished iteration 53, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 923.147
[2022-12-01 12:44:29.464970] Finished iteration 54, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.098
[2022-12-01 12:44:30.405047] Finished iteration 55, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 940.035
[2022-12-01 12:44:31.432842] Finished iteration 56, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1027.790
[2022-12-01 12:44:32.481983] Finished iteration 57, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1049.033
[2022-12-01 12:44:33.516379] Finished iteration 58, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1034.359
[2022-12-01 12:44:34.466464] Finished iteration 59, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 950.045
[2022-12-01 12:43:27.135404] Epoch: [0][ 60/223]	Time  0.946 ( 1.138)	Data  0.003 ( 0.039)	Loss 4.6518e+00 (5.1507e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:44:35.415560] Finished iteration 60, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 949.051
[2022-12-01 12:44:36.381975] Finished iteration 61, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 966.377
[2022-12-01 12:44:37.354345] Finished iteration 62, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 972.407
[2022-12-01 12:44:38.310325] Finished iteration 63, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 955.869
[2022-12-01 12:44:39.305450] Finished iteration 64, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 995.083
[2022-12-01 12:44:40.220201] Finished iteration 65, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 914.716
[2022-12-01 12:44:41.215216] Finished iteration 66, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 994.997
[2022-12-01 12:44:42.189495] Finished iteration 67, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 974.218
[2022-12-01 12:44:43.125954] Finished iteration 68, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 936.424
[2022-12-01 12:44:44.077309] Finished iteration 69, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 951.311
[2022-12-01 12:43:27.135404] Epoch: [0][ 70/223]	Time  0.988 ( 1.113)	Data  0.008 ( 0.034)	Loss 4.6010e+00 (5.0759e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:44:45.060621] Finished iteration 70, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 983.258
[2022-12-01 12:44:46.021302] Finished iteration 71, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.665
[2022-12-01 12:44:47.009355] Finished iteration 72, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 988.036
[2022-12-01 12:44:47.929863] Finished iteration 73, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 920.483
[2022-12-01 12:44:48.904390] Finished iteration 74, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 974.434
[2022-12-01 12:44:49.889904] Finished iteration 75, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 985.554
[2022-12-01 12:44:50.895924] Finished iteration 76, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1005.913
[2022-12-01 12:44:51.831336] Finished iteration 77, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 935.378
[2022-12-01 12:44:52.784099] Finished iteration 78, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 952.723
[2022-12-01 12:44:53.768895] Finished iteration 79, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 984.852
[2022-12-01 12:43:27.135404] Epoch: [0][ 80/223]	Time  0.941 ( 1.094)	Data  0.004 ( 0.030)	Loss 4.6373e+00 (5.0221e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:44:54.709501] Finished iteration 80, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 940.467
[2022-12-01 12:44:55.658311] Finished iteration 81, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 948.785
[2022-12-01 12:44:56.626281] Finished iteration 82, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 968.004
[2022-12-01 12:44:57.587160] Finished iteration 83, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.776
[2022-12-01 12:44:58.559791] Finished iteration 84, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 972.588
[2022-12-01 12:44:59.501366] Finished iteration 85, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 941.548
[2022-12-01 12:45:00.511033] Finished iteration 86, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1009.627
[2022-12-01 12:45:01.519238] Finished iteration 87, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1008.186
[2022-12-01 12:45:02.465761] Finished iteration 88, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 946.462
[2022-12-01 12:45:03.395501] Finished iteration 89, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 929.770
[2022-12-01 12:43:27.135404] Epoch: [0][ 90/223]	Time  0.979 ( 1.080)	Data  0.004 ( 0.027)	Loss 4.6194e+00 (4.9784e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:45:04.373413] Finished iteration 90, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 977.772
[2022-12-01 12:45:05.421145] Finished iteration 91, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1047.706
[2022-12-01 12:45:06.405418] Finished iteration 92, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 984.242
[2022-12-01 12:45:07.373678] Finished iteration 93, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 968.223
[2022-12-01 12:45:08.358275] Finished iteration 94, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 984.564
[2022-12-01 12:45:09.358971] Finished iteration 95, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1000.661
[2022-12-01 12:45:10.299742] Finished iteration 96, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 940.727
[2022-12-01 12:45:11.265504] Finished iteration 97, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 965.834
[2022-12-01 12:45:12.280175] Finished iteration 98, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1014.513
[2022-12-01 12:45:13.219865] Finished iteration 99, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 939.672
[2022-12-01 12:43:27.135404] Epoch: [0][100/223]	Time  0.971 ( 1.070)	Data  0.003 ( 0.025)	Loss 4.6261e+00 (4.9441e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:45:14.193885] Finished iteration 100, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 973.949
[2022-12-01 12:45:15.196584] Finished iteration 101, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1002.784
[2022-12-01 12:45:16.206380] Finished iteration 102, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1009.665
[2022-12-01 12:45:17.217420] Finished iteration 103, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1010.984
[2022-12-01 12:45:18.207221] Finished iteration 104, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 989.784
[2022-12-01 12:45:19.175136] Finished iteration 105, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 967.874
[2022-12-01 12:45:20.203224] Finished iteration 106, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1028.041
[2022-12-01 12:45:21.129999] Finished iteration 107, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 926.730
[2022-12-01 12:45:22.165799] Finished iteration 108, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1035.782
[2022-12-01 12:45:23.164648] Finished iteration 109, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 998.801
[2022-12-01 12:43:27.135404] Epoch: [0][110/223]	Time  0.977 ( 1.064)	Data  0.003 ( 0.023)	Loss 4.6334e+00 (4.9158e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:45:24.142608] Finished iteration 110, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 978.012
[2022-12-01 12:45:25.133846] Finished iteration 111, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 991.125
[2022-12-01 12:45:26.111998] Finished iteration 112, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 978.096
[2022-12-01 12:45:27.095591] Finished iteration 113, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 983.556
[2022-12-01 12:45:28.074149] Finished iteration 114, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 978.525
[2022-12-01 12:45:28.997944] Finished iteration 115, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 923.750
[2022-12-01 12:45:29.957990] Finished iteration 116, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.004
[2022-12-01 12:45:30.900465] Finished iteration 117, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 942.431
[2022-12-01 12:45:31.873902] Finished iteration 118, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 973.433
[2022-12-01 12:45:32.856310] Finished iteration 119, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 982.360
[2022-12-01 12:43:27.135404] Epoch: [0][120/223]	Time  1.017 ( 1.056)	Data  0.003 ( 0.021)	Loss 4.6306e+00 (4.8921e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:45:33.875144] Finished iteration 120, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1018.776
[2022-12-01 12:45:34.789209] Finished iteration 121, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 914.029
[2022-12-01 12:45:35.705354] Finished iteration 122, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 916.103
[2022-12-01 12:45:36.751066] Finished iteration 123, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1045.674
[2022-12-01 12:45:37.727200] Finished iteration 124, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 976.096
[2022-12-01 12:45:38.709510] Finished iteration 125, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 982.273
[2022-12-01 12:45:39.744565] Finished iteration 126, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1035.061
[2022-12-01 12:45:40.795185] Finished iteration 127, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1050.539
[2022-12-01 12:45:41.704007] Finished iteration 128, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 908.787
[2022-12-01 12:45:42.664448] Finished iteration 129, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.393
[2022-12-01 12:43:27.135404] Epoch: [0][130/223]	Time  1.023 ( 1.050)	Data  0.003 ( 0.020)	Loss 4.6345e+00 (4.8722e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:45:43.687937] Finished iteration 130, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1023.448
[2022-12-01 12:45:44.690572] Finished iteration 131, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1002.628
[2022-12-01 12:45:45.654148] Finished iteration 132, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 963.525
[2022-12-01 12:45:46.644362] Finished iteration 133, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.212
[2022-12-01 12:45:47.622214] Finished iteration 134, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 977.789
[2022-12-01 12:45:48.624431] Finished iteration 135, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1002.174
[2022-12-01 12:45:49.531596] Finished iteration 136, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 907.120
[2022-12-01 12:45:50.551835] Finished iteration 137, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1020.216
[2022-12-01 12:45:51.475057] Finished iteration 138, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 923.171
[2022-12-01 12:45:52.447882] Finished iteration 139, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 972.793
[2022-12-01 12:43:27.135404] Epoch: [0][140/223]	Time  1.004 ( 1.045)	Data  0.008 ( 0.019)	Loss 4.6629e+00 (4.8552e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:45:53.446290] Finished iteration 140, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 998.363
[2022-12-01 12:45:54.398564] Finished iteration 141, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 952.265
[2022-12-01 12:45:55.377028] Finished iteration 142, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 978.455
[2022-12-01 12:45:56.434773] Finished iteration 143, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1057.666
[2022-12-01 12:45:57.378290] Finished iteration 144, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 943.547
[2022-12-01 12:45:58.355547] Finished iteration 145, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 977.195
[2022-12-01 12:45:59.332149] Finished iteration 146, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 976.547
[2022-12-01 12:46:00.284499] Finished iteration 147, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 952.290
[2022-12-01 12:46:01.222125] Finished iteration 148, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 937.563
[2022-12-01 12:46:02.181977] Finished iteration 149, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 959.900
[2022-12-01 12:43:27.135404] Epoch: [0][150/223]	Time  0.971 ( 1.040)	Data  0.007 ( 0.018)	Loss 4.6300e+00 (4.8402e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:46:03.149258] Finished iteration 150, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 967.151
[2022-12-01 12:46:04.125165] Finished iteration 151, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 975.890
[2022-12-01 12:46:05.206370] Finished iteration 152, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1081.156
[2022-12-01 12:46:06.176316] Finished iteration 153, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 969.907
[2022-12-01 12:46:07.099083] Finished iteration 154, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 922.735
[2022-12-01 12:46:08.027489] Finished iteration 155, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 928.355
[2022-12-01 12:46:08.996342] Finished iteration 156, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 968.812
[2022-12-01 12:46:09.929131] Finished iteration 157, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 932.750
[2022-12-01 12:46:10.899565] Finished iteration 158, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 970.408
[2022-12-01 12:46:11.877575] Finished iteration 159, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 977.951
[2022-12-01 12:43:27.135404] Epoch: [0][160/223]	Time  0.958 ( 1.035)	Data  0.008 ( 0.017)	Loss 4.6189e+00 (4.8268e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:46:12.832382] Finished iteration 160, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 954.767
[2022-12-01 12:46:13.726148] Finished iteration 161, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 893.741
[2022-12-01 12:46:14.661066] Finished iteration 162, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 934.917
[2022-12-01 12:46:15.679161] Finished iteration 163, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1018.075
[2022-12-01 12:46:16.622167] Finished iteration 164, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 943.007
[2022-12-01 12:46:17.642604] Finished iteration 165, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1020.361
[2022-12-01 12:46:18.657779] Finished iteration 166, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1015.082
[2022-12-01 12:46:19.595949] Finished iteration 167, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 938.136
[2022-12-01 12:46:20.534099] Finished iteration 168, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 938.101
[2022-12-01 12:46:21.516459] Finished iteration 169, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 982.325
[2022-12-01 12:43:27.135404] Epoch: [0][170/223]	Time  0.932 ( 1.031)	Data  0.004 ( 0.017)	Loss 4.6323e+00 (4.8151e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:46:22.447849] Finished iteration 170, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 931.407
[2022-12-01 12:46:23.368722] Finished iteration 171, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 920.787
[2022-12-01 12:46:24.316357] Finished iteration 172, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 947.586
[2022-12-01 12:46:25.330678] Finished iteration 173, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1014.287
[2022-12-01 12:46:26.355737] Finished iteration 174, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1025.022
[2022-12-01 12:46:27.380716] Finished iteration 175, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1024.958
[2022-12-01 12:46:28.349100] Finished iteration 176, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 968.332
[2022-12-01 12:46:29.314218] Finished iteration 177, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 965.086
[2022-12-01 12:46:30.359183] Finished iteration 178, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1044.980
[2022-12-01 12:46:31.411106] Finished iteration 179, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1051.829
[2022-12-01 12:43:27.135404] Epoch: [0][180/223]	Time  0.983 ( 1.029)	Data  0.003 ( 0.016)	Loss 4.6501e+00 (4.8048e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:46:32.399706] Finished iteration 180, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 988.546
[2022-12-01 12:46:33.382000] Finished iteration 181, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 982.296
[2022-12-01 12:46:34.330731] Finished iteration 182, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 948.672
[2022-12-01 12:46:35.384943] Finished iteration 183, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1054.205
[2022-12-01 12:46:36.327561] Finished iteration 184, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 942.549
[2022-12-01 12:46:37.318569] Finished iteration 185, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.950
[2022-12-01 12:46:38.406135] Finished iteration 186, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1087.532
[2022-12-01 12:46:39.330059] Finished iteration 187, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 923.885
[2022-12-01 12:46:40.319763] Finished iteration 188, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 989.664
[2022-12-01 12:46:41.299196] Finished iteration 189, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 979.400
[2022-12-01 12:43:27.135404] Epoch: [0][190/223]	Time  1.064 ( 1.027)	Data  0.003 ( 0.015)	Loss 4.6150e+00 (4.7956e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:46:42.366831] Finished iteration 190, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1067.590
[2022-12-01 12:46:43.300155] Finished iteration 191, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 933.302
[2022-12-01 12:46:44.273509] Finished iteration 192, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 973.323
[2022-12-01 12:46:45.283345] Finished iteration 193, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1009.827
[2022-12-01 12:46:46.242481] Finished iteration 194, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 959.069
[2022-12-01 12:46:47.236662] Finished iteration 195, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 994.147
[2022-12-01 12:46:48.181391] Finished iteration 196, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 944.723
[2022-12-01 12:46:49.076740] Finished iteration 197, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 895.281
[2022-12-01 12:46:50.009345] Finished iteration 198, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 932.578
[2022-12-01 12:46:50.954729] Finished iteration 199, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 945.308
[2022-12-01 12:43:27.135404] Epoch: [0][200/223]	Time  0.997 ( 1.024)	Data  0.004 ( 0.015)	Loss 4.6127e+00 (4.7873e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:46:51.954876] Finished iteration 200, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1000.115
[2022-12-01 12:46:52.959211] Finished iteration 201, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1004.336
[2022-12-01 12:46:53.943491] Finished iteration 202, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 984.215
[2022-12-01 12:46:54.906057] Finished iteration 203, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 962.517
[2022-12-01 12:46:55.811589] Finished iteration 204, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 905.492
[2022-12-01 12:46:56.771018] Finished iteration 205, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 959.399
[2022-12-01 12:46:57.799973] Finished iteration 206, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1028.909
[2022-12-01 12:46:58.790984] Finished iteration 207, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.977
[2022-12-01 12:46:59.763042] Finished iteration 208, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 972.017
[2022-12-01 12:47:00.719410] Finished iteration 209, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 956.326
[2022-12-01 12:43:27.135404] Epoch: [0][210/223]	Time  0.953 ( 1.022)	Data  0.003 ( 0.014)	Loss 4.6049e+00 (4.7795e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:47:01.672592] Finished iteration 210, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 953.164
[2022-12-01 12:47:02.624183] Finished iteration 211, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 951.550
[2022-12-01 12:47:03.631320] Finished iteration 212, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1007.101
[2022-12-01 12:47:04.594233] Finished iteration 213, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 962.872
[2022-12-01 12:47:05.599960] Finished iteration 214, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1005.684
[2022-12-01 12:47:06.616122] Finished iteration 215, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1016.130
[2022-12-01 12:47:07.578306] Finished iteration 216, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 962.148
[2022-12-01 12:47:08.468936] Finished iteration 217, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 890.620
[2022-12-01 12:47:09.423127] Finished iteration 218, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 954.224
Opt ckpt time 3.510359764099121
Process done with return code 0
Parent process ID: 64911 node: 172.31.21.254
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 223272.43041992188 0
End of simulation:  Mini-batch time (usec) = 1778254
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 203682; min long bwd 184795, max long bwd 189299
Time taken by simulation: 40 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 43248.783111572266 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2650457
Min send: 10000000, max send 0
Min long send: 340325, max long send 353077
Min fwd: 55034, max fwd 61226; min bwd 80998, max bwd 85047
Min long fwd: 142036, max long fwd 146868; min long bwd 99967, max long bwd 105642
Time taken by simulation: 144 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 6158.940315246582 632152.0801385244
End of simulation:  Mini-batch time (usec) = 7083334
Min send: 10000000, max send 0
Min long send: 632234, max long send 656857
Min fwd: 23449, max fwd 84148; min bwd 32759, max bwd 57093
Min long fwd: 59594, max long fwd 67404; min long bwd 46137, max long bwd 54005
Time taken by simulation: 581 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 32 0 1084.3276977539062 632152.0801385244
End of simulation:  Mini-batch time (usec) = 17887923
Min send: 10000000, max send 0
Min long send: 632168, max long send 660373
Min fwd: 5425, max fwd 48670; min bwd 12684, max bwd 35373
Min long fwd: 26803, max long fwd 34176; min long bwd 16127, max long bwd 25418
Time taken by simulation: 3230 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14199 microseconds

{1: 1.778254, 2: 2.650457, 4: 7.083334, 8: 17.887923, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.650457
10 per stage
20 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet --resume_step 218
[2022-12-01 12:47:30.890386] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 0.8455095291137695
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
7 chunks
>>>>> [2022-12-01 12:48:19.342605] Time taken to load checkpoint: 43.469s
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 12:48:28.364233] Finished iteration 219, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9016.350
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 12:48:19.342833] Epoch: [0][220/223]	Time  1.006 ( 5.009)	Data  0.005 ( 0.740)	Loss 4.6378e+00 (4.6356e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:48:30.393792] Finished iteration 220, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2029.287
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 12:48:32.363872] Finished iteration 221, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1969.990
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-12-01 12:48:34.408336] Finished iteration 222, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2044.446
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-12-01 12:48:36.445212] Finished iteration 223, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2036.851
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-12-01 12:48:37.467290] Finished iteration 224, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1021.982
[2022-12-01 12:48:38.465756] Finished iteration 225, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 998.429
[2022-12-01 12:48:39.428715] Finished iteration 226, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 962.896
[2022-12-01 12:48:40.372457] Finished iteration 227, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 943.708
[2022-12-01 12:48:41.318670] Finished iteration 228, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 946.178
[2022-12-01 12:48:42.352802] Finished iteration 229, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1034.092
[2022-12-01 12:48:19.342833] Epoch: [0][230/223]	Time  1.018 ( 2.002)	Data  0.003 ( 0.300)	Loss 4.6356e+00 (4.6323e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:48:43.372600] Finished iteration 230, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1019.832
[2022-12-01 12:48:44.660233] Finished iteration 231, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1287.562
[2022-12-01 12:48:45.999099] Finished iteration 232, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1338.804
[2022-12-01 12:48:46.935502] Finished iteration 233, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 936.375
[2022-12-01 12:48:48.027281] Finished iteration 234, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1091.736
[2022-12-01 12:48:49.008518] Finished iteration 235, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 981.196
[2022-12-01 12:48:50.052627] Finished iteration 236, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1044.065
[2022-12-01 12:48:51.020689] Finished iteration 237, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 968.016
[2022-12-01 12:48:51.999979] Finished iteration 238, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 979.254
[2022-12-01 12:48:52.980053] Finished iteration 239, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 980.033
[2022-12-01 12:48:19.342833] Epoch: [0][240/223]	Time  0.948 ( 1.572)	Data  0.004 ( 0.166)	Loss 4.6261e+00 (4.6294e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:48:53.927571] Finished iteration 240, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 947.474
[2022-12-01 12:48:54.975075] Finished iteration 241, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1047.486
[2022-12-01 12:48:57.042385] Finished iteration 242, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2067.269
[2022-12-01 12:48:58.027112] Finished iteration 243, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 984.688
[2022-12-01 12:48:58.996174] Finished iteration 244, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 969.020
[2022-12-01 12:48:59.976758] Finished iteration 245, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 980.540
[2022-12-01 12:49:00.970272] Finished iteration 246, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 993.484
[2022-12-01 12:49:01.934480] Finished iteration 247, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 964.164
[2022-12-01 12:49:02.944395] Finished iteration 248, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1009.873
[2022-12-01 12:49:03.920388] Finished iteration 249, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 975.946
[2022-12-01 12:48:19.342833] Epoch: [0][250/223]	Time  0.964 ( 1.423)	Data  0.004 ( 0.116)	Loss 4.6172e+00 (4.6264e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:49:04.884367] Finished iteration 250, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 963.937
[2022-12-01 12:49:05.871217] Finished iteration 251, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 986.850
[2022-12-01 12:49:06.825487] Finished iteration 252, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 954.211
[2022-12-01 12:49:07.917352] Finished iteration 253, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1091.815
[2022-12-01 12:49:08.950283] Finished iteration 254, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1032.907
[2022-12-01 12:49:09.986550] Finished iteration 255, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 1036.212
Opt ckpt time 4.16059684753418
Process done with return code 0
Parent process ID: 66027 node: 172.31.21.254
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 219918.88427734375 0
End of simulation:  Mini-batch time (usec) = 1774900
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 203682; min long bwd 184795, max long bwd 189299
Time taken by simulation: 48 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 7 0 43248.783111572266 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2650457
Min send: 10000000, max send 0
Min long send: 340325, max long send 353077
Min fwd: 55034, max fwd 61226; min bwd 80998, max bwd 85047
Min long fwd: 142036, max long fwd 146868; min long bwd 99967, max long bwd 105642
Time taken by simulation: 156 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 6158.940315246582 632152.0801385244
End of simulation:  Mini-batch time (usec) = 7083334
Min send: 10000000, max send 0
Min long send: 632234, max long send 656857
Min fwd: 23449, max fwd 84148; min bwd 32759, max bwd 57093
Min long fwd: 59594, max long fwd 67404; min long bwd 46137, max long bwd 54005
Time taken by simulation: 591 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 32 0 1084.3276977539062 632152.0801385244
End of simulation:  Mini-batch time (usec) = 17887923
Min send: 10000000, max send 0
Min long send: 632168, max long send 660373
Min fwd: 5425, max fwd 48670; min bwd 12684, max bwd 35373
Min long fwd: 26803, max long fwd 34176; min long bwd 16127, max long bwd 25418
Time taken by simulation: 3279 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14415 microseconds

{1: 1.7749, 2: 2.650457, 4: 7.083334, 8: 17.887923, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.650457
10 per stage
20 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 10
stage to rank map: 0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19;
World size is 20
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18;1,3,5,7,9,11,13,15,17,19; --batch-size=224 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet --resume_step 255
[2022-12-01 12:49:32.084105] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 0.8267855644226074
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
7 chunks
>>>>> [2022-12-01 12:50:16.977893] Time taken to load checkpoint: 39.973s
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 17 signal handler called with signal 10
2022-12-01 12:50:29.312460 Begin to exit
Process done with return code 0
Parent process ID: 67040 node: 172.31.21.254
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 222329.60510253906 0
End of simulation:  Mini-batch time (usec) = 1388834
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 202566; min long bwd 185117, max long bwd 189299
Time taken by simulation: 45 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 44736.85073852539 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2419467
Min send: 10000000, max send 0
Min long send: 340325, max long send 353077
Min fwd: 55034, max fwd 61226; min bwd 80998, max bwd 85047
Min long fwd: 142688, max long fwd 147468; min long bwd 99967, max long bwd 105261
Time taken by simulation: 130 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 6158.940315246582 632152.0801385244
End of simulation:  Mini-batch time (usec) = 7083334
Min send: 10000000, max send 0
Min long send: 632234, max long send 656857
Min fwd: 23449, max fwd 84148; min bwd 32759, max bwd 57093
Min long fwd: 59594, max long fwd 67404; min long bwd 46137, max long bwd 54005
Time taken by simulation: 587 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 32 0 1084.3276977539062 632152.0801385244
End of simulation:  Mini-batch time (usec) = 17887923
Min send: 10000000, max send 0
Min long send: 632168, max long send 660373
Min fwd: 5425, max fwd 48670; min bwd 12684, max bwd 35373
Min long fwd: 26803, max long fwd 34176; min long bwd 16127, max long bwd 25418
Time taken by simulation: 3228 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14238 microseconds

{1: 1.388834, 2: 2.419467, 4: 7.083334, 8: 17.887923, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.419467
11 per stage
22 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 11
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;
World size is 22
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21; --batch-size=192 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet --resume_step 255
[2022-12-01 12:50:40.719769] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 0.9607610702514648
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
6 chunks
>>>>> [2022-12-01 12:51:27.455412] Time taken to load checkpoint: 41.631s
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 12:51:47.900071] Finished iteration 256, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 8316.205
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 12:51:49.813794] Finished iteration 257, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1913.364
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 12:51:51.756482] Finished iteration 258, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1942.632
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-12-01 12:51:53.637388] Finished iteration 259, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1880.852
[2022-12-01 12:51:27.455644] Epoch: [0][260/260]	Time  1.955 ( 3.196)	Data  0.030 ( 0.453)	Loss 4.6263e+00 (4.6195e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:51:55.575523] Finished iteration 260, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1938.083
[2022-12-01 12:51:56.444898] Finished iteration 261, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 869.379
[2022-12-01 12:51:57.314273] Finished iteration 262, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 869.298
[2022-12-01 12:51:58.171578] Finished iteration 263, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 857.267
[2022-12-01 12:51:59.008109] Finished iteration 264, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 836.496
[2022-12-01 12:51:59.868685] Finished iteration 265, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 860.553
[2022-12-01 12:52:00.736731] Finished iteration 266, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 867.981
[2022-12-01 12:52:01.556569] Finished iteration 267, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 819.808
[2022-12-01 12:52:02.393231] Finished iteration 268, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 836.621
[2022-12-01 12:52:03.238554] Finished iteration 269, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 845.288
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-12-01 12:51:27.455644] Epoch: [0][270/260]	Time  0.827 ( 1.632)	Data  0.004 ( 0.154)	Loss 4.6159e+00 (4.6247e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:52:04.065867] Finished iteration 270, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 827.274
[2022-12-01 12:52:04.906631] Finished iteration 271, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 840.747
[2022-12-01 12:52:05.830060] Finished iteration 272, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 923.398
[2022-12-01 12:52:06.713865] Finished iteration 273, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 883.760
[2022-12-01 12:52:07.587906] Finished iteration 274, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 874.002
[2022-12-01 12:52:08.433272] Finished iteration 275, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 845.327
[2022-12-01 12:52:09.317547] Finished iteration 276, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 884.223
[2022-12-01 12:52:10.200799] Finished iteration 277, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 883.210
[2022-12-01 12:52:11.088214] Finished iteration 278, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 887.380
[2022-12-01 12:52:11.957113] Finished iteration 279, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 868.867
[2022-12-01 12:51:27.455644] Epoch: [0][280/260]	Time  0.850 ( 1.329)	Data  0.004 ( 0.094)	Loss 4.6152e+00 (4.6220e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:52:12.807012] Finished iteration 280, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 849.862
[2022-12-01 12:52:13.660208] Finished iteration 281, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 853.182
[2022-12-01 12:52:14.540437] Finished iteration 282, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 880.188
[2022-12-01 12:52:15.427880] Finished iteration 283, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 887.392
[2022-12-01 12:52:16.306432] Finished iteration 284, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 878.539
[2022-12-01 12:52:17.123581] Finished iteration 285, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 817.085
[2022-12-01 12:52:18.016866] Finished iteration 286, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 893.281
[2022-12-01 12:52:18.892734] Finished iteration 287, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 875.792
[2022-12-01 12:52:19.770080] Finished iteration 288, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 877.314
[2022-12-01 12:52:20.644491] Finished iteration 289, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 874.368
[2022-12-01 12:51:27.455644] Epoch: [0][290/260]	Time  0.869 ( 1.198)	Data  0.004 ( 0.068)	Loss 4.6296e+00 (4.6228e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:52:21.513617] Finished iteration 290, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 869.085
[2022-12-01 12:52:22.368803] Finished iteration 291, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 855.166
[2022-12-01 12:52:23.260172] Finished iteration 292, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 891.340
[2022-12-01 12:52:24.125936] Finished iteration 293, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 865.718
[2022-12-01 12:52:25.015670] Finished iteration 294, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 889.684
[2022-12-01 12:52:25.894563] Finished iteration 295, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 878.863
[2022-12-01 12:52:26.756043] Finished iteration 296, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 861.456
[2022-12-01 12:52:27.626480] Finished iteration 297, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 870.373
[2022-12-01 12:52:28.523964] Finished iteration 298, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 897.455
[2022-12-01 12:52:29.405197] Finished iteration 299, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 881.193
[2022-12-01 12:51:27.455644] Epoch: [0][300/260]	Time  0.845 ( 1.126)	Data  0.004 ( 0.054)	Loss 4.6217e+00 (4.6218e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:52:30.250599] Finished iteration 300, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 845.359
[2022-12-01 12:52:31.077619] Finished iteration 301, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 827.000
[2022-12-01 12:52:31.899502] Finished iteration 302, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 821.841
[2022-12-01 12:52:32.806937] Finished iteration 303, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 907.398
[2022-12-01 12:52:33.682478] Finished iteration 304, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 875.501
[2022-12-01 12:52:34.561218] Finished iteration 305, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 878.704
[2022-12-01 12:52:35.393940] Finished iteration 306, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 832.680
[2022-12-01 12:52:36.222083] Finished iteration 307, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 828.110
[2022-12-01 12:52:37.088893] Finished iteration 308, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.815
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  16384.0
[2022-12-01 12:52:37.935210] Finished iteration 309, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 846.245
[2022-12-01 12:51:27.455644] Epoch: [0][310/260]	Time  0.867 ( 1.077)	Data  0.004 ( 0.045)	Loss 4.6211e+00 (4.6208e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:52:38.802485] Finished iteration 310, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 867.232
[2022-12-01 12:52:39.678726] Finished iteration 311, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 876.213
[2022-12-01 12:52:40.519805] Finished iteration 312, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 841.047
[2022-12-01 12:52:41.339948] Finished iteration 313, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 820.099
[2022-12-01 12:52:42.287221] Finished iteration 314, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 947.234
[2022-12-01 12:52:44.171916] Finished iteration 315, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1884.657
[2022-12-01 12:52:45.015060] Finished iteration 316, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 843.104
[2022-12-01 12:52:45.880630] Finished iteration 317, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 865.525
[2022-12-01 12:52:46.736441] Finished iteration 318, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 855.775
[2022-12-01 12:52:47.626919] Finished iteration 319, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 890.459
[2022-12-01 12:51:27.455644] Epoch: [0][320/260]	Time  0.878 ( 1.060)	Data  0.004 ( 0.039)	Loss 4.6211e+00 (4.6210e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:52:48.504953] Finished iteration 320, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 878.019
[2022-12-01 12:52:49.337906] Finished iteration 321, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 832.886
[2022-12-01 12:52:50.224599] Finished iteration 322, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 886.659
[2022-12-01 12:52:51.109819] Finished iteration 323, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 885.178
[2022-12-01 12:52:51.957912] Finished iteration 324, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 848.076
[2022-12-01 12:52:52.791987] Finished iteration 325, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 834.014
[2022-12-01 12:52:53.659149] Finished iteration 326, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 867.125
[2022-12-01 12:52:54.617141] Finished iteration 327, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 957.961
[2022-12-01 12:52:55.627523] Finished iteration 328, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1010.359
[2022-12-01 12:52:56.482598] Finished iteration 329, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 855.015
[2022-12-01 12:51:27.455644] Epoch: [0][330/260]	Time  0.850 ( 1.037)	Data  0.004 ( 0.035)	Loss 4.6133e+00 (4.6205e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:52:57.332471] Finished iteration 330, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 849.830
[2022-12-01 12:52:58.192888] Finished iteration 331, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 860.456
[2022-12-01 12:52:59.064951] Finished iteration 332, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 872.010
[2022-12-01 12:52:59.923074] Finished iteration 333, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 858.043
[2022-12-01 12:53:00.738307] Finished iteration 334, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 815.198
[2022-12-01 12:53:01.645828] Finished iteration 335, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 907.487
[2022-12-01 12:53:02.514248] Finished iteration 336, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 868.373
[2022-12-01 12:53:03.382234] Finished iteration 337, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 867.942
[2022-12-01 12:53:04.246789] Finished iteration 338, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 864.524
[2022-12-01 12:53:05.113253] Finished iteration 339, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.419
[2022-12-01 12:51:27.455644] Epoch: [0][340/260]	Time  0.847 ( 1.016)	Data  0.004 ( 0.031)	Loss 4.6230e+00 (4.6200e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:53:05.960910] Finished iteration 340, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 847.641
[2022-12-01 12:53:06.805638] Finished iteration 341, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 844.664
[2022-12-01 12:53:07.680438] Finished iteration 342, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 874.765
[2022-12-01 12:53:08.565310] Finished iteration 343, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 884.820
[2022-12-01 12:53:09.401761] Finished iteration 344, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 836.421
Opt ckpt time 3.9672436714172363
Process done with return code 0
Parent process ID: 68303 node: 172.31.21.254
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 225670.0897216797 0
End of simulation:  Mini-batch time (usec) = 1392175
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 202566; min long bwd 185117, max long bwd 189299
Time taken by simulation: 48 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 44736.85073852539 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2419467
Min send: 10000000, max send 0
Min long send: 340325, max long send 353077
Min fwd: 55034, max fwd 61226; min bwd 80998, max bwd 85047
Min long fwd: 142688, max long fwd 147468; min long bwd 99967, max long bwd 105261
Time taken by simulation: 128 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 13 0 6158.940315246582 632152.0801385244
End of simulation:  Mini-batch time (usec) = 7083334
Min send: 10000000, max send 0
Min long send: 632234, max long send 656857
Min fwd: 23449, max fwd 84148; min bwd 32759, max bwd 57093
Min long fwd: 59594, max long fwd 67404; min long bwd 46137, max long bwd 54005
Time taken by simulation: 577 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 32 0 1084.3276977539062 632152.0801385244
End of simulation:  Mini-batch time (usec) = 17887923
Min send: 10000000, max send 0
Min long send: 632168, max long send 660373
Min fwd: 5425, max fwd 48670; min bwd 12684, max bwd 35373
Min long fwd: 26803, max long fwd 34176; min long bwd 16127, max long bwd 25418
Time taken by simulation: 3282 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14208 microseconds

{1: 1.392175, 2: 2.419467, 4: 7.083334, 8: 17.887923, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.419467
11 per stage
22 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 11
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21;
World size is 22
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20;1,3,5,7,9,11,13,15,17,19,21; --batch-size=192 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet --resume_step 344
[2022-12-01 12:53:33.592663] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 0.8501114845275879
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
6 chunks
Signal handler called with signal 10


 STOPPING VARUNA !!



Rank 17 signal handler called with signal 10
>>>>> [2022-12-01 12:54:21.829345] Time taken to load checkpoint: 43.287s
2022-12-01 12:54:32.677061 Begin to exit
Process done with return code 0
Parent process ID: 69378 node: 172.31.21.254
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 3 0 227435.36376953125 0
End of simulation:  Mini-batch time (usec) = 1393940
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 202566; min long bwd 185117, max long bwd 189299
Time taken by simulation: 37 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 6 0 42887.66098022461 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2417618
Min send: 10000000, max send 0
Min long send: 340325, max long send 353077
Min fwd: 55034, max fwd 61226; min bwd 80998, max bwd 85047
Min long fwd: 142688, max long fwd 147468; min long bwd 99967, max long bwd 105261
Time taken by simulation: 136 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 11 0 6564.140319824219 632152.0801385244
End of simulation:  Mini-batch time (usec) = 6158637
Min send: 10000000, max send 0
Min long send: 632484, max long send 655841
Min fwd: 23067, max fwd 86278; min bwd 32400, max bwd 55039
Min long fwd: 60172, max long fwd 65439; min long bwd 46688, max long bwd 54119
Time taken by simulation: 498 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 22 0 1589.6161794662476 632152.0801385244
End of simulation:  Mini-batch time (usec) = 14742182
Min send: 10000000, max send 0
Min long send: 632340, max long send 662156
Min fwd: 3894, max fwd 48700; min bwd 12787, max bwd 33145
Min long fwd: 26481, max long fwd 34620; min long bwd 15612, max long bwd 22403
Time taken by simulation: 2203 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14291 microseconds

{1: 1.39394, 2: 2.417618, 4: 6.158637, 8: 14.742182, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.417618
12 per stage
24 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 12
stage to rank map: 0,2,4,6,8,10,12,14,16,18,20,22;1,3,5,7,9,11,13,15,17,19,21,23;
World size is 24
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16,18,20,22;1,3,5,7,9,11,13,15,17,19,21,23; --batch-size=192 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet --resume_step 344
[2022-12-01 12:54:43.863593] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 0.8475315570831299
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
6 chunks
>>>>> [2022-12-01 12:55:32.301631] Time taken to load checkpoint: 43.457s
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 12:55:51.093541] Finished iteration 345, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 7318.892
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 12:55:51.923196] Finished iteration 346, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 829.356
[2022-12-01 12:55:53.786536] Finished iteration 347, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1863.308
[2022-12-01 12:55:55.623394] Finished iteration 348, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1836.846
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 12:55:56.489470] Finished iteration 349, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.022
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-12-01 12:55:32.301863] Epoch: [0][350/260]	Time  0.840 ( 2.258)	Data  0.007 ( 0.549)	Loss 4.6217e+00 (4.6220e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:55:57.331610] Finished iteration 350, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 842.092
[2022-12-01 12:55:58.219120] Finished iteration 351, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 887.455
[2022-12-01 12:55:59.084575] Finished iteration 352, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 865.409
[2022-12-01 12:55:59.933868] Finished iteration 353, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 849.262
[2022-12-01 12:56:00.800759] Finished iteration 354, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.853
[2022-12-01 12:56:01.675074] Finished iteration 355, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 874.285
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-12-01 12:56:02.551649] Finished iteration 356, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 876.542
[2022-12-01 12:56:03.408304] Finished iteration 357, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 856.616
[2022-12-01 12:56:04.244953] Finished iteration 358, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 836.735
[2022-12-01 12:56:05.113899] Finished iteration 359, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 868.783
[2022-12-01 12:55:32.301863] Epoch: [0][360/260]	Time  0.905 ( 1.390)	Data  0.004 ( 0.210)	Loss 4.6204e+00 (4.6173e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:56:06.019338] Finished iteration 360, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 905.463
[2022-12-01 12:56:06.879836] Finished iteration 361, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 860.443
[2022-12-01 12:56:07.786743] Finished iteration 362, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 906.950
[2022-12-01 12:56:08.622385] Finished iteration 363, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 835.473
[2022-12-01 12:56:09.469908] Finished iteration 364, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 847.494
[2022-12-01 12:56:10.326267] Finished iteration 365, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 856.311
[2022-12-01 12:56:11.176734] Finished iteration 366, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 850.436
[2022-12-01 12:56:12.028218] Finished iteration 367, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 851.431
[2022-12-01 12:56:12.871567] Finished iteration 368, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 843.316
[2022-12-01 12:56:13.715908] Finished iteration 369, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 844.301
[2022-12-01 12:55:32.301863] Epoch: [0][370/260]	Time  0.837 ( 1.183)	Data  0.008 ( 0.132)	Loss 4.6387e+00 (4.6171e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:56:14.553550] Finished iteration 370, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 837.599
[2022-12-01 12:56:15.456540] Finished iteration 371, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 903.001
[2022-12-01 12:56:16.307570] Finished iteration 372, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 850.982
[2022-12-01 12:56:17.158117] Finished iteration 373, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 850.523
[2022-12-01 12:56:18.025799] Finished iteration 374, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 867.616
[2022-12-01 12:56:18.846324] Finished iteration 375, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 820.482
[2022-12-01 12:56:19.683352] Finished iteration 376, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 836.989
[2022-12-01 12:56:20.556413] Finished iteration 377, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 873.026
[2022-12-01 12:56:21.390525] Finished iteration 378, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 834.071
[2022-12-01 12:56:22.259452] Finished iteration 379, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 868.887
[2022-12-01 12:55:32.301863] Epoch: [0][380/260]	Time  0.820 ( 1.092)	Data  0.006 ( 0.097)	Loss 4.6204e+00 (4.6175e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:56:23.084190] Finished iteration 380, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 824.702
[2022-12-01 12:56:23.943622] Finished iteration 381, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 859.445
[2022-12-01 12:56:24.848306] Finished iteration 382, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 904.595
[2022-12-01 12:56:25.671370] Finished iteration 383, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 823.066
[2022-12-01 12:56:26.570647] Finished iteration 384, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 899.234
[2022-12-01 12:56:27.402811] Finished iteration 385, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 832.088
[2022-12-01 12:56:28.238871] Finished iteration 386, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 836.020
[2022-12-01 12:56:29.060481] Finished iteration 387, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 821.593
[2022-12-01 12:56:29.901093] Finished iteration 388, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 840.623
[2022-12-01 12:56:30.822757] Finished iteration 389, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 921.578
[2022-12-01 12:55:32.301863] Epoch: [0][390/260]	Time  0.886 ( 1.042)	Data  0.009 ( 0.078)	Loss 4.6172e+00 (4.6175e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:56:31.705163] Finished iteration 390, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 882.363
[2022-12-01 12:56:32.543143] Finished iteration 391, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 838.036
[2022-12-01 12:56:33.366595] Finished iteration 392, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 823.333
[2022-12-01 12:56:34.209636] Finished iteration 393, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 843.023
[2022-12-01 12:56:35.015732] Finished iteration 394, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 806.024
[2022-12-01 12:56:35.875794] Finished iteration 395, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 860.013
[2022-12-01 12:56:36.755922] Finished iteration 396, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 880.083
[2022-12-01 12:56:37.631078] Finished iteration 397, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 875.114
[2022-12-01 12:56:38.443147] Finished iteration 398, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 812.012
[2022-12-01 12:56:39.267951] Finished iteration 399, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 824.765
[2022-12-01 12:55:32.301863] Epoch: [0][400/260]	Time  0.798 ( 1.005)	Data  0.005 ( 0.065)	Loss 4.6152e+00 (4.6182e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:56:40.064561] Finished iteration 400, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 796.554
[2022-12-01 12:56:40.857610] Finished iteration 401, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 793.021
[2022-12-01 12:56:41.711497] Finished iteration 402, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 853.841
[2022-12-01 12:56:42.557024] Finished iteration 403, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 845.521
[2022-12-01 12:56:43.396539] Finished iteration 404, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 839.444
[2022-12-01 12:56:44.223005] Finished iteration 405, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 826.423
[2022-12-01 12:56:45.046343] Finished iteration 406, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 823.302
[2022-12-01 12:56:45.878264] Finished iteration 407, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 831.869
[2022-12-01 12:56:46.788804] Finished iteration 408, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 910.501
[2022-12-01 12:56:47.609559] Finished iteration 409, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 820.718
[2022-12-01 12:55:32.301863] Epoch: [0][410/260]	Time  0.869 ( 0.980)	Data  0.007 ( 0.056)	Loss 4.6120e+00 (4.6181e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:56:48.476093] Finished iteration 410, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.495
[2022-12-01 12:56:49.292845] Finished iteration 411, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 816.733
[2022-12-01 12:56:50.102427] Finished iteration 412, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 809.506
[2022-12-01 12:56:50.955506] Finished iteration 413, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 853.070
[2022-12-01 12:56:51.775383] Finished iteration 414, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 819.820
[2022-12-01 12:56:52.613433] Finished iteration 415, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 838.002
[2022-12-01 12:56:53.437136] Finished iteration 416, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 823.624
[2022-12-01 12:56:54.267253] Finished iteration 417, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 830.069
[2022-12-01 12:56:55.086646] Finished iteration 418, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 819.429
[2022-12-01 12:56:55.920061] Finished iteration 419, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 833.308
[2022-12-01 12:55:32.301863] Epoch: [0][420/260]	Time  0.849 ( 0.960)	Data  0.004 ( 0.050)	Loss 4.6100e+00 (4.6181e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:56:56.769239] Finished iteration 420, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 849.159
[2022-12-01 12:56:57.607896] Finished iteration 421, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 838.599
[2022-12-01 12:56:58.446749] Finished iteration 422, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 838.819
[2022-12-01 12:56:59.266663] Finished iteration 423, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 819.860
[2022-12-01 12:57:00.123412] Finished iteration 424, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 856.708
[2022-12-01 12:57:00.977779] Finished iteration 425, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 854.365
[2022-12-01 12:57:01.876293] Finished iteration 426, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 898.448
[2022-12-01 12:57:02.717778] Finished iteration 427, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 841.433
[2022-12-01 12:57:03.587326] Finished iteration 428, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 869.511
[2022-12-01 12:57:04.440769] Finished iteration 429, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 853.407
[2022-12-01 12:55:32.301863] Epoch: [0][430/260]	Time  0.851 ( 0.948)	Data  0.008 ( 0.045)	Loss 4.6146e+00 (4.6177e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:57:05.293642] Finished iteration 430, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 852.830
[2022-12-01 12:57:06.111762] Finished iteration 431, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 818.088
[2022-12-01 12:57:06.966762] Finished iteration 432, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 854.957
[2022-12-01 12:57:07.799808] Finished iteration 433, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 832.995
[2022-12-01 12:57:08.665085] Finished iteration 434, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 865.300
[2022-12-01 12:57:09.502462] Finished iteration 435, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 837.284
[2022-12-01 12:57:10.333162] Finished iteration 436, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 830.662
[2022-12-01 12:57:11.221783] Finished iteration 437, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 888.567
[2022-12-01 12:57:12.075067] Finished iteration 438, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 853.247
[2022-12-01 12:57:13.102400] Finished iteration 439, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1027.295
[2022-12-01 12:55:32.301863] Epoch: [0][440/260]	Time  0.838 ( 0.939)	Data  0.005 ( 0.041)	Loss 4.6250e+00 (4.6174e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:57:13.948069] Finished iteration 440, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 845.666
[2022-12-01 12:57:14.795873] Finished iteration 441, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 847.731
[2022-12-01 12:57:15.636156] Finished iteration 442, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 840.241
[2022-12-01 12:57:16.470783] Finished iteration 443, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 834.590
[2022-12-01 12:57:17.329251] Finished iteration 444, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 858.420
[2022-12-01 12:57:18.179181] Finished iteration 445, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 849.900
[2022-12-01 12:57:19.036481] Finished iteration 446, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 857.254
[2022-12-01 12:57:19.938339] Finished iteration 447, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 901.833
[2022-12-01 12:57:20.800610] Finished iteration 448, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 862.229
[2022-12-01 12:57:21.636964] Finished iteration 449, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 836.354
[2022-12-01 12:55:32.301863] Epoch: [0][450/260]	Time  0.819 ( 0.931)	Data  0.011 ( 0.038)	Loss 4.6081e+00 (4.6170e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:57:22.456390] Finished iteration 450, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 819.352
[2022-12-01 12:57:23.285117] Finished iteration 451, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 828.688
[2022-12-01 12:57:24.104809] Finished iteration 452, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 819.688
[2022-12-01 12:57:24.987010] Finished iteration 453, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 882.089
[2022-12-01 12:57:25.799427] Finished iteration 454, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 812.375
[2022-12-01 12:57:26.631849] Finished iteration 455, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 832.439
[2022-12-01 12:57:27.498114] Finished iteration 456, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.195
[2022-12-01 12:57:28.603310] Finished iteration 457, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1105.134
[2022-12-01 12:57:30.369101] Finished iteration 458, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1765.751
[2022-12-01 12:57:31.199002] Finished iteration 459, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 829.902
[2022-12-01 12:55:32.301863] Epoch: [0][460/260]	Time  1.507 ( 0.939)	Data  0.008 ( 0.035)	Loss 4.6211e+00 (4.6175e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 12:57:32.723133] Finished iteration 460, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1524.045
[2022-12-01 12:57:34.500676] Finished iteration 461, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1777.549
[2022-12-01 12:57:35.366906] Finished iteration 462, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.144
[2022-12-01 12:57:36.215389] Finished iteration 463, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 848.449
[2022-12-01 12:57:37.081928] Finished iteration 464, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.501
[2022-12-01 12:57:37.948722] Finished iteration 465, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 866.747
[2022-12-01 12:57:38.818996] Finished iteration 466, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 870.275
[2022-12-01 12:57:39.650013] Finished iteration 467, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 830.935
Opt ckpt time 3.0083723068237305
Process done with return code 0
Parent process ID: 52688 node: 172.31.21.137
32 cutpoints
Parent process ID: 38171 node: 172.31.27.155
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 212259.09423828125 0
End of simulation:  Mini-batch time (usec) = 1767241
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 203682; min long bwd 184795, max long bwd 189299
Time taken by simulation: 45 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 42864.17007446289 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2926179
Min send: 10000000, max send 0
Min long send: 340325, max long send 360040
Min fwd: 54106, max fwd 61226; min bwd 79729, max bwd 84071
Min long fwd: 142875, max long fwd 147087; min long bwd 100210, max long bwd 105674
Time taken by simulation: 159 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 5012.969017028809 632152.0801385244
End of simulation:  Mini-batch time (usec) = 8186112
Min send: 10000000, max send 0
Min long send: 632289, max long send 656857
Min fwd: 22997, max fwd 85414; min bwd 32345, max bwd 55249
Min long fwd: 59874, max long fwd 66218; min long bwd 45265, max long bwd 54005
Time taken by simulation: 712 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 32 0 1084.3276977539062 632152.0801385244
End of simulation:  Mini-batch time (usec) = 17887923
Min send: 10000000, max send 0
Min long send: 632168, max long send 660373
Min fwd: 5425, max fwd 48670; min bwd 12684, max bwd 35373
Min long fwd: 26803, max long fwd 34176; min long bwd 16127, max long bwd 25418
Time taken by simulation: 3222 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14865 microseconds

{1: 1.767241, 2: 2.926179, 4: 8.186112, 8: 17.887923, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.926179
9 per stage
18 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 9
stage to rank map: 0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17;
World size is 18
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17; --batch-size=224 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet --resume_step 660
[2022-12-01 13:19:28.445232] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 0.9931209087371826
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
7 chunks
>>>>> [2022-12-01 13:20:04.990660] Time taken to load checkpoint: 31.375s
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 13:20:16.449682] Finished iteration 661, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9136.846
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 13:20:17.370719] Finished iteration 662, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 920.732
[2022-12-01 13:20:18.337574] Finished iteration 663, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 966.837
[2022-12-01 13:20:19.285883] Finished iteration 664, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 948.265
[2022-12-01 13:20:21.235805] Finished iteration 665, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1949.935
[2022-12-01 13:20:22.146174] Finished iteration 666, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 910.339
[2022-12-01 13:20:23.087351] Finished iteration 667, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 941.121
[2022-12-01 13:20:24.034606] Finished iteration 668, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 947.191
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 13:20:25.020286] Finished iteration 669, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 985.654
[2022-12-01 13:20:04.990896] Epoch: [0][670/223]	Time  0.929 ( 1.863)	Data  0.007 ( 0.357)	Loss 4.6122e+00 (4.6122e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:20:25.949619] Finished iteration 670, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 929.354
[2022-12-01 13:20:26.920553] Finished iteration 671, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 970.859
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-12-01 13:20:27.866421] Finished iteration 672, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 945.845
[2022-12-01 13:20:28.790755] Finished iteration 673, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 924.319
[2022-12-01 13:20:29.781298] Finished iteration 674, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.502
[2022-12-01 13:20:30.714112] Finished iteration 675, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 932.769
[2022-12-01 13:20:31.649779] Finished iteration 676, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 935.651
[2022-12-01 13:20:32.591942] Finished iteration 677, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 942.112
[2022-12-01 13:20:33.573368] Finished iteration 678, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 981.405
[2022-12-01 13:20:34.511034] Finished iteration 679, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 937.641
[2022-12-01 13:20:04.990896] Epoch: [0][680/223]	Time  0.923 ( 1.406)	Data  0.005 ( 0.181)	Loss 4.6155e+00 (4.6110e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:20:35.434922] Finished iteration 680, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 923.892
[2022-12-01 13:20:36.377010] Finished iteration 681, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 942.012
[2022-12-01 13:20:37.318834] Finished iteration 682, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 941.785
[2022-12-01 13:20:38.295536] Finished iteration 683, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 976.667
[2022-12-01 13:20:39.228219] Finished iteration 684, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 932.650
[2022-12-01 13:20:40.226808] Finished iteration 685, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 998.557
[2022-12-01 13:20:41.159285] Finished iteration 686, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 932.484
[2022-12-01 13:20:42.097713] Finished iteration 687, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 938.357
[2022-12-01 13:20:43.027869] Finished iteration 688, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 930.123
[2022-12-01 13:20:44.031523] Finished iteration 689, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1003.628
[2022-12-01 13:20:04.990896] Epoch: [0][690/223]	Time  1.969 ( 1.289)	Data  0.003 ( 0.122)	Loss 4.6110e+00 (4.6120e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:20:46.009283] Finished iteration 690, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1977.717
[2022-12-01 13:20:47.014213] Finished iteration 691, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1004.909
[2022-12-01 13:20:47.988356] Finished iteration 692, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 974.114
[2022-12-01 13:20:48.956718] Finished iteration 693, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 968.340
[2022-12-01 13:20:49.957522] Finished iteration 694, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1000.796
[2022-12-01 13:20:50.868763] Finished iteration 695, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 911.176
[2022-12-01 13:20:51.778487] Finished iteration 696, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 909.685
[2022-12-01 13:20:52.667565] Finished iteration 697, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 889.053
[2022-12-01 13:20:53.571000] Finished iteration 698, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 903.401
[2022-12-01 13:20:54.538393] Finished iteration 699, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 967.357
[2022-12-01 13:20:04.990896] Epoch: [0][700/223]	Time  0.943 ( 1.204)	Data  0.003 ( 0.093)	Loss 4.6044e+00 (4.6107e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:20:55.484006] Finished iteration 700, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 945.579
[2022-12-01 13:20:56.453851] Finished iteration 701, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 969.823
[2022-12-01 13:20:57.342154] Finished iteration 702, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 888.279
[2022-12-01 13:20:58.276254] Finished iteration 703, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 934.060
[2022-12-01 13:20:59.256374] Finished iteration 704, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 980.089
[2022-12-01 13:21:00.273608] Finished iteration 705, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1017.201
[2022-12-01 13:21:01.235724] Finished iteration 706, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 962.078
[2022-12-01 13:21:02.298314] Finished iteration 707, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1062.561
[2022-12-01 13:21:03.329050] Finished iteration 708, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1030.700
[2022-12-01 13:21:04.449544] Finished iteration 709, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1120.461
[2022-12-01 13:20:04.990896] Epoch: [0][710/223]	Time  1.005 ( 1.163)	Data  0.003 ( 0.076)	Loss 4.6183e+00 (4.6103e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:21:05.457938] Finished iteration 710, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1008.352
[2022-12-01 13:21:06.462352] Finished iteration 711, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1004.400
[2022-12-01 13:21:07.417335] Finished iteration 712, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 954.965
[2022-12-01 13:21:08.397964] Finished iteration 713, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 980.589
[2022-12-01 13:21:09.381465] Finished iteration 714, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 983.465
[2022-12-01 13:21:10.325408] Finished iteration 715, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 943.919
[2022-12-01 13:21:11.272548] Finished iteration 716, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 947.105
[2022-12-01 13:21:12.266104] Finished iteration 717, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 993.523
[2022-12-01 13:21:13.231721] Finished iteration 718, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 965.581
[2022-12-01 13:21:14.220579] Finished iteration 719, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 988.832
[2022-12-01 13:20:04.990896] Epoch: [0][720/223]	Time  0.952 ( 1.131)	Data  0.008 ( 0.064)	Loss 4.6027e+00 (4.6110e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:21:15.170023] Finished iteration 720, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 949.409
[2022-12-01 13:21:16.147044] Finished iteration 721, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 977.017
[2022-12-01 13:21:17.102698] Finished iteration 722, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 955.680
[2022-12-01 13:21:18.126951] Finished iteration 723, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1024.145
[2022-12-01 13:21:19.121209] Finished iteration 724, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 994.221
[2022-12-01 13:21:20.060325] Finished iteration 725, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 939.091
[2022-12-01 13:21:21.036118] Finished iteration 726, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 975.797
[2022-12-01 13:21:22.021432] Finished iteration 727, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 985.243
[2022-12-01 13:21:22.938344] Finished iteration 728, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 916.869
[2022-12-01 13:21:23.942747] Finished iteration 729, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1004.390
[2022-12-01 13:20:04.990896] Epoch: [0][730/223]	Time  0.997 ( 1.109)	Data  0.007 ( 0.056)	Loss 4.6044e+00 (4.6110e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:21:24.939341] Finished iteration 730, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 996.590
[2022-12-01 13:21:25.884357] Finished iteration 731, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 944.945
[2022-12-01 13:21:26.825607] Finished iteration 732, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 941.216
[2022-12-01 13:21:27.725460] Finished iteration 733, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 899.822
[2022-12-01 13:21:28.718051] Finished iteration 734, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 992.552
[2022-12-01 13:21:29.685174] Finished iteration 735, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 967.211
[2022-12-01 13:21:30.663550] Finished iteration 736, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 978.229
[2022-12-01 13:21:31.610403] Finished iteration 737, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 946.821
[2022-12-01 13:21:32.571050] Finished iteration 738, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.623
[2022-12-01 13:21:33.574876] Finished iteration 739, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1003.787
[2022-12-01 13:20:04.990896] Epoch: [0][740/223]	Time  0.926 ( 1.090)	Data  0.005 ( 0.049)	Loss 4.6116e+00 (4.6106e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:21:34.502287] Finished iteration 740, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 927.369
[2022-12-01 13:21:35.510346] Finished iteration 741, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1008.053
[2022-12-01 13:21:36.461450] Finished iteration 742, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 951.080
[2022-12-01 13:21:37.429319] Finished iteration 743, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 967.813
[2022-12-01 13:21:38.437130] Finished iteration 744, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1007.843
[2022-12-01 13:21:39.476773] Finished iteration 745, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1039.543
[2022-12-01 13:21:40.443244] Finished iteration 746, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 966.475
[2022-12-01 13:21:41.403706] Finished iteration 747, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.396
[2022-12-01 13:21:42.324889] Finished iteration 748, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 921.142
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  32768.0
[2022-12-01 13:21:43.231715] Finished iteration 749, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 906.798
[2022-12-01 13:20:04.990896] Epoch: [0][750/223]	Time  0.956 ( 1.076)	Data  0.008 ( 0.045)	Loss 4.6060e+00 (4.6107e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:21:44.184701] Finished iteration 750, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 952.947
[2022-12-01 13:21:45.185788] Finished iteration 751, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1001.068
[2022-12-01 13:21:46.152805] Finished iteration 752, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 966.988
[2022-12-01 13:21:47.084180] Finished iteration 753, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 931.345
[2022-12-01 13:21:48.065246] Finished iteration 754, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 981.026
[2022-12-01 13:21:49.020983] Finished iteration 755, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 955.702
[2022-12-01 13:21:49.977047] Finished iteration 756, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 956.037
[2022-12-01 13:21:50.952622] Finished iteration 757, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 975.539
[2022-12-01 13:21:51.889357] Finished iteration 758, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 936.700
[2022-12-01 13:21:52.866013] Finished iteration 759, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 976.622
[2022-12-01 13:20:04.990896] Epoch: [0][760/223]	Time  0.891 ( 1.064)	Data  0.005 ( 0.041)	Loss 4.6032e+00 (4.6103e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:21:53.759375] Finished iteration 760, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 893.354
[2022-12-01 13:21:54.711596] Finished iteration 761, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 952.173
[2022-12-01 13:21:55.691432] Finished iteration 762, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 979.800
[2022-12-01 13:21:56.673384] Finished iteration 763, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 981.919
[2022-12-01 13:21:57.673680] Finished iteration 764, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1000.280
[2022-12-01 13:21:58.644674] Finished iteration 765, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 970.953
[2022-12-01 13:21:59.598422] Finished iteration 766, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 953.707
[2022-12-01 13:22:00.559087] Finished iteration 767, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 960.632
[2022-12-01 13:22:01.530561] Finished iteration 768, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 971.444
[2022-12-01 13:22:02.502269] Finished iteration 769, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 971.669
[2022-12-01 13:20:04.990896] Epoch: [0][770/223]	Time  1.016 ( 1.056)	Data  0.003 ( 0.037)	Loss 4.6083e+00 (4.6103e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:22:03.520714] Finished iteration 770, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1018.516
[2022-12-01 13:22:04.523938] Finished iteration 771, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1003.102
[2022-12-01 13:22:05.500945] Finished iteration 772, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 977.059
[2022-12-01 13:22:06.476133] Finished iteration 773, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 975.066
[2022-12-01 13:22:07.420789] Finished iteration 774, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 944.619
[2022-12-01 13:22:08.403707] Finished iteration 775, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 982.887
[2022-12-01 13:22:09.417187] Finished iteration 776, CKPT_AND_STOP: False, flag: tensor([1], dtype=torch.int32), speed: 1013.449
Opt ckpt time 3.649481773376465
Process done with return code 0
Parent process ID: 39296 node: 172.31.27.155
32 cutpoints
Stages 1
Micro-bs 32 Max mem: 8675329024.0
Predicted microbatch size for 1: 32
comm size 0
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 1 4 0 222679.87060546875 0
End of simulation:  Mini-batch time (usec) = 1777661
Min send: 10000000, max send 0
Min long send: 10000000, max long send 0
Min fwd: 10000000, max fwd 0; min bwd 10000000, max bwd 0
Min long fwd: 201398, max long fwd 203682; min long bwd 184795, max long bwd 189299
Time taken by simulation: 40 microseconds

Stages 2
Micro-bs 32 Max mem: 5306506956.799999
Predicted microbatch size for 2: 32
comm size 6422528
WARNING: no send time found, 2 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 2 8 0 42864.17007446289 339993.4039718803
End of simulation:  Mini-batch time (usec) = 2926179
Min send: 10000000, max send 0
Min long send: 340325, max long send 360040
Min fwd: 54106, max fwd 61226; min bwd 79729, max bwd 84071
Min long fwd: 142875, max long fwd 147087; min long bwd 100210, max long bwd 105674
Time taken by simulation: 159 microseconds

Stages 4
Micro-bs 32 Max mem: 3266000179.2
Predicted microbatch size for 4: 32
comm size 12845056
WARNING: no send time found, 4 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 4 16 0 5012.969017028809 632152.0801385244
End of simulation:  Mini-batch time (usec) = 8186112
Min send: 10000000, max send 0
Min long send: 632289, max long send 656857
Min fwd: 22997, max fwd 85414; min bwd 32345, max bwd 55249
Min long fwd: 59874, max long fwd 66218; min long bwd 45265, max long bwd 54005
Time taken by simulation: 716 microseconds

Stages 8
Micro-bs 32 Max mem: 1980926361.6
Predicted microbatch size for 8: 32
comm size 12845056
WARNING: no send time found, 8 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 8 32 0 1084.3276977539062 632152.0801385244
End of simulation:  Mini-batch time (usec) = 17887923
Min send: 10000000, max send 0
Min long send: 632168, max long send 660373
Min fwd: 5425, max fwd 48670; min bwd 12684, max bwd 35373
Min long fwd: 26803, max long fwd 34176; min long bwd 16127, max long bwd 25418
Time taken by simulation: 3217 microseconds

Stages 16
Micro-bs 32 Max mem: 1128991948.8
Predicted microbatch size for 16: 32
comm size 25690112
WARNING: no send time found, 16 partitions
GPUS_PER_VM=1 /home/ubuntu/varuna/tools/simulator/simulate-varuna 16 64 0 0 1028093.6227904424
End of simulation:  Mini-batch time (usec) = 61731430
Min send: 10000000, max send 0
Min long send: 1028093, max long send 1062462
Min fwd: 56, max fwd 33543; min bwd 2591, max bwd 20855
Min long fwd: 1672, max long fwd 12532; min long bwd 2017, max long bwd 11294
Time taken by simulation: 14169 microseconds

{1: 1.777661, 2: 2.926179, 4: 8.186112, 8: 17.887923, 16: 61.73143}
{1: 32, 2: 32, 4: 32, 8: 32, 16: 32}
best config is: 2 32
expected time is 2.926179
9 per stage
18 servers!
Config:
ranks: range(17, 18)
train batch size: 2048
partitions: 2
chunk_size: 32
data depth: 9
stage to rank map: 0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17;
World size is 18
/opt/conda/envs/varuna/bin/python -u main.py --rank=17 --chunk_size=32 --local_rank=0 --stage_to_rank_map=0,2,4,6,8,10,12,14,16;1,3,5,7,9,11,13,15,17; --batch-size=224 data -a resnet152 --varuna --lr 0.001 --epochs 1000 --resume s3://spot-checkpoints/resnet --resume_step 776
[2022-12-01 13:22:30.815221] => creating model 'resnet152'
Files already downloaded and verified
Num cutpoints is 31
dry run time 0.9920554161071777
SHARED WEIGHTS ARE
None
this rank  17 is part of pipeline replica  8
7 chunks
>>>>> [2022-12-01 13:23:12.737412] Time taken to load checkpoint: 36.728s
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  524288.0
[2022-12-01 13:23:37.994116] Finished iteration 777, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 9084.790
17 Overflow !!
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  262144.0
[2022-12-01 13:23:39.988077] Finished iteration 778, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1993.776
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  131072.0
[2022-12-01 13:23:41.893409] Finished iteration 779, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1905.240
[2022-12-01 13:23:12.737650] Epoch: [0][780/223]	Time  2.019 ( 3.748)	Data  0.012 ( 0.774)	Loss 4.5999e+00 (4.6055e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:23:43.916368] Finished iteration 780, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2022.930
[2022-12-01 13:23:45.955573] Finished iteration 781, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 2039.225
[2022-12-01 13:23:46.898840] Finished iteration 782, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 943.184
[2022-12-01 13:23:47.853558] Finished iteration 783, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 954.690
17 : update_scale(): _has_overflow, dynamic. _loss_scale =  65536.0
[2022-12-01 13:23:48.850693] Finished iteration 784, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 997.110
[2022-12-01 13:23:49.848553] Finished iteration 785, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 997.828
[2022-12-01 13:23:50.868942] Finished iteration 786, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1020.356
[2022-12-01 13:23:51.795487] Finished iteration 787, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 926.504
[2022-12-01 13:23:52.726418] Finished iteration 788, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 930.896
[2022-12-01 13:23:53.695888] Finished iteration 789, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 969.434
[2022-12-01 13:23:12.737650] Epoch: [0][790/223]	Time  1.019 ( 1.843)	Data  0.003 ( 0.298)	Loss 4.6116e+00 (4.6122e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:23:54.718282] Finished iteration 790, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1022.362
[2022-12-01 13:23:55.729620] Finished iteration 791, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1011.324
[2022-12-01 13:23:56.684992] Finished iteration 792, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 955.327
[2022-12-01 13:23:57.649697] Finished iteration 793, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 964.678
[2022-12-01 13:23:58.587604] Finished iteration 794, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 937.867
[2022-12-01 13:23:59.561270] Finished iteration 795, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 973.634
[2022-12-01 13:24:00.518366] Finished iteration 796, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 957.070
[2022-12-01 13:24:01.462103] Finished iteration 797, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 943.697
[2022-12-01 13:24:02.484848] Finished iteration 798, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1022.712
[2022-12-01 13:24:03.457098] Finished iteration 799, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 972.213
[2022-12-01 13:23:12.737650] Epoch: [0][800/223]	Time  0.974 ( 1.480)	Data  0.003 ( 0.176)	Loss 4.6105e+00 (4.6109e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:24:04.431700] Finished iteration 800, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 974.556
[2022-12-01 13:24:05.390640] Finished iteration 801, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 958.926
[2022-12-01 13:24:06.292485] Finished iteration 802, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 901.814
[2022-12-01 13:24:07.237337] Finished iteration 803, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 944.830
[2022-12-01 13:24:08.133147] Finished iteration 804, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 895.766
[2022-12-01 13:24:09.008564] Finished iteration 805, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 875.385
[2022-12-01 13:24:09.999411] Finished iteration 806, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 990.854
[2022-12-01 13:24:11.050443] Finished iteration 807, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1050.960
[2022-12-01 13:24:12.031726] Finished iteration 808, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 981.247
[2022-12-01 13:24:13.028415] Finished iteration 809, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 996.653
[2022-12-01 13:23:12.737650] Epoch: [0][810/223]	Time  1.002 ( 1.327)	Data  0.004 ( 0.125)	Loss 4.6060e+00 (4.6110e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:24:14.029564] Finished iteration 810, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1001.110
[2022-12-01 13:24:14.988215] Finished iteration 811, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 958.631
[2022-12-01 13:24:15.928026] Finished iteration 812, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 939.783
[2022-12-01 13:24:16.907721] Finished iteration 813, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 979.653
[2022-12-01 13:24:17.838979] Finished iteration 814, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 931.222
[2022-12-01 13:24:18.797247] Finished iteration 815, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 958.235
[2022-12-01 13:24:19.725957] Finished iteration 816, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 928.682
[2022-12-01 13:24:20.682769] Finished iteration 817, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 956.798
[2022-12-01 13:24:21.680370] Finished iteration 818, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 997.552
[2022-12-01 13:24:22.674631] Finished iteration 819, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 994.214
[2022-12-01 13:23:12.737650] Epoch: [0][820/223]	Time  0.993 ( 1.244)	Data  0.003 ( 0.098)	Loss 4.6088e+00 (4.6109e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:24:23.667435] Finished iteration 820, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 992.765
[2022-12-01 13:24:24.673108] Finished iteration 821, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 1005.773
[2022-12-01 13:24:25.650725] Finished iteration 822, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 977.479
[2022-12-01 13:24:26.631585] Finished iteration 823, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 980.823
[2022-12-01 13:24:27.625365] Finished iteration 824, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 993.810
[2022-12-01 13:24:28.597833] Finished iteration 825, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 972.374
[2022-12-01 13:24:29.557017] Finished iteration 826, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 959.145
[2022-12-01 13:24:30.539037] Finished iteration 827, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 982.075
[2022-12-01 13:24:31.478839] Finished iteration 828, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 939.664
[2022-12-01 13:24:32.427105] Finished iteration 829, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 948.230
[2022-12-01 13:23:12.737650] Epoch: [0][830/223]	Time  0.919 ( 1.193)	Data  0.003 ( 0.080)	Loss 4.6004e+00 (4.6099e+00)	Acc@1   0.00 (  0.00)	Acc@5   0.00 (  0.00)
[2022-12-01 13:24:33.346147] Finished iteration 830, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 919.005
[2022-12-01 13:24:34.319373] Finished iteration 831, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 973.240
[2022-12-01 13:24:35.207639] Finished iteration 832, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 888.198
[2022-12-01 13:24:36.199894] Finished iteration 833, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 992.224
[2022-12-01 13:24:37.169180] Finished iteration 834, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 969.256
[2022-12-01 13:24:38.158191] Finished iteration 835, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 988.991
[2022-12-01 13:24:39.123203] Finished iteration 836, CKPT_AND_STOP: False, flag: tensor([0], dtype=torch.int32), speed: 964.995
[2022-12-01 13:24:40.119562] Finished iteration 837, CKPT_AND_STOP: False, flag: tensor([2], dtype=torch.int32), speed: 996.313
Opt ckpt time 3.6577653884887695
Process done with return code 0
